if (window.performance && window.performance.mark) { window.performance.mark('startLoadBundleInner-async'); }
// Copyright (C) Microsoft Corporation. All rights reserved.
var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();define("VSS/Search",["require","exports","VSS/Diag","VSS/Utils/Array","VSS/Utils/Core","VSS/VSS"],function(n,t,i,r,u,f){function h(n,t){var u=n.length,r,f,e,i;if(u>1){for(n.sort(t),r=new Array(u),r[0]=n[0],f=0,e=1,i=1;i<u;i++)n[i]!==n[f]&&(r[e++]=n[i],f=i);r.length=e;n=r}return n}var c,l,e,a,o,y,p,w;Object.defineProperty(t,"__esModule",{value:!0});c=u.delegate;l=function(){function n(n,t){this._strategy=n;this._adapter=t}return n.prototype.addItems=function(n){var t=this;i.measurePerformance(function(){t._strategy.processItems(n)},"[SearchCore] Index Building Time");i.logTracePoint("SearchCore.finishIndexing")},n.prototype.beginSearch=function(n){var r=this,t;return this._adapter.isDataSetComplete()||this._adapter.addMoreItems(c(this,this.addItems),function(){r.beginSearch(n)}),i.measurePerformance(function(){t=r._strategy.search(n)},"[SearchCore] Search Time"),this._adapter.handleResults(t,!0,n),t},n.prototype.getStrategy=function(){return this._strategy},n.prototype.clearStrategyStore=function(){this.getStrategy().clearStrategyStore()},n}();t.SearchCore=l;e=function(){function n(n){this._options=$.extend({},n);this._options.specialCharacters&&this._options.specialCharacters.length&&this._buildSpecialCharacterHashSet(this._options.specialCharacters)}return n.getTerms=function(n,t){var e,u,o,s,f,r,h;for(e=new Object(void 0),u=0,o=n;u<o.length;u++)for(s=o[u],f=s.toLocaleLowerCase().split(t||" "),r=0,h=f.length;r<h;r++)f[r]&&(e[f[r]]=!0);return Object.keys(e)},n.prototype._buildSpecialCharacterHashSet=function(n){var t,i,r;for(this._specialCharactersHashSet={},t=0,i=n;t<i.length;t++)r=i[t],this._specialCharactersHashSet[r.toLocaleLowerCase()]=!0},n.prototype._getTerms=function(t){var u=n.getTerms(t,this._options.delimiter),r,f;if(this._specialCharactersHashSet)for(r=0,f=u;r<f.length;r++){for(var e=f[r],i=0,o=e.length;i<o&&this._specialCharactersHashSet.hasOwnProperty(e[i]);)i++;i>0&&i<o&&u.push(e.substr(i))}return u},n.prototype.processItems=function(){},n.prototype.clearStrategyStore=function(){},n.prototype.search=function(){return[]},n.prototype.dataExists=function(){return!1},n.prototype.getIndexedItemsCount=function(){return 0},n.prototype.getIndexTotalSize=function(){return 0},n}();t.SearchStrategy=e;a=function(n){function t(t,i){var r=n.call(this,i)||this,u;return t?r._searchStore=t:(u={comparer:r._options.comparer},i&&i.delimiter&&(u.delimiter=i.delimiter),r._searchStore=new v(u)),r._dataExists=!1,r._indexedItems=[],r}return __extends(t,n),t.prototype.getIndexTotalSize=function(){return this._searchStore.getStoreTotalSize()},t.prototype.clearStrategyStore=function(){this._dataExists=!1;this._indexedItems=[];this._searchStore.clearStrategyStore()},t.prototype.getIndexedItemsCount=function(){return this._indexedItems.length},t.prototype.processItems=function(n){var f,r,u,t;for(f=0,r=0,u=n;r<u.length;r++)t=u[r],t.terms.length!==0&&this._searchStore.addToIndex(t.item,this._getTerms(t.terms))&&(this._indexedItems.push(t.item),f+=t.terms.length);this._dataExists=!0},t.prototype.search=function(n){var t=$.trim(n);return t===""?this._indexedItems:this._searchStore.search(t)},t.prototype.dataExists=function(){return this._dataExists},t}(e);t.IndexedSearchStrategy=a;o=function(){function n(n){this._options=n||{};this._comparer=this._options.comparer}return n.prototype.search=function(){return[]},n.prototype.addToIndex=function(){return!1},n.prototype.clearStrategyStore=function(){},n.prototype.getStoreTotalSize=function(){return 0},n}();t.IndexedSearchStore=o;var s=function(){function n(n){this.children={};this.content=[];n&&this.content.push(n)}return n}(),b=function(){function n(n){this.root=new s;this.SIZEOF_KEY=2;this.SIZEOF_NUMBER=8;this._comparer=n;this._trieSize=0}return n.prototype.insert=function(n,t){for(var i=this.root,r=0,o=n.length,u,f,e;r<o;++r)if(f=i.children[n[r]],f)i=f;else break;for(;r<o;++r)u=new s,this._trieSize+=this.SIZEOF_KEY,i.children[n[r]]=u,i=u;return e=!1,i.content.indexOf(t)===-1&&(i.content.push(t),this._trieSize+=this.SIZEOF_NUMBER,e=!0),e},n.prototype.find=function(n){for(var r,t=this.root,i=0,u=n.length;i<u;++i)if(r=n[i],t.children[r])t=t.children[r];else return null;return this._getAllDescendantContent(t)},n.prototype._getAllDescendantContent=function(n){var i=[],r=[],t,u;for(i.push(n);i.length;)if(t=i.pop(),t.content&&t.content.length&&(r=r.concat(t.content)),t.children)for(u in t.children)i.push(t.children[u]);return h(r,this._comparer)},n.prototype.clear=function(){this.root=new s;this._trieSize=0},n.prototype.getTrieTotalSize=function(){return this._trieSize},n}(),v=function(n){function t(t){var i=n.call(this,t)||this;return i._trie=new b(i._comparer),i}return __extends(t,n),t.prototype.search=function(n){for(var u,f,h=e.getTerms([n],this._options.delimiter),t=[],o=0,s=h;o<s.length;o++)if(u=s[o],u&&(f=this._trie.find(u),t=f?t.length===0?f:r.intersectUniqueSorted(t,f,this._comparer):[],t.length===0))break;return t},t.prototype.addToIndex=function(n,t){var u,r,f,e;for(u=!0,r=0,f=t;r<f.length;r++)e=f[r],this._trie.insert(e,n)||(u=!1);return u},t.prototype.clearStrategyStore=function(){this._trie.clear()},t.prototype.getStoreTotalSize=function(){return this._trie.getTrieTotalSize()},t}(o);t.TrieStore=v;y=function(n){function t(t){var i=n.call(this,t)||this;return i._index={},i._tokenCache={},i}return __extends(t,n),t.prototype.search=function(n){var s,t,u,o,c,f;for(s=e.getTerms([n],this._options.delimiter),t=[],u=0,o=s;u<o.length;u++)if(c=o[u],f=this._index[c],f)t=t.length===0?f:r.intersect(t,f,this._comparer);else{t=[];break}return h(t,this._comparer)},t.prototype.addToIndex=function(n,t){var f,e,h,r,u,l,o,s,c,a;if(f=!0,t)for(e=0,h=t;e<h.length;e++)if(r=h[e],u=[],r){if(this._addItemToIndex(n,r)||(f=!1),this._tokenCache[r])u=this._tokenCache[r];else{for(l=r.length,o=1;o<l;o++)u.push(r.substring(0,o));this._tokenCache[r]=u}if(u)for(s=0,c=u;s<c.length;s++)a=c[s],this._addItemToIndex(n,a)||(f=!1)}return f},t.prototype.clearStrategyStore=function(){this._index={}},t.prototype._addItemToIndex=function(n,t){var u=!1,r=this._index[t];return r||(r=[],this._index[t]=r),r.indexOf(n)===-1&&(r.push(n),u=!0),u},t}(o);t.InvertedIndexStore=y;p=function(){function n(){}return n.prototype.addMoreItems=function(){},n.prototype.createSearchableObjects=function(){return[]},n.prototype.handleResults=function(){},n.prototype.handleError=function(){},n.prototype.handleClear=function(){},n.prototype.isDataSetComplete=function(){return!1},n}();t.SearchAdapter=p;w=function(){function n(n,t){this.item=n;this.terms=t}return n.prototype.setTerms=function(n){this.terms=n},n.prototype.addTerm=function(n){this.terms.push(n)},n}();t.SearchableObject=w;t.fastUnique=h;f.tfsModuleLoaded("VSS.Search",t)});
define("VSSPreview/Search/FuzzaldrinPlus",["require","exports"],function(n,t){var u,i,r;Object.defineProperty(t,"__esModule",{value:!0}),function(n){function e(n,t){return t=u(t),i.prepQuery(n,t)}function u(n){var t=n||{};return t.isPath==null&&(t.isPath=!0),t.useExtensionBonus==null&&(t.useExtensionBonus=!0),t.pathSeparator==null&&(t.pathSeparator=i.defaultPathSeparator),t.optCharRegEx==null&&(t.optCharRegEx=i.opt_char_re),t}function o(n,r,f,e){if(!(n&&r&&n.length&&r.length))return 0;e=u(e);var s=e.isPath,h=e.useExtensionBonus,c=e.optCharRegEx,o=e.pathSeparator;return f==null&&(f=t&&t.query===r?t:t=new i.Query(r,{optCharRegEx:c,pathSeparator:o})),i.score(n,r,f,s,h,o)}function s(n,f,e,o){var a,h,y;if(!(n&&f))return[];var c=u(o),v=c.key,b=c.isPath,k=c.useExtensionBonus,p=c.optCharRegEx,l=c.pathSeparator,w=v!=null,s=w?n[v]:n;return s===f?Array.apply(null,{length:s.length}).map(Number.call,Number):(e==null&&(e=t&&t.query===f?t:t=new i.Query(f,{optCharRegEx:p,pathSeparator:l})),a=s.toLocaleLowerCase(),!i.isMatch(s,e.core_lw,e.core_up))?[]:(h=r.match(s,a,e),h.length===0)?h:(s.indexOf(l)>-1&&(y=r.basenameMatch(s,a,e,l),h=r.mergeMatches(h,y)),h)}var t,f;n.prepQuery=e;f=function(){function n(n){this._options=u(n)}return n.prototype.setOptions=function(n){this._options=u(n)},n.prototype.filterCandidates=function(n,t){var l,e,d,o,a,g,s,v,r,f,y;if(!(t&&t.length&&n&&n.length))return[];var h=[],p=[],u=this._options,c=u.key,w=u.maxResults,b=u.maxInners,nt=u.isPath,tt=u.useExtensionBonus,rt=u.optCharRegEx,it=u.pathSeparator,k=n.length;for(b>0&&(k=b),l=c!=null,e=new i.Query(t,this._options),this._lastQuery=t,this._lastQueryMatchElapsed=this._lastQueryScoreElapsed=0,d=performance.now(),o=0,a=n;o<a.length;o++)if((r=a[o],f=l?r[c]:r,f)&&i.isMatch(f,e.core_lw,e.core_up)&&(p.push(r),--k==0))break;for(this._lastQueryMatchElapsed=Math.round(performance.now()-d),g=performance.now(),s=0,v=p;s<v.length;s++)(r=v[s],f=l?r[c]:r,f)&&(y=i.score(f,t,e,nt,tt,it),y>0&&h.push({candidate:r,score:y}));return this._lastQueryScoreElapsed=Math.round(performance.now()-g),h.sort(this._candidateComparer),n=h.map(function(n){return n.candidate}),!w||(n=n.slice(0,w)),n},n.prototype.getLastQueryExecutionStats=function(){return{query:this._lastQuery,matchTime:this._lastQueryMatchElapsed,scoreTime:this._lastQueryScoreElapsed}},n.prototype._candidateComparer=function(n,t){return t.score-n.score},n}();n.FuzzyFilter=f;n.score=o;n.match=s}(u=t.Fuzzaldrin||(t.Fuzzaldrin={})),function(n){function y(t,i){return i===void 0&&(i=n.opt_char_re),t.replace(i,"")}function ft(n){for(var i="",t=0,r=n.length;t<r;t++)i+=n[t].toLocaleUpperCase()[0];return i}function p(n,t,i){if(t<1)return 0;for(var u=0,r=-1;++r<t&&n[r]===i;);while(++r<t)if(n[r]===i)for(u++;++r<t&&n[r]===i;);return u}function et(n,t){return new i(n,t)}function ot(n,t,r,u,f,e){var s,o;return!n||!t?0:(s=n.toLocaleLowerCase(),r||(r=new i(t)),o=h(n,s,r),u&&(o=w(n,s,r,o,f,e)),Math.ceil(o))}function h(n,i,r){var c=r.query,s=r.query_lw,h=n?n.length:0,u=c?c.length:0,v,tt,rt,e,ft,p,o,et,w,k,pt,st,ht;if(!(h&&u))return 0;if(v=g(n,i,c,s),tt=v.score,v.count===u)return it(u,h,tt,v.pos);if(rt=i.indexOf(s),rt>-1)return b(n,i,c,s,rt,u,h);for(var a=new Array(u),y=new Array(u),ct=l(u,h),lt=Math.ceil(ut*u)+5,at=lt,f=-1;++f<u;)a[f]=0,y[f]=0;for(e=i.indexOf(s[0]),e>-1&&e--,ft=i.lastIndexOf(s[u-1],h),ft>e&&(h=ft+1),p=!0,o=0;++e<h;){if(et=i.charCodeAt(e),!r.charCodes[et]){if(!p){for(f=-1;++f<u;)y[f]=0;p=!0}continue}o=0;var vt=0,ot=0,yt=!0;for(p=!1,f=-1;++f<u;){if(w=a[f],w>o&&(o=w),k=0,pt=s.charCodeAt(f),pt===et)if(st=t(e,n,i),k=ot>0?ot:d(n,i,c,s,e,f,st),ht=vt+nt(e,st,tt,k),ht>o)o=ht,at=lt;else{if(yt&&--at<=0)return a[u-1]*ct;yt=!1}vt=w;ot=y[f];y[f]=k;a[f]=o}}return o=a[u-1],o*ct}function w(n,t,i,r,u,f){var e,c;if(r===0)return 0;for(e=n.length-1;n[e]===f;)e--;var o=n.lastIndexOf(f,e),w=e-o,s=1;if(u&&(s+=k(t,i.ext,o,e,2),r*=s),o===-1)return r;for(c=i.depth;o>-1&&c-->0;)o=n.lastIndexOf(f,o-1);var v=n.slice(o+1,e+1),b=o===-1?r:s*h(v,v.toLocaleLowerCase(),i),y=.5*a/(a+p(n,e+1,f));return y*b+(1-y)*r*l(0,rt*w)}function st(n,i,r,u){var e=n.length,o=r.length,s=0,f;if(e>12*o)return!1;for(f=-1;++f<e;)if(t(f,n,i)&&++s>u)return!1;return!0}function u(n,t,i,r,u){var e=n,f=6;return i===n&&(f+=2),r&&(f+=3),u&&(f+=1),n===t&&(r&&(e+=i===t?2:1),u&&(f+=1)),i+e*(e+f)}function b(n,i,r,f,e,o,s){var h=t(e,n,i),l,a,v,y;for(h||(l=i.indexOf(f,e+1),l>-1&&(h=t(l,n,i),h&&(e=l))),a=-1,v=0;++a<o;)r[e+a]===n[a]&&v++;return y=c(e+o-1,n,i,s),it(o,s,u(o,o,v,h,y),e)}function k(n,t,i,r,u){var f,s,o,e;if(!t.length||(f=n.lastIndexOf(".",r),!(f>i)))return 0;for(s=t.length,o=r-f,o<s&&(s=o,o=t.length),f++,e=-1;++e<s;)if(n[f+e]!==t[e])break;return e===0&&u>0?.9*k(n,t,i,f-2,u-1):e/o}function ht(n,t,i){var r=n.length,o=t.length,u,f,s,h,e;if(!r||o>r)return!1;for(u=-1,f=-1;++f<o;){for(s=t.charCodeAt(f),h=i.charCodeAt(f);++u<r;)if(e=n.charCodeAt(u),e===s||e===h)break;if(u===r)return!1}return!0}function d(n,t,i,r,f,e,o){var l=n.length,a=i.length,v=l-f,y=a-e,p=v<y?v:y,s=0,h=0;for(i[e]===n[f]&&s++;++h<p&&r[++e]===t[++f];)i[e]===n[f]&&s++;return h===1?1+2*s:u(h,a,s,o,c(f,n,t,l))}function g(n,i,e,o){var v=n.length,l=e.length,a,k,d;if(v<1||l<1)return s;for(var c=0,p=0,w=0,b=0,h=-1,y=-1;++y<l;){if(a=o[y],f(a))if(h=i.indexOf(a,h+1),h>-1){p++;continue}else break;while(++h<v)if(a===i[h]&&t(h,n,i)){e[y]===n[h]&&b++;w+=h;c++;break}if(h===v)break}return c<2?s:(k=c===l?st(n,i,e,c):!1,d=u(c,l,b,!0,k),new r(d,w/c,c+p))}function nt(n,t,i,r){var u;return(u=tt(n),t)?u+e*((i>r?i:r)+10):u+e*r}function t(n,t,i){if(n===0)return!0;var u=t[n],r=t[n-1];return f(r)||u!==i[n]&&r===i[n-1]}function c(n,t,i,r){if(n===r-1)return!0;var e=t[n],u=t[n+1];return f(u)||e===i[n]&&u!==i[n+1]}function f(n){return n===" "||n==="."||n==="-"||n==="_"||n==="/"||n==="\\"}function tt(n){var t;return n<o?(t=o-n,100+t*t):Math.max(100+o-n,0)}function l(n,t){return v/(v+Math.abs(t-n))}function it(n,t,i,r){return 2*n*(e*i+tt(r))*l(n,t)}var i,r,s;n.defaultPathSeparator="/";var e=150,o=20,a=13,v=85,rt=1.2,ut=.75;n.opt_char_re=/[ _\-:\/\\]/g;n.coreChars=y;i=function(){function t(t,i){var u,r,f;if(!t||t.length==0)return null;for(this._options=i||{optCharRegEx:n.opt_char_re,pathSeparator:n.defaultPathSeparator},this.query=t,this.query_lw=t.toLocaleLowerCase(),this.core=y(t,this._options.optCharRegEx),this.core_lw=this.core.toLocaleLowerCase(),this.core_up=ft(this.core),this.depth=p(t,t.length,this._options.pathSeparator),this.ext=this.getExtension(this.query_lw),this.charCodes=[],u=this.query_lw.length,r=-1;++r<u;)f=this.query_lw.charCodeAt(r),this.charCodes[f]=!0}return t.prototype.getExtension=function(n){var t=n.lastIndexOf(".");return t<0?"":n.substr(t+1)},t}();n.Query=i;n.prepQuery=et;r=function(){function n(n,t,i){this.score=n;this.pos=t;this.count=i}return n}();n.AcronymResult=r;s=new r(0,0,0);n.score=ot;n.scoreMain=h;n.scorePath=w;n.scorePattern=u;n.scoreExactMatch=b;n.isMatch=ht;n.scoreConsecutives=d;n.scoreAcronyms=g;n.scoreCharacter=nt;n.isWordStart=t;n.isWordEnd=c;n.isSeparator=f}(i=t.Scorer||(t.Scorer={})),function(n){function r(n,i,r,u){for(var e=n.length-1,f,o;n[e]===u;)e--;if(f=n.lastIndexOf(u,e),f===-1)return[];for(o=r.depth;o-->0;)if(f=n.lastIndexOf(u,f-1),f===-1)return[];return f++,e++,t(n.slice(f,e),i.slice(f,e),r,f)}function u(n,t){var o=n.length,e=t.length,f;if(e===0)return n.slice();if(o===0)return t.slice();for(var s=-1,i=0,r=t[i],u=[];++s<o;){for(f=n[s];r<=f&&++i<e;)r<f&&u.push(r),r=t[i];u.push(f)}while(i<e)u.push(t[i++]);return u}function t(n,t,r,u){var f,l,tt,it,y;u===void 0&&(u=0);for(var p=r.query,w=r.query_lw,b=n.length,e=p.length,ot=i.scoreAcronyms(n,t,p,w).score,k=new Array(e),d=new Array(e),rt=1,ut=2,ft=3,et=new Array(b*e),h=-1,o=-1;++o<e;)k[o]=0,d[o]=0;for(f=-1;++f<b;)for(var c=0,a=0,g=0,st=t[f],s=-1;++s<e;){var v=0,nt=0,ht=a;w[s]===st&&(tt=i.isWordStart(f,n,t),v=g>0?g:i.scoreConsecutives(n,t,p,w,f,s,tt),nt=ht+i.scoreCharacter(f,tt,ot,v));a=k[s];g=d[s];c>a?l=ut:(c=a,l=rt);nt>c?(c=nt,l=ft):v=0;k[s]=c;d[s]=v;et[++h]=c>0?l:0}for(f=b-1,o=e-1,h=f*e+o,it=!0,y=[];it&&f>=0&&o>=0;)switch(et[h]){case rt:f--;h-=e;break;case ut:o--;h--;break;case ft:y.push(f+u);o--;f--;h-=e+1;break;default:it=!1}return y.reverse(),y}n.basenameMatch=r;n.mergeMatches=u;n.match=t}(r=t.Matcher||(t.Matcher={}))});
define("VSSPreview/Search/FuzzySearch",["require","exports","VSS/Diag","VSS/Search","VSSPreview/Search/FuzzaldrinPlus"],function(n,t,i,r,u){var f,e;Object.defineProperty(t,"__esModule",{value:!0});f=function(){function n(){this._dataSet=[]}return n.prototype.getStoreSize=function(){return this._dataSet.length},n.prototype.clearStore=function(){this._dataSet=[]},n.prototype.getData=function(){return this._dataSet},n.prototype.addItem=function(n){return this._dataSet.push(n)},n.prototype.addItems=function(n){return(t=this._dataSet).push.apply(t,n);var t},n}();t.FuzzySearchDataStore=f;e=function(n){function t(t,i){var r=n.call(this)||this;return r._options=i||{},r._fuzzyFilter=new u.Fuzzaldrin.FuzzyFilter(r._options.filterOptions),r._searchStore=t?t:new f,r}return __extends(t,n),t.prototype.processItems=function(n){for(var u,t=0,r=n;t<r.length;t++)u=r[t],this._searchStore.addItem(u.item)},t.prototype.search=function(n){var u,r,t,f;return(u=$.trim(n),this.getIndexedItemsCount()===0)?[]:(r=this._searchStore.getData(),u==="")?(t=this._options.filterOptions,t&&(t.maxResults||t.maxInners)?(f=t.maxResults||t.maxInners,r.slice(0,f)):r):this._fuzzyFilter.filterCandidates(r,n)},t.prototype.clearStrategyStore=function(){this._searchStore.clearStore()},t.prototype.getIndexedItemsCount=function(){return this._searchStore.getStoreSize()},t.prototype.getIndexTotalSize=function(){return this._searchStore.getStoreSize()},t.prototype.dataExists=function(){return this._searchStore.getStoreSize()>0},t.prototype.getMatchingIndices=function(n,t){return u.Fuzzaldrin.match(n,t,null,this._options.filterOptions)},t}(r.SearchStrategy);t.FuzzySearchStrategy=e});
define("VersionControl/Scenarios/Shared/Path/PathSearchResult",["require","exports"],function(n,t){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t,i){t===void 0&&(t=!1);i===void 0&&(i=[]);this.path=n;this.isFolder=t;this.matchingIndices=i}return n}();t.PathSearchResultItem=i});
define("VersionControl/Scenarios/Shared/Path/PathSearchStrategies",["require","exports","VSS/Search","VSSPreview/Search/FuzzySearch","VersionControl/Scenarios/Shared/Path/PathSearchResult","VSS/Utils/String"],function(n,t,i,r,u,f){function a(n){for(var t,s,r,f,h={},c=[],l=function(n,t){return c.push(new i.SearchableObject(new u.PathSearchResultItem(n,t),[]))},o=0,a=n;o<a.length;o++)for(t=a[o],l(t),s=t.length-1,r=void 0;(r=t.lastIndexOf(e,s))>0;){if(f=t.substring(0,r),h[f])break;h[f]=!0;l(f,!0);s=r-1}return c}function s(n){if(n==undefined)throw new Error("searchQuery cannot be null/undefined.");return n=n.replace(/\\/g,"/"),n.replace(/^[\/]+/,"")}function v(n,t){return n.isFolder===t.isFolder?f.localeComparer(n.path,t.path):n.isFolder?-1:1}var e,o;Object.defineProperty(t,"__esModule",{value:!0});e="/";o=function(n){function t(t){var i=n.call(this,undefined,{filterOptions:{pathSeparator:e,maxResults:t,key:"path"}})||this;return i._allItems=[],i}return __extends(t,n),t.prototype.processItems=function(n){this._allItems=n},t.prototype.clearStrategyStore=function(){n.prototype.clearStrategyStore.call(this);this._currentFolderPath=undefined;this._allItems=[]},t.prototype.search=function(t){var f=this,e=t.trim(),i=this._parsePathQuery(t),r;return this._processItemsForPath(i.basePath),r=n.prototype.search.call(this,i.query).map(function(n){return new u.PathSearchResultItem(f._currentFolderPath+n.path,n.isFolder)}).map(function(n){return new u.PathSearchResultItem(n.path,n.isFolder,f.getMatchingIndices(n,e))}),i.query||r.sort(v),r},t.prototype.dataExists=function(){return Boolean(this._allItems)&&Boolean(this._allItems.length)},t.prototype._processItemsForPath=function(i){if(this._currentFolderPath==undefined||f.localeIgnoreCaseComparer(this._currentFolderPath,i)){n.prototype.clearStrategyStore.call(this);var r=t._getFolderItems(i,this._options.filterOptions.pathSeparator,this._allItems);this._currentFolderPath=r.basePath;n.prototype.processItems.call(this,r.items)}},t.prototype._parsePathQuery=function(n){var t={basePath:"",query:""};if(!n)return t;n=s(n);var u=n.length-1,r=0,i=n.lastIndexOf(this._options.filterOptions.pathSeparator);return i<r?t.query=n:(t.basePath=n.substring(r,i+1),t.query=n.substring(i+1)),t},t._getFolderItems=function(n,t,r){for(var y,h=[],o="",s=0;s<r.length;s++){var p=r[s],c=p.item,e=c.path,l=e.lastIndexOf(t),a=l===-1?0:l+1,v=e.substring(0,a);f.localeIgnoreCaseComparer(n,v)===0&&(o||(o=v),y=e.substring(a,e.length),h.push(new i.SearchableObject(new u.PathSearchResultItem(y,c.isFolder),[])))}return{items:h,basePath:o||n}},t}(r.FuzzySearchStrategy);t.InFolderSearchStrategy=o;var h=1e5,c=.2,l=function(n){function t(t){var i=n.call(this,undefined,{filterOptions:{pathSeparator:e,maxResults:t,key:"path"}})||this;return i.optimizationApplied=!1,i}return __extends(t,n),t.prototype.search=function(t){var e=this,i=s(t.trim()),r,f;return i?(!this.optimizationApplied&&this.getIndexTotalSize()>h&&(r=Math.ceil(this.getIndexTotalSize()*c),f=$.extend({},this._options.filterOptions,{maxInners:r}),this._fuzzyFilter.setOptions(f),this.optimizationApplied=!0),n.prototype.search.call(this,i).map(function(n){return new u.PathSearchResultItem(n.path,n.isFolder,e.getMatchingIndices(n,i))})):[]},t}(r.FuzzySearchStrategy);t.GlobalSearchStrategy=l;t.createSearchablePathObjects=a});
define("VersionControl/Scenarios/Shared/Path/PathsSearchSource",["require","exports","VSS/Performance","VSS/Search","VSS/Utils/String","Presentation/Scripts/TFS/TFS.OM.Common","TFS/VersionControl/GitRestClient","VersionControl/Scripts/RepositoryContext","VersionControl/Scripts/CustomerIntelligenceConstants","VersionControl/Scripts/VersionSpecUtils","VersionControl/Scenarios/Shared/Path/PathSearchStrategies","VersionControl/Scripts/Resources/TFS.Resources.VersionControl"],function(n,t,i,r,u,f,e,o,s,h,c,l){var v;Object.defineProperty(t,"__esModule",{value:!0});var y=20,a=i.getScenarioManager(),p="GitFilePathsMaxCountExceededException",w=function(){function n(n){this._repositoryContext=n;this._httpClient=f.ProjectCollection.getDefaultConnection().getHttpClient(e.GitHttpClient);var t=new v;this._inFolderSearch=new r.SearchCore(new c.InFolderSearchStrategy,t);this._globalSearch=new r.SearchCore(new c.GlobalSearchStrategy(y),t)}return n.prototype.getInFolderSearchResults=function(n,t){var i=this;return this._fetchAndSetData(t).then(function(){var t=i._inFolderSearch.beginSearch(n);return{searchText:n,results:t}})},n.prototype.getGlobalSearchResults=function(n,t){var i=this;return this._fetchAndSetData(t).then(function(){var t=i._startSearchPerformanceScenario("global",n,i._globalSearch.getStrategy().getIndexedItemsCount()),r=i._globalSearch.beginSearch(n);return t.end(),{searchText:n,results:r}})},n.prototype._fetchAndSetData=function(n){var t=this;return this._setData&&n===this._version||(this._version=n,this._setData=this._getFilePaths().then(function(n){return t._resetSearchCoresStore(n),null},function(n){var t=n.message;parseInt(n.status)===403&&u.equals(n.serverError.typeKey,p,!0)&&(t=l.PathSearch_ErrorMessageRepositoryTooLarge);throw new Error(t);})),this._setData},n.prototype._resetSearchCoresStore=function(n){var t=c.createSearchablePathObjects(n);this._inFolderSearch.clearStrategyStore();this._globalSearch.clearStrategyStore();this._inFolderSearch.addItems(t);this._globalSearch.addItems(t)},n.prototype._getFilePaths=function(){var r=this,t=h.gitVersionStringToVersionDescriptor(this._version),i=a.startScenario(s.VERSION_CONTROL_AREA,"PathsSearchSource.getFilePaths"),n=this._repositoryContext.getRepository();return this._httpClient.getFilePaths(n.project.id,n.id,undefined,t).then(function(u){var f=u.paths||[];return i.addData({repositoryId:n.id,repositoryType:o.RepositoryType[r._repositoryContext.getRepositoryType()],version:t,pathCount:f.length}),i.end(),f})},n.prototype._startSearchPerformanceScenario=function(n,t,i){var r=a.startScenario(s.VERSION_CONTROL_AREA,"PathsSearchSource.searchPath");return r.addData({repositoryId:this._repositoryContext.getRepositoryId(),repositoryType:o.RepositoryType[this._repositoryContext.getRepositoryType()],searchType:n,queryLength:t.length,totalPaths:i}),r},n}();t.PathsSearchSource=w;v=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.handleResults=function(){},t.prototype.isDataSetComplete=function(){return!0},t}(r.SearchAdapter)});
define("VersionControl/Scenarios/Shared/Path/ThrottledPathsSearchSource",["require","exports","q"],function(n,t,i){function r(n,t){var i,r;return function(u,f,e){i&&(clearTimeout(i),r&&r.resolve({searchCancelled:!0}));r=e;i=setTimeout(function(){i=null;r=null;n(u,f,e)},t)}}Object.defineProperty(t,"__esModule",{value:!0});var u=10,f=300,e=function(){function n(n,t,i){t===void 0&&(t=u);i===void 0&&(i=f);var e=this;this._searchSource=n;this._doInFolderSearch=function(n,t,i){e._searchSource.getInFolderSearchResults(n,t).then(function(n){return i.resolve({searchCancelled:!1,results:n})},i.reject)};this._doGlobalSearch=function(n,t,i){e._searchSource.getGlobalSearchResults(n,t).then(function(n){return i.resolve({searchCancelled:!1,results:n})},i.reject)};this._inFolderThrottledSearch=r(this._doInFolderSearch,t);this._globalThrottledSearch=r(this._doGlobalSearch,i)}return n.prototype.getInFolderSearchResults=function(n,t){var r=i.defer();return this._inFolderThrottledSearch(n,t,r),r.promise},n.prototype.getGlobalSearchResults=function(n,t){var r=i.defer();return this._globalThrottledSearch(n,t,r),r.promise},n}();t.ThrottledPathsSearchSource=e});
if (window.performance && window.performance.mark) { window.performance.mark('endLoadBundleInner-async'); }