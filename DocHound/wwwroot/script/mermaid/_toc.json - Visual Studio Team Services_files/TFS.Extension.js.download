//dependencies=
// Copyright (C) Microsoft Corporation. All rights reserved.
var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();define(["require","exports"],function(n,t){function o(n,t){i.addMessageListener(n,t)}function s(n){i.removeMessageListener(n)}function h(n,t,r){i.sendMessage(n,t,r)}function c(n,t,r){i.sendResponse(n,t,r)}function l(){i.ready()}function a(){return i.getConfiguration()}function v(n){i.sendLoadError(n)}function y(n){i.onConfigurationChanged(n)}function b(){return i}var u,f,e,r,p,w,i;Object.defineProperty(t,"__esModule",{value:!0});u=function(){function n(){this._currentRequestId=0;this._currentConfiguration={};this._messageListeners=[];this._isBuiltIn=!1;this._hostId="";this._internalActionIds={LOADED_ACTION_ID:"extension-loaded"}}return n.prototype.initializeIframeExtension=function(){this._initializeMessageReceiver();this.sendMessage(f.LOADED_ACTION_ID)},n.prototype.getHostId=function(){return this._hostId},n.prototype.addMessageListener=function(n,t){t===undefined&&$.isFunction(n)&&(t=n,n=null);this._messageListeners.push({actionId:n,listener:t})},n.prototype.removeMessageListener=function(n){var t=[];$.each(this._messageListeners,function(i,r){r.listener!==n&&t.push(r)});this._messageListeners=t},n.prototype._sendMessage=function(n,t,i,r){var u=this,f=null,e;$.isFunction(r)&&(f=function(n){n&&n.requestId===i&&(u.removeMessageListener(f),r.call(u,n))},this.addMessageListener(f));e=JSON.stringify({actionId:n,actionData:t||{},requestId:i});this._isBuiltIn?setTimeout(function(){u._$messagesOut.triggerHandler("message",[{data:e}])},0):window.parent.postMessage(e,"*")},n.prototype.sendMessage=function(n,t,i){this._sendMessage(n,t,++this._currentRequestId,i)},n.prototype.sendResponse=function(n,t,i){this._sendMessage(t,i,n,null)},n.prototype.ready=function(){this.sendMessage(t.ActionIds.EXTENSION_READY_ACTION_ID)},n.prototype.getConfiguration=function(){return this._currentConfiguration},n.prototype.sendLoadError=function(n){this.sendMessage(t.ActionIds.LOAD_ERROR_ACTION_ID,{errorMessage:n})},n.prototype.onConfigurationChanged=function(n){this.addMessageListener(t.ActionIds.SET_CONFIGURATION_ACTION_ID,n)},n.prototype._handleMessageReceived=function(n){var r=this,i;if(n&&n.data){try{i=JSON.parse(n.data)}catch(u){window.console&&window.console.log("Failed to parse JSON data: "+n.data)}i&&(i.actionId===t.ActionIds.SET_CONFIGURATION_ACTION_ID&&(this._currentConfiguration=i.actionData||{}),$.each(this._messageListeners,function(n,t){t.actionId&&t.actionId!==i.actionId||t.listener.call(r,i)}))}},n.prototype._initializeMessageReceiver=function(){var n=this;this._isBuiltIn=!1;window.addEventListener?window.addEventListener("message",function(t){n._handleMessageReceived(t)}):window.attachEvent("onmessage",function(t){n._handleMessageReceived(t)})},n.prototype._initializeBuiltInExtension=function(n,t,r){var u=this;this._isBuiltIn=!0;this._$messagesOut=t;this._currentRequestId=0;this._currentConfiguration={};this._messageListeners=[];this._hostId=r;i.getHostId()===""&&window.removeEventListener("message",function(n){i._handleMessageReceived(n)});n.on("message",function(n,t){u._handleMessageReceived(t)});i=this;this.sendMessage(f.LOADED_ACTION_ID)},n}();t.Extension=u;t.ActionIds={EXTENSION_READY_ACTION_ID:"extension-ready",SET_CONFIGURATION_ACTION_ID:"set-configuration",LOAD_ERROR_ACTION_ID:"extension-load-error"};f={LOADED_ACTION_ID:"extension-loaded"};t.addMessageListener=o;t.removeMessageListener=s;t.sendMessage=h;t.sendResponse=c;t.ready=l;t.getConfiguration=a;t.sendLoadError=v;t.onConfigurationChanged=y;e=function(t){function i(){return t!==null&&t.apply(this,arguments)||this}return __extends(i,t),i.createBuiltInCodeEditor=function(t,r,u){var f=new i;f._initializeBuiltInExtension(t,r,u);n(["BuiltInExtensions/Scripts/TFS.Extensions.CodeEditor"],function(n){var t=new n.CodeEditor;f._codeEditor=t;t.beginCreateBuiltInEditor(function(n){f.onConfigurationChanged(function(){t.setEditorConfig(n,f.getConfiguration())});f.ready()},f)})},i.createBuiltInDiffEditor=function(t,r,u){var f=new i;f._initializeBuiltInExtension(t,r,u);n(["BuiltInExtensions/Scripts/TFS.Extensions.CodeEditor"],function(n){var t=new n.CodeEditor;f._codeEditor=t;t.beginCreateBuiltInDiffEditor(function(n){f.onConfigurationChanged(function(){t.setDiffEditorConfig(n,f.getConfiguration())});f.ready()},f)})},i.prototype.isContentLoadInProgress=function(){return this._codeEditor?this._codeEditor.isContentLoadInProgress():null},i.prototype.getItemContents=function(n,t,i,u,f){var e=this;this.sendMessage(r.ActionIds.GET_ITEM_CONTENT,{path:n,version:t,maxContentLength:i&&i.maxContentLength||0},function(n){var t=n.actionData||{};t.error?f&&f.call(e,t.error):u&&u.call(e,t)})},i.prototype.onResetEditorDiffContent=function(n){this.addMessageListener(r.ActionIds.RESET_EDITOR_DIFF_CONTENT,n)},i.prototype.onShowNextDifference=function(n){this.addMessageListener(r.ActionIds.NEXT_DIFFERENCE,n)},i.prototype.onShowPreviousDifference=function(n){this.addMessageListener(r.ActionIds.PREVIOUS_DIFFERENCE,n)},i.prototype.onNavigateToPosition=function(n){this.addMessageListener(r.ActionIds.NAVIGATE_TO_POSITION,n)},i.prototype.sendCurrentDiffStatus=function(n,t){this.sendMessage(r.ActionIds.UPDATE_DIFF_STATUS,{prevDiffEnabled:n,nextDiffEnabled:t})},i.prototype.sendDiffLines=function(n){this.sendMessage(r.ActionIds.UPDATE_DIFF_LINES,{diffLines:n})},i.prototype.sendEditorContentChangedEvent=function(n,t){this.sendMessage(r.ActionIds.EDITOR_CONTENT_CHANGED,{isLoading:n,content:t})},i.prototype.sendEditorDirtyStateChangedEvent=function(n){this.sendMessage(r.ActionIds.EDITOR_DIRTY_STATE_CHANGED,{isDirty:n})},i.prototype.sendEditorContent=function(n,t){this.sendResponse(t,r.ActionIds.GET_EDITOR_CONTENT,{content:n})},i.prototype.sendEditorPreferencesChangedEvent=function(n){this.sendMessage(r.ActionIds.EDITOR_PREFERENCES_CHANGED,{preferences:n})},i}(u);t.VersionControlExtension=e,function(n){function t(n,t,r,u,f){i.getItemContents(n,t,r,u,f)}function r(n){i.onResetEditorDiffContent(n)}function u(n){i.onShowNextDifference(n)}function f(n){i.onShowPreviousDifference(n)}function e(n){i.onNavigateToPosition(n)}function o(n,t){i.sendCurrentDiffStatus(n,t)}function s(n){i.sendDiffLines(n)}function h(n){i.sendEditorDirtyStateChangedEvent(n)}function c(n,t){i.sendEditorContent(n,t)}n.ActionIds={GET_ITEM_CONTENT:"vc-get-content",NEXT_DIFFERENCE:"vc-next-diff",PREVIOUS_DIFFERENCE:"vc-prev-diff",NAVIGATE_TO_POSITION:"vc-navigate-to-position",UPDATE_DIFF_STATUS:"vc-update-diff-status",UPDATE_DIFF_LINES:"vc-update-diff-lines",EDITOR_CONTENT_CHANGED:"vc-editor-content-changed",EDITOR_DIRTY_STATE_CHANGED:"vc-editor-dirty-state-changed",RESET_EDITOR_DIFF_CONTENT:"vc-reset-editor-diff-content",GET_EDITOR_CONTENT:"vc-get-editor-content",GET_SCROLL_POSITION:"vc-editor-get-scroll-position",SET_SCROLL_POSITION:"vc-editor-set-scroll-position",SCROLL_POSITION_CHANGED:"vc-editor-scroll-position-changed",GET_SELECTION:"vc-editor-get-selection",SELECTION_CHANGED:"vc-editor-selection-changed",REFRESH_LAYOUT:"vc-editor-refresh-layout",DISCUSSION_THREAD_UPDATED:"vc-discussion-thread-updated",EDITOR_KEY_PRESSED:"vc-editor-key-pressed",EDITOR_CONTEXT_MENU_ITEM_CLICKED:"vc-editor-context-menu-item-clicked",EDITOR_ADD_CONTEXT_MENU_ITEM:"vc-editor-add-context-menu-item",EDITOR_CREATED:"vc-editor-created",EDITOR_ESCAPE_EDIT:"vc-editor-escape-edit",EDITOR_PREFERENCES_CHANGED:"vc-editor-preferences-changed"};n.IntegrationPointIds={FILE_VIEWER:"tfs.source-control.file-viewer",DIFF_VIEWER:"tfs.source-control.diff-viewer"};n.getItemContents=t;n.onResetEditorDiffContent=r;n.onShowNextDifference=u;n.onShowPreviousDifference=f;n.onNavigateToPosition=e;n.sendCurrentDiffStatus=o;n.sendDiffLines=s;n.sendEditorDirtyStateChangedEvent=h;n.sendEditorContent=c}(r=t.VersionControl||(t.VersionControl={})),function(n){n.ActionIds={CREATE_THREAD:"discussion-create-thread",CREATE_COMMENT:"discussion-create-comment",UPDATE_COMMENT:"discussion-update-comment",SAVE_COMMENT:"discussion-save-comment",DELETE_COMMENT:"discussion-delete-comment",SET_SELECTED_THREAD:"discussion-thread-selected",CREATE_WORK_ITEM:"discussion-create-work-item",GET_WORK_ITEM_TYPES:"discussion-get-work-item-types",UPDATE_DISCUSSION:"discussion-update-discussion"}}(p=t.Discussion||(t.Discussion={})),function(n){n.ActionIds={SET_STATUS:"adornment-set-status"}}(w=t.Adornment||(t.Adornment={}));t.getVersionControlExtension=b;i=new e;i.initializeIframeExtension()});
//direct-dependencies=
