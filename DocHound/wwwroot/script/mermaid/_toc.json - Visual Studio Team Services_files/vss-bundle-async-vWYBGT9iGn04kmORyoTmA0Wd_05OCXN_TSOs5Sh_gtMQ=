if (window.performance && window.performance.mark) { window.performance.mark('startLoadBundleInner-async'); }
define("OfficeFabric/components/Checkbox/Checkbox.classNames",["require","exports","../../Utilities","../../Styling"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getClassNames=i.memoizeFunction(function(n,t,i,u,f){return{root:r.mergeStyles("ms-Checkbox",f&&"reversed",u&&"is-checked",!i&&"is-enabled",i&&"is-disabled",t,n.root,!i&&[!u&&{selectors:{":hover .ms-Checkbox-checkbox":n.checkboxHovered,":focus .ms-Checkbox-checkbox":n.checkboxFocused}},u&&{selectors:{":hover .ms-Checkbox-checkbox":n.checkboxCheckedHovered,":focus .ms-Checkbox-checkbox":n.checkboxCheckedFocused}},{selectors:{":hover .ms-Checkbox-text":n.textHovered,":focus .ms-Checkbox-text":n.textFocused}}]),label:r.mergeStyles("ms-Checkbox-label",n.label,f&&n.labelReversed,i&&n.labelDisabled),checkbox:r.mergeStyles("ms-Checkbox-checkbox",n.checkbox,!i&&u&&n.checkboxChecked,i&&!u&&n.checkboxDisabled,i&&u&&n.checkboxCheckedDisabled),checkmark:r.mergeStyles(n.checkmark,!i&&u&&n.checkmarkChecked,i&&!u&&n.checkmarkDisabled,i&&u&&n.checkmarkCheckedDisabled),text:r.mergeStyles("ms-Checkbox-text",n.text,i&&n.textDisabled)}})});
define("OfficeFabric/components/Checkbox/Checkbox.styles",["require","exports","../../Styling","../../Utilities"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u="20px",f="200ms",e="cubic-bezier(.4, 0, .23, 1)";t.getStyles=r.memoizeFunction(function(n,t){var r=n.semanticColors,o=n.palette,v=r.inputForegroundChecked,y=r.disabledBackground,p=r.inputBorderHovered,w=r.inputBackgroundChecked,s=r.disabledText,h=r.inputBorderHovered,b=r.inputBackgroundChecked,c=r.inputBackgroundCheckedHovered,l=r.inputBackgroundCheckedHovered,a=r.disabledText,k=r.bodyText,d=r.disabledText,g={root:[i.getFocusStyle(n,-2),{padding:"0",border:"none",background:"none",margin:"0",outline:"none",display:"block",cursor:"pointer"}],label:{display:"inline-flex",margin:"0 -4px",alignItems:"center",cursor:"pointer",position:"relative",userSelect:"none",textAlign:"left"},labelReversed:{flexDirection:"row-reverse",justifyContent:"flex-end"},labelDisabled:{cursor:"default"},checkbox:{display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:u,width:u,borderWidth:"1px",borderStyle:"solid",borderColor:p,margin:"0 4px",boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:f,transitionTimingFunction:e,overflow:"hidden"},checkboxHovered:{borderColor:h},checkboxFocused:{borderColor:h},checkboxChecked:{background:b,borderColor:w},checkboxCheckedHovered:{background:c,borderColor:l},checkboxCheckedFocused:{background:c,borderColor:l},checkboxDisabled:{background:a,borderColor:s},checkboxCheckedDisabled:{background:a,borderColor:s},checkmark:{opacity:"0",color:v},checkmarkChecked:{opacity:"1"},checkmarkDisabled:{},checkmarkCheckedDisabled:{opacity:"1",color:y},text:{color:k,margin:"0 4px",fontSize:i.FontSizes.medium},textHovered:{color:o.black},textFocused:{color:o.black},textDisabled:{color:d}};return i.concatStyleSets(g,t)})});
define("OfficeFabric/components/Checkbox/Checkbox",["require","exports","tslib","react","../../Utilities","../../Icon","../../Utilities","./Checkbox.classNames","./Checkbox.styles"],function(n,t,i,r,u,f,e,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r._warnMutuallyExclusive({checked:"defaultChecked"}),r._id=u.getId("checkbox-"),r.state={isChecked:!!(t.checked!==undefined?t.checked:t.defaultChecked)},r}return i.__extends(t,n),t.prototype.componentWillReceiveProps=function(n){n.checked!==undefined&&this.setState({isChecked:!!n.checked})},t.prototype.render=function(){var n=this.props,t=n.checked,l=n.className,e=n.defaultChecked,u=n.disabled,a=n.inputProps,v=n.name,y=n.boxSide,p=n.theme,w=n.ariaLabel,b=n.ariaLabelledBy,k=n.ariaDescribedBy,d=n.styles,h=n.onRenderLabel,g=h===void 0?this._onRenderLabel:h,nt=n.checkmarkIconProps,c=t===undefined?this.state.isChecked:t,tt=y!=="start"?!0:!1;return this._classNames=o.getClassNames(s.getStyles(p,d),l,u,c,tt),r.createElement("button",i.__assign({},a,t!==undefined&&{checked:t},e!==undefined&&{defaultChecked:e},{disabled:u,ref:this._resolveRef("_checkBox"),name:v,id:this._id,role:"checkbox",type:"button",className:this._classNames.root,onClick:this._onClick,onFocus:this._onFocus,onBlur:this._onBlur,"aria-checked":c,"aria-disabled":u,"aria-label":w,"aria-labelledby":b,"aria-describedby":k}),r.createElement("label",{className:this._classNames.label,htmlFor:this._id},r.createElement("div",{className:this._classNames.checkbox},r.createElement(f.Icon,i.__assign({iconName:"CheckMark"},nt,{className:this._classNames.checkmark}))),g(this.props,this._onRenderLabel)))},Object.defineProperty(t.prototype,"checked",{get:function(){return this.state.isChecked},enumerable:!0,configurable:!0}),t.prototype.focus=function(){this._checkBox&&this._checkBox.focus()},t.prototype._onFocus=function(n){var t=this.props.inputProps;if(t&&t.onFocus)t.onFocus(n)},t.prototype._onBlur=function(n){var t=this.props.inputProps;if(t&&t.onBlur)t.onBlur(n)},t.prototype._onClick=function(n){var t=this.props,u=t.disabled,i=t.onChange,r=this.state.isChecked;n.preventDefault();n.stopPropagation();u||(i&&i(n,!r),this.props.checked===undefined&&this.setState({isChecked:!r}))},t.prototype._onRenderLabel=function(n){var t=n.label;return t?r.createElement("span",{className:this._classNames.text},t):null},t.defaultProps={boxSide:"start"},i.__decorate([u.autobind],t.prototype,"_onFocus",null),i.__decorate([u.autobind],t.prototype,"_onBlur",null),i.__decorate([u.autobind],t.prototype,"_onClick",null),i.__decorate([u.autobind],t.prototype,"_onRenderLabel",null),i.__decorate([e.customizable("Checkbox",["theme"])],t)}(u.BaseComponent);t.Checkbox=h});
define("OfficeFabric/components/Checkbox/index",["require","exports","tslib","./Checkbox"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});
define("OfficeFabric/Checkbox",["require","exports","tslib","./components/Checkbox/index"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});
define("OfficeFabric/components/Label/Label.classNames",["require","exports","../../Utilities","../../Styling"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u="@media screen and (-ms-high-contrast: active)";t.getLabelClassNames=i.memoizeFunction(function(n,t,i,f){return r.mergeStyleSets({root:["ms-Label",{color:n.semanticColors.bodyText,boxSizing:"border-box",boxShadow:"none",margin:0,display:"block",padding:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},i&&{color:n.semanticColors.disabledBodyText,selectors:(e={},e[u]={color:"GrayText"},e)},f&&{selectors:{"::after":{content:"' *'",color:n.semanticColors.errorText,paddingRight:12}}},t]});var e})});
define("OfficeFabric/components/Label/Label",["require","exports","tslib","react","../../Utilities","./Label.classNames"],function(n,t,i,r,u,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return i.__extends(t,n),t.prototype.render=function(){var n=this.props,t=n.disabled,e=n.required,o=n.children,s=n.className,h=n.theme;return r.createElement("label",i.__assign({},u.getNativeProps(this.props,u.divProperties),{className:f.getLabelClassNames(h,s,!!t,!!e).root}),o)},i.__decorate([u.customizable("Label",["theme"])],t)}(u.BaseComponent);t.Label=e});
define("OfficeFabric/components/Label/index",["require","exports","tslib","./Label"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});
define("OfficeFabric/Label",["require","exports","tslib","./components/Label/index"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});
define("OfficeFabric/components/TextField/TextField.scss",["require","exports","@microsoft/load-themed-styles"],function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.loadStyles([{rawString:".root_a2c92a8e{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0;position:relative}.screenReaderOnly_a2c92a8e{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.fieldGroup_a2c92a8e{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0;border:1px solid "},{theme:"inputBorder",defaultValue:"#a6a6a6"},{rawString:";background:"},{theme:"bodyBackground",defaultValue:"#ffffff"},{rawString:";height:32px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;position:relative}.fieldGroup_a2c92a8e:hover{border-color:"},{theme:"inputBorderHovered",defaultValue:"#333333"},{rawString:"}.fieldGroup_a2c92a8e.fieldGroupIsFocused_a2c92a8e{border-color:"},{theme:"inputFocusBorderAlt",defaultValue:"#0078d7"},{rawString:"}.rootIsDisabled_a2c92a8e .fieldGroup_a2c92a8e{background-color:"},{theme:"disabledBackground",defaultValue:"#f4f4f4"},{rawString:";border-color:"},{theme:"disabledBackground",defaultValue:"#f4f4f4"},{rawString:";pointer-events:none;cursor:default}@media screen and (-ms-high-contrast: active){.fieldGroup_a2c92a8e:hover,.fieldGroup_a2c92a8e.fieldGroupIsFocused_a2c92a8e{border-color:Highlight}}.fieldGroup_a2c92a8e::-ms-clear{display:none}.root_a2c92a8e.rootIsDisabled_a2c92a8e .field{background-color:"},{theme:"disabledBackground",defaultValue:"#f4f4f4"},{rawString:";border-color:"},{theme:"disabledBackground",defaultValue:"#f4f4f4"},{rawString:";pointer-events:none;cursor:default}.fieldAddon_a2c92a8e{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 10px;line-height:1}.field_a2c92a8e{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0;font-size:14px;border-radius:0;border:none;background:none;color:"},{theme:"bodyText",defaultValue:"#333333"},{rawString:";padding:0 12px 0 12px;width:100%;text-overflow:ellipsis;outline:0}[dir='rtl'] .field_a2c92a8e{padding:0 12px 0 12px}.field_a2c92a8e:active,.field_a2c92a8e:focus,.field_a2c92a8e:hover{outline:0}[dir='ltr'] .field_a2c92a8e.hasIcon_a2c92a8e{padding-right:24px}[dir='rtl'] .field_a2c92a8e.hasIcon_a2c92a8e{padding-left:24px}.field_a2c92a8e[disabled]{background-color:transparent;border-color:transparent;pointer-events:none;cursor:default}.field_a2c92a8e .field_a2c92a8e::-webkit-input-placeholder{color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.field_a2c92a8e .field_a2c92a8e:-ms-input-placeholder{color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.field_a2c92a8e .field_a2c92a8e::-ms-input-placeholder{color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.field .field::-webkit-input-placeholder{color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.field .field:-ms-input-placeholder{color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.field .field::-ms-input-placeholder{color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.field_a2c92a8e .field_a2c92a8e::placeholder{color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.root_a2c92a8e.rootIsRequiredLabel_a2c92a8e .ms-Label::after{content:' *';color:"},{theme:"error",defaultValue:"#a80000"},{rawString:"}.root_a2c92a8e.rootIsRequiredPlaceholderOnly_a2c92a8e .ms-TextField-fieldGroup::after{content:'*';color:"},{theme:"error",defaultValue:"#a80000"},{rawString:";position:absolute;top:-5px}[dir='ltr'] .root_a2c92a8e.rootIsRequiredPlaceholderOnly_a2c92a8e .ms-TextField-fieldGroup::after{right:-10px}[dir='rtl'] .root_a2c92a8e.rootIsRequiredPlaceholderOnly_a2c92a8e .ms-TextField-fieldGroup::after{left:-10px}.root_a2c92a8e.rootIsActive_a2c92a8e{border-color:"},{theme:"inputFocusBorderAlt",defaultValue:"#0078d7"},{rawString:"}.icon_a2c92a8e{pointer-events:none;position:absolute;bottom:5px;top:auto;font-size:16px;line-height:18px}html[dir='ltr'] .icon_a2c92a8e{right:8px}html[dir='rtl'] .icon_a2c92a8e{left:8px}.description_a2c92a8e{color:"},{theme:"bodySubtext",defaultValue:"#666666"},{rawString:";font-size:11px}.rootIsBorderless_a2c92a8e .fieldGroup_a2c92a8e{border-color:transparent;border-width:0}.root_a2c92a8e.rootIsUnderlined_a2c92a8e{border-width:0px}.root_a2c92a8e.rootIsUnderlined_a2c92a8e:hover:not(.rootIsDisabled_a2c92a8e){border-color:"},{theme:"inputBorderHovered",defaultValue:"#333333"},{rawString:"}@media screen and (-ms-high-contrast: active){.root_a2c92a8e.rootIsUnderlined_a2c92a8e:hover:not(.rootIsDisabled_a2c92a8e){border-color:Highlight}}.root_a2c92a8e.rootIsUnderlined_a2c92a8e .wrapper_a2c92a8e{display:-webkit-box;display:-ms-flexbox;display:flex;border-bottom:1px solid "},{theme:"inputBorder",defaultValue:"#a6a6a6"},{rawString:";width:100%}.root_a2c92a8e.rootIsUnderlined_a2c92a8e .wrapper_a2c92a8e.invalid_a2c92a8e,.root_a2c92a8e.rootIsUnderlined_a2c92a8e .wrapper_a2c92a8e.invalid_a2c92a8e:focus,.root_a2c92a8e.rootIsUnderlined_a2c92a8e .wrapper_a2c92a8e.invalid_a2c92a8e:hover{border-bottom:1px solid "},{theme:"errorText",defaultValue:"#a80000"},{rawString:"}.root_a2c92a8e.rootIsUnderlined_a2c92a8e .ms-Label{font-size:14px;line-height:22px;height:32px}[dir='ltr'] .root_a2c92a8e.rootIsUnderlined_a2c92a8e .ms-Label{margin-right:8px}[dir='rtl'] .root_a2c92a8e.rootIsUnderlined_a2c92a8e .ms-Label{margin-left:8px}[dir='ltr'] .root_a2c92a8e.rootIsUnderlined_a2c92a8e .ms-Label{padding-left:12px}[dir='rtl'] .root_a2c92a8e.rootIsUnderlined_a2c92a8e .ms-Label{padding-right:12px}.root_a2c92a8e.rootIsUnderlined_a2c92a8e .fieldGroup_a2c92a8e{-webkit-box-flex:1;-ms-flex:1 1 0px;flex:1 1 0px;border-width:0}[dir='ltr'] .root_a2c92a8e.rootIsUnderlined_a2c92a8e .fieldGroup_a2c92a8e{text-align:left}[dir='rtl'] .root_a2c92a8e.rootIsUnderlined_a2c92a8e .fieldGroup_a2c92a8e{text-align:right}.root_a2c92a8e.rootIsUnderlined_a2c92a8e.rootIsDisabled_a2c92a8e{border-bottom-color:"},{theme:"disabledBackground",defaultValue:"#f4f4f4"},{rawString:"}.root_a2c92a8e.rootIsUnderlined_a2c92a8e.rootIsDisabled_a2c92a8e .ms-Label{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.root_a2c92a8e.rootIsUnderlined_a2c92a8e.rootIsDisabled_a2c92a8e .field_a2c92a8e{background-color:transparent;color:"},{theme:"disabledText",defaultValue:"#a6a6a6"},{rawString:"}.root_a2c92a8e.rootIsUnderlined_a2c92a8e.rootIsDisabled_a2c92a8e .fieldGroup_a2c92a8e{background-color:transparent}.root_a2c92a8e.rootIsUnderlined_a2c92a8e.rootIsActive_a2c92a8e{border-color:"},{theme:"inputFocusBorderAlt",defaultValue:"#0078d7"},{rawString:"}@media screen and (-ms-high-contrast: active){.root_a2c92a8e.rootIsUnderlined_a2c92a8e.rootIsActive_a2c92a8e{border-color:Highlight}}.root_a2c92a8e.rootIsMultiline_a2c92a8e .fieldGroup_a2c92a8e{min-height:60px;height:auto;display:-webkit-box;display:-ms-flexbox;display:flex}.root_a2c92a8e.rootIsMultiline_a2c92a8e .field_a2c92a8e{line-height:17px;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding-top:6px;overflow:auto;width:100%}[dir='ltr'] .root_a2c92a8e.rootIsMultiline_a2c92a8e .field_a2c92a8e.hasIcon_a2c92a8e{padding-right:40px}[dir='rtl'] .root_a2c92a8e.rootIsMultiline_a2c92a8e .field_a2c92a8e.hasIcon_a2c92a8e{padding-left:40px}.errorMessage_a2c92a8e{font-size:12px;font-weight:400;color:"},{theme:"errorText",defaultValue:"#a80000"},{rawString:";margin:0;padding-top:5px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.invalid_a2c92a8e,.invalid_a2c92a8e:focus,.invalid_a2c92a8e:hover{border-color:"},{theme:"errorText",defaultValue:"#a80000"},{rawString:"}[dir='ltr'] .root_a2c92a8e.rootIsUnderlined_a2c92a8e .ms-Label{padding-left:12px}[dir='rtl'] .root_a2c92a8e.rootIsUnderlined_a2c92a8e .ms-Label{padding-right:12px}[dir='ltr'] .root_a2c92a8e.rootIsUnderlined_a2c92a8e .ms-Label{padding-right:0}[dir='rtl'] .root_a2c92a8e.rootIsUnderlined_a2c92a8e .ms-Label{padding-left:0}html[dir='ltr'] .root_a2c92a8e.rootIsUnderlined_a2c92a8e .field_a2c92a8e{text-align:left}html[dir='rtl'] .root_a2c92a8e.rootIsUnderlined_a2c92a8e .field_a2c92a8e{text-align:right}.root_a2c92a8e.rootIsMultiline_a2c92a8e .icon_a2c92a8e{padding-bottom:8px;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}[dir='ltr'] .root_a2c92a8e.rootIsMultiline_a2c92a8e .icon_a2c92a8e{padding-right:24px}[dir='rtl'] .root_a2c92a8e.rootIsMultiline_a2c92a8e .icon_a2c92a8e{padding-left:24px}.root_a2c92a8e.rootIsMultiline_a2c92a8e .field_a2c92a8e.fieldIsUnresizable_a2c92a8e{resize:none}.hidden_a2c92a8e{display:none}\n"}]);t.root="root_a2c92a8e";t.screenReaderOnly="screenReaderOnly_a2c92a8e";t.fieldGroup="fieldGroup_a2c92a8e";t.fieldGroupIsFocused="fieldGroupIsFocused_a2c92a8e";t.rootIsDisabled="rootIsDisabled_a2c92a8e";t.fieldAddon="fieldAddon_a2c92a8e";t.field="field_a2c92a8e";t.hasIcon="hasIcon_a2c92a8e";t.rootIsRequiredLabel="rootIsRequiredLabel_a2c92a8e";t.rootIsRequiredPlaceholderOnly="rootIsRequiredPlaceholderOnly_a2c92a8e";t.rootIsActive="rootIsActive_a2c92a8e";t.icon="icon_a2c92a8e";t.description="description_a2c92a8e";t.rootIsBorderless="rootIsBorderless_a2c92a8e";t.rootIsUnderlined="rootIsUnderlined_a2c92a8e";t.wrapper="wrapper_a2c92a8e";t.invalid="invalid_a2c92a8e";t.rootIsMultiline="rootIsMultiline_a2c92a8e";t.errorMessage="errorMessage_a2c92a8e";t.fieldIsUnresizable="fieldIsUnresizable_a2c92a8e";t.hidden="hidden_a2c92a8e"});
define("OfficeFabric/components/TextField/TextField",["require","exports","tslib","react","../../Label","../../Icon","../../Utilities","./TextField.scss","../../Styling"],function(n,t,i,r,u,f,e,o,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=o,c=function(n){function t(t){var i=n.call(this,t)||this;return i._warnDeprecations({iconClass:"iconProps"}),i._warnMutuallyExclusive({value:"defaultValue"}),i._id=e.getId("TextField"),i._descriptionId=e.getId("TextFieldDescription"),i.state={value:t.value||t.defaultValue||"",isFocused:!1,errorMessage:""},i._onInputChange=i._onInputChange.bind(i),i._onFocus=i._onFocus.bind(i),i._onBlur=i._onBlur.bind(i),i._delayedValidate=i._async.debounce(i._validate,i.props.deferredValidationTime),i._lastValidation=0,i._isDescriptionAvailable=!1,i}return i.__extends(t,n),Object.defineProperty(t.prototype,"value",{get:function(){return this.state.value},enumerable:!0,configurable:!0}),t.prototype.componentDidMount=function(){this._isMounted=!0;this._adjustInputHeight();this.props.validateOnLoad&&this._validate(this.state.value)},t.prototype.componentWillReceiveProps=function(n){var t=this.props.onBeforeChange;n.value!==undefined&&n.value!==this.state.value&&(t&&t(n.value),this._latestValue=n.value,this.setState({value:n.value,errorMessage:""}),this._delayedValidate(n.value))},t.prototype.componentWillUnmount=function(){this._isMounted=!1},t.prototype.render=function(){var n=this.props,g=n.className,o=n.description,nt=n.disabled,c=n.iconClass,l=n.iconProps,a=n.multiline,v=n.required,y=n.underlined,tt=n.borderless,it=n.addonString,p=n.onRenderAddon,rt=p===void 0?this._onRenderAddon:p,w=n.onRenderLabel,ut=w===void 0?this._onRenderLabel:w,b=this.state.isFocused,u=this._errorMessage,k,d,t;return this._isDescriptionAvailable=Boolean(o||u),k=i.__assign({},this.props,{componentId:this._id}),d=e.css("ms-TextField",h.root,g,(t={},t["is-required "+h.rootIsRequiredLabel]=this.props.label&&v,t["is-required "+h.rootIsRequiredPlaceholderOnly]=!this.props.label&&v,t["is-disabled "+h.rootIsDisabled]=nt,t["is-active "+h.rootIsActive]=b,t["ms-TextField--multiline "+h.rootIsMultiline]=a,t["ms-TextField--underlined "+h.rootIsUnderlined]=y,t["ms-TextField--borderless "+h.rootIsBorderless]=tt,t)),r.createElement("div",{className:d},r.createElement("div",{className:e.css("ms-TextField-wrapper",h.wrapper,y?u&&h.invalid:"")},ut(k,this._onRenderLabel),r.createElement("div",{className:e.css("ms-TextField-fieldGroup",h.fieldGroup,b&&h.fieldGroupIsFocused,u&&h.invalid)},(it!==undefined||this.props.onRenderAddon)&&r.createElement("div",{className:e.css(h.fieldAddon)},rt(this.props,this._onRenderAddon)),a?this._renderTextArea():this._renderInput(),(c||l)&&r.createElement(f.Icon,i.__assign({className:e.css(c,h.icon)},l)))),this._isDescriptionAvailable&&r.createElement("span",{id:this._descriptionId},o&&r.createElement("span",{className:e.css("ms-TextField-description",h.description)},o),u&&r.createElement("div",null,r.createElement(e.DelayedRender,null,r.createElement("p",{className:e.css("ms-TextField-errorMessage",s.AnimationClassNames.slideDownIn20,h.errorMessage)},r.createElement("span",{"aria-live":"assertive",className:h.errorText,"data-automation-id":"error-message"},u))))))},t.prototype.focus=function(){this._textElement&&this._textElement.focus()},t.prototype.select=function(){this._textElement&&this._textElement.select()},t.prototype.setSelectionStart=function(n){this._textElement&&(this._textElement.selectionStart=n)},t.prototype.setSelectionEnd=function(n){this._textElement&&(this._textElement.selectionEnd=n)},Object.defineProperty(t.prototype,"selectionStart",{get:function(){return this._textElement?this._textElement.selectionStart:-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selectionEnd",{get:function(){return this._textElement?this._textElement.selectionEnd:-1},enumerable:!0,configurable:!0}),t.prototype.setSelectionRange=function(n,t){this._textElement&&this._textElement.setSelectionRange(n,t)},t.prototype._onFocus=function(n){if(this.props.onFocus)this.props.onFocus(n);this.setState({isFocused:!0});this.props.validateOnFocusIn&&this._validate(this.state.value)},t.prototype._onBlur=function(n){if(this.props.onBlur)this.props.onBlur(n);this.setState({isFocused:!1});this.props.validateOnFocusOut&&this._validate(this.state.value)},t.prototype._onRenderLabel=function(n){var t=n.label,i=n.componentId;return t?r.createElement(u.Label,{htmlFor:i},t):null},t.prototype._onRenderAddon=function(n){var t=n.addonString;return r.createElement("span",{style:{paddingBottom:"1px"}},t)},t.prototype._getTextElementClassName=function(){var t,n;return t=this.props.multiline&&!this.props.resizable?e.css("ms-TextField-field ms-TextField-field--unresizable",h.field,h.fieldIsUnresizable):e.css("ms-TextField-field",h.field),e.css(t,this.props.inputClassName,(n={},n[h.hasIcon]=!!this.props.iconClass,n))},Object.defineProperty(t.prototype,"_errorMessage",{get:function(){var n=this.state.errorMessage;return n||(n=this.props.errorMessage),n},enumerable:!0,configurable:!0}),t.prototype._renderTextArea=function(){var n=e.getNativeProps(this.props,e.textAreaProperties,["defaultValue"]);return r.createElement("textarea",i.__assign({id:this._id},n,{ref:this._resolveRef("_textElement"),value:this.state.value,onInput:this._onInputChange,onChange:this._onInputChange,className:this._getTextElementClassName(),"aria-describedby":this._isDescriptionAvailable?this._descriptionId:null,"aria-invalid":!!this.state.errorMessage,"aria-label":this.props.ariaLabel,onFocus:this._onFocus,onBlur:this._onBlur}))},t.prototype._renderInput=function(){var n=e.getNativeProps(this.props,e.inputProperties,["defaultValue"]);return r.createElement("input",i.__assign({type:"text",id:this._id},n,{ref:this._resolveRef("_textElement"),value:this.state.value,onInput:this._onInputChange,onChange:this._onInputChange,className:this._getTextElementClassName(),"aria-label":this.props.ariaLabel,"aria-describedby":this._isDescriptionAvailable?this._descriptionId:null,"aria-invalid":!!this.state.errorMessage,onFocus:this._onFocus,onBlur:this._onBlur}))},t.prototype._onInputChange=function(n){var i=this,f=n.target,t=f.value,u;if(t!==this._latestValue){this._latestValue=t;this.setState({value:t,errorMessage:""},function(){if(i._adjustInputHeight(),i.props.onChanged)i.props.onChanged(t)});var r=this.props,e=r.validateOnFocusIn,o=r.validateOnFocusOut;e||o||this._delayedValidate(t);u=this.props.onBeforeChange;u(t)}},t.prototype._validate=function(n){var i=this,r,t,u;this._latestValidateValue!==n&&(this._latestValidateValue=n,r=this.props.onGetErrorMessage,t=r(n||""),t!==undefined?typeof t=="string"?(this.setState({errorMessage:t}),this._notifyAfterValidate(n,t)):(u=++this._lastValidation,t.then(function(t){i._isMounted&&u===i._lastValidation&&i.setState({errorMessage:t});i._notifyAfterValidate(n,t)})):this._notifyAfterValidate(n,""))},t.prototype._notifyAfterValidate=function(n,t){if(this._isMounted&&n===this.state.value&&this.props.onNotifyValidationResult)this.props.onNotifyValidationResult(t,n)},t.prototype._adjustInputHeight=function(){var n,t;this._textElement&&this.props.autoAdjustHeight&&this.props.multiline&&(n=this._textElement,n.style.height="",t=n.scrollHeight+2,n.style.height=t+"px")},t.defaultProps={multiline:!1,resizable:!0,autoAdjustHeight:!1,underlined:!1,borderless:!1,onChanged:function(){},onBeforeChange:function(){},onNotifyValidationResult:function(){},onGetErrorMessage:function(){return undefined},deferredValidationTime:200,errorMessage:"",validateOnFocusIn:!1,validateOnFocusOut:!1,validateOnLoad:!0},t}(e.BaseComponent);t.TextField=c});
define("OfficeFabric/components/TextField/index",["require","exports","tslib","./TextField"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});
define("OfficeFabric/TextField",["require","exports","tslib","./components/TextField/index"],function(n,t,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i.__exportStar(r,t)});
// Copyright (C) Microsoft Corporation. All rights reserved.
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts",["require","exports","Presentation/Scripts/TFS/Resources/TFS.Resources.Presentation"],function(n,t,i){var r,u,f,e,o,s,h;Object.defineProperty(t,"__esModule",{value:!0});t.DefaultGridHeight=300;t.LINKED_ARTIFACTS_CUSTOMER_INTELLIGENCE_AREA="linkedArtifacts",function(n){n[n.String=0]="String";n[n.Integer=1]="Integer";n[n.DateTime=2]="DateTime";n[n.PlainText=3]="PlainText";n[n.Html=4]="Html";n[n.TreePath=5]="TreePath";n[n.Double=6]="Double";n[n.Guid=7]="Guid";n[n.Boolean=8]="Boolean";n[n.Identity=9]="Identity"}(r=t.LinkColumnType||(t.LinkColumnType={})),function(n){n[n.List=0]="List";n[n.Grid=1]="Grid";n[n.FullGrid=2]="FullGrid"}(u=t.ViewMode||(t.ViewMode={})),function(n){n[n.Hidden=0]="Hidden";n[n.Default=1]="Default";n[n.Custom=2]="Custom"}(f=t.ZeroDataExperienceViewMode||(t.ZeroDataExperienceViewMode={})),function(n){n[n.Done=0]="Done";n[n.InProgress=1]="InProgress"}(e=t.FetchingLinks||(t.FetchingLinks={})),function(n){n[n.Ascending=1]="Ascending";n[n.Descending=-1]="Descending"}(o=t.SortDirection||(t.SortDirection={}));t.InternalKnownColumns={Link:{name:i.LinkedArtifacts_ColumnHeader_Link,refName:"Link"},Id:{name:i.LinkedArtifacts_ColumnHeader_Id,refName:"System.Id"},State:{name:i.LinkedArtifacts_ColumnHeader_State,refName:"System.State"},LastUpdate:{name:i.LinkedArtifacts_ColumnHeader_LastUpdate,refName:"System.ChangedDate"},Comment:{name:i.LinkedArtifacts_ColumnHeader_Comment,refName:"System.Links.Comment"}},function(n){n.ProjectName="PROJECT_NAME";n.ProjectId="PROJECT_ID"}(s=t.HostArtifactAdditionalData||(t.HostArtifactAdditionalData={})),function(n){n.ForceRerender="LA_FORCE_RERENDER"}(h=t.Events||(t.Events={}))});
define("VersionControl/Scenarios/Shared/Committing/TextFieldParentAddon",["require","exports","OfficeFabric/Tooltip","react","VersionControl/Scripts/VersionControlPath","VSS/LoaderPlugins/Css!VersionControl/Shared/Committing/TextFieldParentAddon"],function(n,t,i,r,u){Object.defineProperty(t,"__esModule",{value:!0});t.TextFieldParentAddon=function(n){return r.createElement(i.TooltipHost,{hostClassName:"vc-text-field-parent-addon",content:n.addonString,overflowMode:i.TooltipOverflowMode.Self},u.addTrailingSlash(n.addonString))}});
var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();define("VersionControl/Scenarios/Shared/FileInput",["require","exports","react","VSS/Controls","VSS/Controls/FileInput","VSS/Utils/String","VersionControl/Scripts/Controls/SourceEditing","VersionControl/Scripts/Resources/TFS.Resources.VersionControl","VersionControl/Scripts/CustomerIntelligenceConstants","VSS/Telemetry/Services"],function(n,t,i,r,u,f,e,o,s,h){Object.defineProperty(t,"__esModule",{value:!0});var c=function(n){function t(t){var i=n.call(this,t)||this;return i._decorateInputFiles(),i}return __extends(t,n),t.prototype.componentDidMount=function(){this.innerControl=this.createControl()},t.prototype.componentWillReceiveProps=function(n){this.props.onUploadedFileStateChaged(n.filesToBeUploaded);this._decorateInputFiles()},t.prototype.componentWillUnmount=function(){this.innerControl&&(this.innerControl.dispose(),this.innerControl=null)},t.prototype.render=function(){return i.createElement("div",{ref:"holder"})},t.prototype.createControl=function(){var t=this,n=this.props.isGit,i=!n,f={initialDrop:this.props.initialDrop,maximumTotalFileSize:e.Constants.MAX_EDIT_FROM_WEB_CONTENT_SIZE,detectEncoding:i,fileNamesCaseSensitive:n,updateHandler:function(n){t.props.onUploadedFileStateChaged(n.files);t._decorateInputFiles()},limitMessageFormatter:function(t,r){return h.publishEvent(new h.TelemetryEventData(s.VERSION_CONTROL_AREA,s.SOURCEEDITING_UPLOAD_LIMIT,$.extend({},r,{isGit:n,isTfvc:i}))),t+(n?o.WebEditLimitWorkaroundGit:o.WebEditLimitWorkaroundTfvc)}};return r.BaseControl.enhance(u.FileInputControl,this.refs.holder,f)},t.prototype._decorateInputFiles=function(){var t,i,r,n;if(this.innerControl&&(t=this.innerControl.getRows(),t.length>0))for(i=0,r=t.length;i<r;i++)n=t[i],this.props.fileAlreadyExists(n.result.name)?n.$fileNameElement.text(f.format(o.AddFileDialogReplaceFileFormat,n.result.name)):n.$fileNameElement.text(f.format(o.AddFileDialogNewFileFormat,n.result.name))},t}(i.Component);t.FileInput=c});
define("VSS/Flux/Component",["require","exports","react","VSS/Utils/Core"],function(n,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var u=0,f=function(n){function t(t,i){var u=n.call(this,t,i)||this;return u.state=u.getState(),u._changeDelegate=r.delegate(u,u.onChange),u}return __extends(t,n),t.prototype.getKey=function(n){return u+=1,""+n+u},t.prototype.getState=function(){return null},t.prototype.onChange=function(){var n=this.getState();this.setState(n)},t.prototype.getStore=function(){return null},t.prototype.componentDidMount=function(){var n=this.getStore();n&&n.addChangedListener(this._changeDelegate)},t.prototype.componentWillUnmount=function(){var n=this.getStore();n&&n.removeChangedListener(this._changeDelegate)},t}(i.Component);t.Component=f});
define("VSS/Flux/PlatformComponent",["require","exports","VSS/Flux/Component","react"],function(n,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var t=this,n={ref:function(n){t.onRef(n)}};return this.props.cssClass&&(n.className=this.props.cssClass),r.createElement(this.getTagName(),n,this.props.children)},t.prototype.onRef=function(n){n&&(this._control=this.createControl($(n)))},t.prototype.getTagName=function(){return"div"},t.prototype.shouldComponentUpdate=function(n){return n.shouldUpdate===!0},t.prototype.componentWillUnmount=function(){n.prototype.componentWillUnmount.call(this);this._control&&(this._control.dispose(),this._control=null)},t.prototype.createControl=function(){return null},t}(i.Component);t.Component=u});
define("Mention/Scripts/TFS.Mention.Autocomplete",["require","exports"],function(n,t){Object.defineProperty(t,"__esModule",{value:!0});var i;(function(n){n[n.WorkItem=0]="WorkItem"})(i=t.MentionType||(t.MentionType={}))});
/*!
 * jQuery UI Position 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */
(function(n){typeof define=="function"&&define.amd?define("jQueryUI/position",["jquery"],n):n(jQuery)})(function(n){return function(){function a(n,t,i){return[parseFloat(n[0])*(l.test(n[0])?t/100:1),parseFloat(n[1])*(l.test(n[1])?i/100:1)]}function r(t,i){return parseInt(n.css(t,i),10)||0}function y(t){var i=t[0];return i.nodeType===9?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:n.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}n.ui=n.ui||{};var u,f,i=Math.max,t=Math.abs,e=Math.round,o=/left|center|right/,s=/top|center|bottom/,h=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,l=/%$/,v=n.fn.position;n.position={scrollbarWidth:function(){if(u!==undefined)return u;var r,i,t=n("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'><\/div><\/div>"),f=t.children()[0];return n("body").append(t),r=f.offsetWidth,t.css("overflow","scroll"),i=f.offsetWidth,r===i&&(i=t[0].clientWidth),t.remove(),u=r-i},getScrollInfo:function(t){var i=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),r=t.isWindow||t.isDocument?"":t.element.css("overflow-y"),u=i==="scroll"||i==="auto"&&t.width<t.element[0].scrollWidth,f=r==="scroll"||r==="auto"&&t.height<t.element[0].scrollHeight;return{width:f?n.position.scrollbarWidth():0,height:u?n.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=n(t||window),r=n.isWindow(i[0]),u=!!i[0]&&i[0].nodeType===9;return{element:i,isWindow:r,isDocument:u,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:r||u?i.width():i.outerWidth(),height:r||u?i.height():i.outerHeight()}}};n.fn.position=function(u){if(!u||!u.of)return v.apply(this,arguments);u=n.extend({},u);var k,l,p,b,w,g,nt=n(u.of),it=n.position.getWithinInfo(u.within),rt=n.position.getScrollInfo(it),d=(u.collision||"flip").split(" "),tt={};return g=y(nt),nt[0].preventDefault&&(u.at="left top"),l=g.width,p=g.height,b=g.offset,w=n.extend({},b),n.each(["my","at"],function(){var n=(u[this]||"").split(" "),t,i;n.length===1&&(n=o.test(n[0])?n.concat(["center"]):s.test(n[0])?["center"].concat(n):["center","center"]);n[0]=o.test(n[0])?n[0]:"center";n[1]=s.test(n[1])?n[1]:"center";t=h.exec(n[0]);i=h.exec(n[1]);tt[this]=[t?t[0]:0,i?i[0]:0];u[this]=[c.exec(n[0])[0],c.exec(n[1])[0]]}),d.length===1&&(d[1]=d[0]),u.at[0]==="right"?w.left+=l:u.at[0]==="center"&&(w.left+=l/2),u.at[1]==="bottom"?w.top+=p:u.at[1]==="center"&&(w.top+=p/2),k=a(tt.at,l,p),w.left+=k[0],w.top+=k[1],this.each(function(){var y,g,s=n(this),h=s.outerWidth(),c=s.outerHeight(),ut=r(this,"marginLeft"),ft=r(this,"marginTop"),et=h+ut+r(this,"marginRight")+rt.width,ot=c+ft+r(this,"marginBottom")+rt.height,o=n.extend({},w),v=a(tt.my,s.outerWidth(),s.outerHeight());u.my[0]==="right"?o.left-=h:u.my[0]==="center"&&(o.left-=h/2);u.my[1]==="bottom"?o.top-=c:u.my[1]==="center"&&(o.top-=c/2);o.left+=v[0];o.top+=v[1];f||(o.left=e(o.left),o.top=e(o.top));y={marginLeft:ut,marginTop:ft};n.each(["left","top"],function(t,i){n.ui.position[d[t]]&&n.ui.position[d[t]][i](o,{targetWidth:l,targetHeight:p,elemWidth:h,elemHeight:c,collisionPosition:y,collisionWidth:et,collisionHeight:ot,offset:[k[0]+v[0],k[1]+v[1]],my:u.my,at:u.at,within:it,elem:s})});u.using&&(g=function(n){var r=b.left-o.left,a=r+l-h,f=b.top-o.top,v=f+p-c,e={target:{element:nt,left:b.left,top:b.top,width:l,height:p},element:{element:s,left:o.left,top:o.top,width:h,height:c},horizontal:a<0?"left":r>0?"right":"center",vertical:v<0?"top":f>0?"bottom":"middle"};l<h&&t(r+a)<l&&(e.horizontal="center");p<c&&t(f+v)<p&&(e.vertical="middle");e.important=i(t(r),t(a))>i(t(f),t(v))?"horizontal":"vertical";u.using.call(this,n,e)});s.offset(n.extend(o,{using:g}))})};n.ui.position={fit:{left:function(n,t){var e=t.within,u=e.isWindow?e.scrollLeft:e.offset.left,o=e.width,s=n.left-t.collisionPosition.marginLeft,r=u-s,f=s+t.collisionWidth-o-u,h;t.collisionWidth>o?r>0&&f<=0?(h=n.left+r+t.collisionWidth-o-u,n.left+=r-h):n.left=f>0&&r<=0?u:r>f?u+o-t.collisionWidth:u:r>0?n.left+=r:f>0?n.left-=f:n.left=i(n.left-s,n.left)},top:function(n,t){var o=t.within,u=o.isWindow?o.scrollTop:o.offset.top,e=t.within.height,s=n.top-t.collisionPosition.marginTop,r=u-s,f=s+t.collisionHeight-e-u,h;t.collisionHeight>e?r>0&&f<=0?(h=n.top+r+t.collisionHeight-e-u,n.top+=r-h):n.top=f>0&&r<=0?u:r>f?u+e-t.collisionHeight:u:r>0?n.top+=r:f>0?n.top-=f:n.top=i(n.top-s,n.top)}},flip:{left:function(n,i){var r=i.within,y=r.offset.left+r.scrollLeft,c=r.width,o=r.isWindow?r.scrollLeft:r.offset.left,l=n.left-i.collisionPosition.marginLeft,a=l-o,v=l+i.collisionWidth-c-o,u=i.my[0]==="left"?-i.elemWidth:i.my[0]==="right"?i.elemWidth:0,f=i.at[0]==="left"?i.targetWidth:i.at[0]==="right"?-i.targetWidth:0,e=-2*i.offset[0],s,h;a<0?(s=n.left+u+f+e+i.collisionWidth-c-y,(s<0||s<t(a))&&(n.left+=u+f+e)):v>0&&(h=n.left-i.collisionPosition.marginLeft+u+f+e-o,(h>0||t(h)<v)&&(n.left+=u+f+e))},top:function(n,i){var r=i.within,y=r.offset.top+r.scrollTop,c=r.height,o=r.isWindow?r.scrollTop:r.offset.top,l=n.top-i.collisionPosition.marginTop,a=l-o,v=l+i.collisionHeight-c-o,p=i.my[1]==="top",u=p?-i.elemHeight:i.my[1]==="bottom"?i.elemHeight:0,f=i.at[1]==="top"?i.targetHeight:i.at[1]==="bottom"?-i.targetHeight:0,e=-2*i.offset[1],s,h;a<0?(h=n.top+u+f+e+i.collisionHeight-c-y,(h<0||h<t(a))&&(n.top+=u+f+e)):v>0&&(s=n.top-i.collisionPosition.marginTop+u+f+e-o,(s>0||t(s)<v)&&(n.top+=u+f+e))}},flipfit:{left:function(){n.ui.position.flip.left.apply(this,arguments);n.ui.position.fit.left.apply(this,arguments)},top:function(){n.ui.position.flip.top.apply(this,arguments);n.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,r,u,e,o=document.getElementsByTagName("body")[0],s=document.createElement("div");t=document.createElement(o?"div":"body");r={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};o&&n.extend(r,{position:"absolute",left:"-1000px",top:"-1000px"});for(e in r)t.style[e]=r[e];t.appendChild(s);i=o||document.documentElement;i.insertBefore(t,i.firstChild);s.style.cssText="position: absolute; left: 10.7432222px;";u=n(s).offset().left;f=u>10&&u<11;t.innerHTML="";i.removeChild(t)}()}(),n.ui.position});
/*!
 * jQuery UI Menu 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/menu/
 */
(function (n) { typeof define == "function" && define.amd ? define("jQueryUI/menu",["jquery", "./core", "./widget", "./position"], n) : n(jQuery) })(function (n) { return n.widget("ui.menu", { version: "1.11.4", defaultElement: "<ul>", delay: 300, options: { icons: { submenu: "ui-icon-carat-1-e" }, items: "> *", menus: "ul", position: { my: "left-1 top", at: "right top" }, role: "menu", blur: null, focus: null, select: null }, _create: function () { this.activeMenu = this.element; this.mouseHandled = !1; this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content").toggleClass("ui-menu-icons", !!this.element.find(".ui-icon").length).attr({ role: this.options.role, tabIndex: 0 }); this.options.disabled && this.element.addClass("ui-state-disabled").attr("aria-disabled", "true"); this._on({ "mousedown .ui-menu-item": function (n) { n.preventDefault() }, "click .ui-menu-item": function (t) { var i = n(t.target); !this.mouseHandled && i.not(".ui-state-disabled").length && (this.select(t), t.isPropagationStopped() || (this.mouseHandled = !0), i.has(".ui-menu").length ? this.expand(t) : !this.element.is(":focus") && n(this.document[0].activeElement).closest(".ui-menu").length && (this.element.trigger("focus", [!0]), this.active && this.active.parents(".ui-menu").length === 1 && clearTimeout(this.timer))) }, "mouseenter .ui-menu-item": function (t) { if (!this.previousFilter) { var i = n(t.currentTarget); i.siblings(".ui-state-active").removeClass("ui-state-active"); this.focus(t, i) } }, mouseleave: "collapseAll", "mouseleave .ui-menu": "collapseAll", focus: function (n, t) { var i = this.active || this.element.find(this.options.items).eq(0); t || this.focus(n, i) }, blur: function (t) { this._delay(function () { n.contains(this.element[0], this.document[0].activeElement) || this.collapseAll(t) }) }, keydown: "_keydown" }); this.refresh(); this._on(this.document, { click: function (n) { this._closeOnDocumentClick(n) && this.collapseAll(n); this.mouseHandled = !1 } }) }, _destroy: function () { this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-menu-icons ui-front").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(); this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").removeUniqueId().removeClass("ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function () { var t = n(this); t.data("ui-menu-submenu-carat") && t.remove() }); this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content") }, _keydown: function (t) { var i, u, r, f, e = !0; switch (t.keyCode) { case n.ui.keyCode.PAGE_UP: this.previousPage(t); break; case n.ui.keyCode.PAGE_DOWN: this.nextPage(t); break; case n.ui.keyCode.HOME: this._move("first", "first", t); break; case n.ui.keyCode.END: this._move("last", "last", t); break; case n.ui.keyCode.UP: this.previous(t); break; case n.ui.keyCode.DOWN: this.next(t); break; case n.ui.keyCode.LEFT: this.collapse(t); break; case n.ui.keyCode.RIGHT: this.active && !this.active.is(".ui-state-disabled") && this.expand(t); break; case n.ui.keyCode.ENTER: case n.ui.keyCode.SPACE: this._activate(t); break; case n.ui.keyCode.ESCAPE: this.collapse(t); break; default: e = !1; u = this.previousFilter || ""; r = String.fromCharCode(t.keyCode); f = !1; clearTimeout(this.filterTimer); r === u ? f = !0 : r = u + r; i = this._filterMenuItems(r); i = f && i.index(this.active.next()) !== -1 ? this.active.nextAll(".ui-menu-item") : i; i.length || (r = String.fromCharCode(t.keyCode), i = this._filterMenuItems(r)); i.length ? (this.focus(t, i), this.previousFilter = r, this.filterTimer = this._delay(function () { delete this.previousFilter }, 1e3)) : delete this.previousFilter } e && t.preventDefault() }, _activate: function (n) { this.active.is(".ui-state-disabled") || (this.active.is("[aria-haspopup='true']") ? this.expand(n) : this.select(n)) }, refresh: function () { var i, t, u = this, f = this.options.icons.submenu, r = this.element.find(this.options.menus); this.element.toggleClass("ui-menu-icons", !!this.element.find(".ui-icon").length); r.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-front").hide().attr({ role: this.options.role, "aria-hidden": "true", "aria-expanded": "false" }).each(function () { var t = n(this), i = t.parent(), r = n("<span>").addClass("ui-menu-icon ui-icon " + f).data("ui-menu-submenu-carat", !0); i.attr("aria-haspopup", "true").prepend(r); t.attr("aria-labelledby", i.attr("id")) }); i = r.add(this.element); t = i.find(this.options.items); t.not(".ui-menu-item").each(function () { var t = n(this); u._isDivider(t) && t.addClass("ui-widget-content ui-menu-divider") }); t.not(".ui-menu-item, .ui-menu-divider").addClass("ui-menu-item").uniqueId().attr({ tabIndex: -1, role: this._itemRole() }); t.filter(".ui-state-disabled").attr("aria-disabled", "true"); this.active && !n.contains(this.element[0], this.active[0]) && this.blur() }, _itemRole: function () { return { menu: "menuitem", listbox: "option" }[this.options.role] }, _setOption: function (n, t) { n === "icons" && this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(t.submenu); n === "disabled" && this.element.toggleClass("ui-state-disabled", !!t).attr("aria-disabled", t); this._super(n, t) }, focus: function (n, t) { var i, r; this.blur(n, n && n.type === "focus"); this._scrollIntoView(t); this.active = t.first(); r = this.active.addClass("ui-state-focus").removeClass("ui-state-active"); this.options.role && this.element.attr("aria-activedescendant", r.attr("id")); this.active.parent().closest(".ui-menu-item").addClass("ui-state-active"); n && n.type === "keydown" ? this._close() : this.timer = this._delay(function () { this._close() }, this.delay); i = t.children(".ui-menu"); i.length && n && /^mouse/.test(n.type) && this._startOpening(i); this.activeMenu = t.parent(); this._trigger("focus", n, { item: t }) }, _scrollIntoView: function (t) { var e, o, i, r, u, f; this._hasScroll() && (e = parseFloat(n.css(this.activeMenu[0], "borderTopWidth")) || 0, o = parseFloat(n.css(this.activeMenu[0], "paddingTop")) || 0, i = t.offset().top - this.activeMenu.offset().top - e - o, r = this.activeMenu.scrollTop(), u = this.activeMenu.height(), f = t.outerHeight(), i < 0 ? this.activeMenu.scrollTop(r + i) : i + f > u && this.activeMenu.scrollTop(r + i - u + f)) }, blur: function (n, t) { (t || clearTimeout(this.timer), this.active) && (this.active.removeClass("ui-state-focus"), this.active = null, this._trigger("blur", n, { item: this.active })) }, _startOpening: function (n) { (clearTimeout(this.timer), n.attr("aria-hidden") === "true") && (this.timer = this._delay(function () { this._close(); this._open(n) }, this.delay)) }, _open: function (t) { var i = n.extend({ of: this.active }, this.options.position); clearTimeout(this.timer); this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden", "true"); t.show().removeAttr("aria-hidden").attr("aria-expanded", "true").position(i) }, collapseAll: function (t, i) { clearTimeout(this.timer); this.timer = this._delay(function () { var r = i ? this.element : n(t && t.target).closest(this.element.find(".ui-menu")); r.length || (r = this.element); this._close(r); this.blur(t); this.activeMenu = r }, this.delay) }, _close: function (n) { n || (n = this.active ? this.active.parent() : this.element); n.find(".ui-menu").hide().attr("aria-hidden", "true").attr("aria-expanded", "false").end().find(".ui-state-active").not(".ui-state-focus").removeClass("ui-state-active") }, _closeOnDocumentClick: function (t) { return !n(t.target).closest(".ui-menu").length }, _isDivider: function (n) { return !/[^\-\u2014\u2013\s]/.test(n.text()) }, collapse: function (n) { var t = this.active && this.active.parent().closest(".ui-menu-item", this.element); t && t.length && (this._close(), this.focus(n, t)) }, expand: function (n) { var t = this.active && this.active.children(".ui-menu ").find(this.options.items).first(); t && t.length && (this._open(t.parent()), this._delay(function () { this.focus(n, t) })) }, next: function (n) { this._move("next", "first", n) }, previous: function (n) { this._move("prev", "last", n) }, isFirstItem: function () { return this.active && !this.active.prevAll(".ui-menu-item").length }, isLastItem: function () { return this.active && !this.active.nextAll(".ui-menu-item").length }, _move: function (n, t, i) { var r; this.active && (r = n === "first" || n === "last" ? this.active[n === "first" ? "prevAll" : "nextAll"](".ui-menu-item").eq(-1) : this.active[n + "All"](".ui-menu-item").eq(0)); r && r.length && this.active || (r = this.activeMenu.find(this.options.items)[t]()); this.focus(i, r) }, nextPage: function (t) { var i, r, u; if (!this.active) { this.next(t); return } this.isLastItem() || (this._hasScroll() ? (r = this.active.offset().top, u = this.element.height(), this.active.nextAll(".ui-menu-item").each(function () { return i = n(this), i.offset().top - r - u < 0 }), this.focus(t, i)) : this.focus(t, this.activeMenu.find(this.options.items)[this.active ? "last" : "first"]())) }, previousPage: function (t) { var i, r, u; if (!this.active) { this.next(t); return } this.isFirstItem() || (this._hasScroll() ? (r = this.active.offset().top, u = this.element.height(), this.active.prevAll(".ui-menu-item").each(function () { return i = n(this), i.offset().top - r + u > 0 }), this.focus(t, i)) : this.focus(t, this.activeMenu.find(this.options.items).first())) }, _hasScroll: function () { return this.element.outerHeight() < this.element.prop("scrollHeight") }, select: function (t) { this.active = this.active || n(t.target).closest(".ui-menu-item"); var i = { item: this.active }; this.active.has(".ui-menu").length || this.collapseAll(t, !0); this._trigger("select", t, i) }, _filterMenuItems: function (t) { var i = t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&"), r = new RegExp("^" + i, "i"); return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function () { return r.test(n.trim(n(this).text())) }) } }) });
/*!
 * jQuery UI Autocomplete 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/autocomplete/
 */
(function (n) { typeof define == "function" && define.amd ? define("jQueryUI/autocomplete",["jquery", "./core", "./widget", "./position", "./menu"], n) : n(jQuery) })(function (n) { return n.widget("ui.autocomplete", { version: "1.11.4", defaultElement: "<input>", options: { appendTo: null, autoFocus: !1, delay: 300, minLength: 1, position: { my: "left top", at: "left bottom", collision: "none" }, source: null, change: null, close: null, focus: null, open: null, response: null, search: null, select: null }, requestIndex: 0, pending: 0, _create: function () { var t, i, r, u = this.element[0].nodeName.toLowerCase(), f = u === "textarea", e = u === "input"; this.isMultiLine = f ? !0 : e ? !1 : this.element.prop("isContentEditable"); this.valueMethod = this.element[f || e ? "val" : "text"]; this.isNewMenu = !0; this.element.addClass("ui-autocomplete-input").attr("autocomplete", "off"); this._on(this.element, { keydown: function (u) { if (this.element.prop("readOnly")) { t = !0; r = !0; i = !0; return } t = !1; r = !1; i = !1; var f = n.ui.keyCode; switch (u.keyCode) { case f.PAGE_UP: t = !0; this._move("previousPage", u); break; case f.PAGE_DOWN: t = !0; this._move("nextPage", u); break; case f.UP: t = !0; this._keyEvent("previous", u); break; case f.DOWN: t = !0; this._keyEvent("next", u); break; case f.ENTER: this.menu.active && (t = !0, u.preventDefault(), this.menu.select(u)); break; case f.TAB: this.menu.active && this.menu.select(u); break; case f.ESCAPE: this.menu.element.is(":visible") && (this.isMultiLine || this._value(this.term), this.close(u), u.preventDefault()); break; default: i = !0; this._searchTimeout(u) } }, keypress: function (r) { if (t) { t = !1; (!this.isMultiLine || this.menu.element.is(":visible")) && r.preventDefault(); return } if (!i) { var u = n.ui.keyCode; switch (r.keyCode) { case u.PAGE_UP: this._move("previousPage", r); break; case u.PAGE_DOWN: this._move("nextPage", r); break; case u.UP: this._keyEvent("previous", r); break; case u.DOWN: this._keyEvent("next", r) } } }, input: function (n) { if (r) { r = !1; n.preventDefault(); return } this._searchTimeout(n) }, focus: function () { this.selectedItem = null; this.previous = this._value() }, blur: function (n) { if (this.cancelBlur) { delete this.cancelBlur; return } clearTimeout(this.searching); this.close(n); this._change(n) } }); this._initSource(); this.menu = n("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({ role: null }).hide().menu("instance"); this._on(this.menu.element, { mousedown: function (t) { t.preventDefault(); this.cancelBlur = !0; this._delay(function () { delete this.cancelBlur }); var i = this.menu.element[0]; n(t.target).closest(".ui-menu-item").length || this._delay(function () { var t = this; this.document.one("mousedown", function (r) { r.target === t.element[0] || r.target === i || n.contains(i, r.target) || t.close() }) }) }, menufocus: function (t, i) { var r, u; if (this.isNewMenu && (this.isNewMenu = !1, t.originalEvent && /^mouse/.test(t.originalEvent.type))) { this.menu.blur(); this.document.one("mousemove", function () { n(t.target).trigger(t.originalEvent) }); return } u = i.item.data("ui-autocomplete-item"); !1 !== this._trigger("focus", t, { item: u }) && t.originalEvent && /^key/.test(t.originalEvent.type) && this._value(u.value); r = i.item.attr("aria-label") || u.value; r && n.trim(r).length && (this.liveRegion.children().hide(), n("<div>").text(r).appendTo(this.liveRegion)) }, menuselect: function (n, t) { var i = t.item.data("ui-autocomplete-item"), r = this.previous; this.element[0] !== this.document[0].activeElement && (this.element.focus(), this.previous = r, this._delay(function () { this.previous = r; this.selectedItem = i })); !1 !== this._trigger("select", n, { item: i }) && this._value(i.value); this.term = this._value(); this.close(n); this.selectedItem = i } }); this.liveRegion = n("<span>", { role: "status", "aria-live": "assertive", "aria-relevant": "additions" }).addClass("ui-helper-hidden-accessible").appendTo(this.document[0].body); this._on(this.window, { beforeunload: function () { this.element.removeAttr("autocomplete") } }) }, _destroy: function () { clearTimeout(this.searching); this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"); this.menu.element.remove(); this.liveRegion.remove() }, _setOption: function (n, t) { this._super(n, t); n === "source" && this._initSource(); n === "appendTo" && this.menu.element.appendTo(this._appendTo()); n === "disabled" && t && this.xhr && this.xhr.abort() }, _appendTo: function () { var t = this.options.appendTo; return t && (t = t.jquery || t.nodeType ? n(t) : this.document.find(t).eq(0)), t && t[0] || (t = this.element.closest(".ui-front")), t.length || (t = this.document[0].body), t }, _initSource: function () { var i, r, t = this; n.isArray(this.options.source) ? (i = this.options.source, this.source = function (t, r) { r(n.ui.autocomplete.filter(i, t.term)) }) : typeof this.options.source == "string" ? (r = this.options.source, this.source = function (i, u) { t.xhr && t.xhr.abort(); t.xhr = n.ajax({ url: r, data: i, dataType: "json", success: function (n) { u(n) }, error: function () { u([]) } }) }) : this.source = this.options.source }, _searchTimeout: function (n) { clearTimeout(this.searching); this.searching = this._delay(function () { var t = this.term === this._value(), i = this.menu.element.is(":visible"), r = n.altKey || n.ctrlKey || n.metaKey || n.shiftKey; t && (!t || i || r) || (this.selectedItem = null, this.search(null, n)) }, this.options.delay) }, search: function (n, t) { return (n = n != null ? n : this._value(), this.term = this._value(), n.length < this.options.minLength) ? this.close(t) : this._trigger("search", t) === !1 ? void 0 : this._search(n) }, _search: function (n) { this.pending++; this.element.addClass("ui-autocomplete-loading"); this.cancelSearch = !1; this.source({ term: n }, this._response()) }, _response: function () { var t = ++this.requestIndex; return n.proxy(function (n) { t === this.requestIndex && this.__response(n); this.pending--; this.pending || this.element.removeClass("ui-autocomplete-loading") }, this) }, __response: function (n) { n && (n = this._normalize(n)); this._trigger("response", null, { content: n }); !this.options.disabled && n && n.length && !this.cancelSearch ? (this._suggest(n), this._trigger("open")) : this._close() }, close: function (n) { this.cancelSearch = !0; this._close(n) }, _close: function (n) { this.menu.element.is(":visible") && (this.menu.element.hide(), this.menu.blur(), this.isNewMenu = !0, this._trigger("close", n)) }, _change: function (n) { this.previous !== this._value() && this._trigger("change", n, { item: this.selectedItem }) }, _normalize: function (t) { return t.length && t[0].label && t[0].value ? t : n.map(t, function (t) { return typeof t == "string" ? { label: t, value: t } : n.extend({}, t, { label: t.label || t.value, value: t.value || t.label }) }) }, _suggest: function (t) { var i = this.menu.element.empty(); this._renderMenu(i, t); this.isNewMenu = !0; this.menu.refresh(); i.show(); this._resizeMenu(); i.position(n.extend({ of: this.element }, this.options.position)); this.options.autoFocus && this.menu.next() }, _resizeMenu: function () { var n = this.menu.element; n.outerWidth(Math.max(n.width("").outerWidth() + 1, this.element.outerWidth())) }, _renderMenu: function (t, i) { var r = this; n.each(i, function (n, i) { r._renderItemData(t, i) }) }, _renderItemData: function (n, t) { return this._renderItem(n, t).data("ui-autocomplete-item", t) }, _renderItem: function (t, i) { return n("<li>").text(i.label).appendTo(t) }, _move: function (n, t) { if (!this.menu.element.is(":visible")) { this.search(null, t); return } if (this.menu.isFirstItem() && /^previous/.test(n) || this.menu.isLastItem() && /^next/.test(n)) { this.isMultiLine || this._value(this.term); this.menu.blur(); return } this.menu[n](t) }, widget: function () { return this.menu.element }, _value: function () { return this.valueMethod.apply(this.element, arguments) }, _keyEvent: function (n, t) { (!this.isMultiLine || this.menu.element.is(":visible")) && (this._move(n, t), t.preventDefault()) } }), n.extend(n.ui.autocomplete, { escapeRegex: function (n) { return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, "\\$&") }, filter: function (t, i) { var r = new RegExp(n.ui.autocomplete.escapeRegex(i), "i"); return n.grep(t, function (n) { return r.test(n.label || n.value || n) }) } }), n.widget("ui.autocomplete", n.ui.autocomplete, { options: { messages: { noResults: "No search results.", results: function (n) { return n + (n > 1 ? " results are" : " result is") + " available, use up and down arrow keys to navigate." } } }, __response: function (t) { var i; (this._superApply(arguments), this.options.disabled || this.cancelSearch) || (i = t && t.length ? this.options.messages.results(t.length) : this.options.messages.noResults, this.liveRegion.children().hide(), n("<div>").text(i).appendTo(this.liveRegion)) } }), n.ui.autocomplete });
// Copyright (C) Microsoft Corporation. All rights reserved.
define("Mention/Scripts/TFS.Mention.Helpers",["require","exports","VSS/Utils/Core","Presentation/Scripts/TFS/TFS.Host.TfsContext","jQueryUI/autocomplete"],function(n,t,i,r){function h(n,t,i,r){var h;if(typeof n=="undefined"||n===null||t===null||!t.length)return{found:{},highlightedSource:n};t=t.slice(0,e);var c=n.toUpperCase(),l=t.map(function(n){return $.ui.autocomplete.escapeRegex(n)}),o,f={},s=!1;return i===u.Prefix?(t.forEach(function(n){c.indexOf(n.toUpperCase())===0?(s=!0,f[n]=!0):f[n]=!1}),o=new RegExp("^("+l.join("|")+")","ig")):i===u.Contains&&(t.forEach(function(n){c.indexOf(n.toUpperCase())>=0?(s=!0,f[n]=!0):f[n]=!1}),o=new RegExp(l.join("|"),"ig")),h="",h=s&&r?n.replace(o,r):n,{found:f,highlightedSource:h}}function o(){return window.parent!==window}function s(){try{if(o()&&window.parent.TfsMentionHelpers)return window.parent.TfsMentionHelpers.getDefaultTfsContext()}catch(n){}return f.getDefaultTfsContext()}function c(){var n;try{n=s()}catch(t){n=null}return!!n}function l(n,t){return i.delegate(n,t)}function a(n,t,r){var u,f=i.throttledDelegate(n,t,function(){var t=u;u=null;r.apply(n,t)});return function(){return u=arguments,f()}}function v(){return window.location}function y(n){return $("<div>").html(n).text()}function p(n){if(!n)return null;var t=n.ownerDocument;return t?t.defaultView||t.parentWindow:null}function w(n){return n.charCode?!0:!1}var e,u,f;Object.defineProperty(t,"__esModule",{value:!0});e=10,function(n){n[n.Contains=0]="Contains";n[n.Prefix=1]="Prefix"}(u=t.SearchBehavior||(t.SearchBehavior={}));t.searchString=h;t.hasParentWindow=o;t.getMainTfsContext=s;t.environmentIsSupported=c;t.delegate=l;t.throttledDelegate=a;t.getWindowLocation=v;t.convertHtmlToText=y;t.getWindow=p,function(n){function t(){return r.TfsContext.getDefault()}n.getDefaultTfsContext=t}(f=t.TfsMentionHelpers||(t.TfsMentionHelpers={}));t.eventHasPrintableCharacter=w;window.TfsMentionHelpers=f});
define("Mention/Scripts/TFS.Social.Telemetry",["require","exports","Mention/Scripts/TFS.Mention.Helpers","VSS/Telemetry/Services","VSS/VSS"],function(n,t,i,r,u){Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function n(){}return n.MENTION_AREA="Mention",n.WORKITEMS_INITIALIZE_EVENT="WorkitemsInitialize",n.WORKITEMS_CLICK_EVENT="WorkitemsClick",n.PEOPLE_CLICK_EVENT="PeopleClick",n.AUTOCOMPLETE_OPEN_EVENT="AutocompleteOpen",n.AUTOCOMPLETE_SUGGEST_EVENT="AutocompleteSuggest",n.AUTOCOMPLETE_SELECT_EVENT="AutocompleteSelect",n.AUTOCOMPLETE_CANCEL_EVENT="AutocompleteCancel",n.MENTIONABLE_PREVIEW_EVENT="MentionablePreview",n.MENTIONABLE_EDIT_EVENT="MentionableEdit",n.SOCIAL_AREA="Social",n.DISCUSSION_RENDER_EVENT="DiscussionRender",n.DISCUSSION_SHOWMORE_EVENT="DiscussionShowMore",n}(),e=function(){function n(){}return n.publishAutocompleteOpenEvent=function(t){n.delayedPublish(f.AUTOCOMPLETE_OPEN_EVENT,t)},n.publishAutocompleteSuggestEvent=function(t){n.delayedPublish(f.AUTOCOMPLETE_SUGGEST_EVENT,t)},n.publishAutocompleteSelectEvent=function(t){n.delayedPublish(f.AUTOCOMPLETE_SELECT_EVENT,t)},n.publishAutocompleteCancelEvent=function(t){n.delayedPublish(f.AUTOCOMPLETE_CANCEL_EVENT,t)},n.publishWorkItemsInitializeEvent=function(t){n.delayedPublish(f.WORKITEMS_INITIALIZE_EVENT,t)},n.publishWorkItemsClickEvent=function(t){n.delayedPublish(f.WORKITEMS_CLICK_EVENT,t)},n.publishPeopleClickEvent=function(t){n.delayedPublish(f.PEOPLE_CLICK_EVENT,t)},n.publishMentionableEditEvent=function(t){n.delayedPublish(f.MENTIONABLE_EDIT_EVENT,t)},n.publishMentionablePreviewEvent=function(t){n.delayedPublish(f.MENTIONABLE_PREVIEW_EVENT,t)},n.publishDiscussionRenderEvent=function(t){n.delayedPublish(f.DISCUSSION_RENDER_EVENT,t,f.SOCIAL_AREA)},n.publishDiscussionShowMoreClickEvent=function(t){n.delayedPublish(f.DISCUSSION_SHOWMORE_EVENT,t,f.SOCIAL_AREA)},n._getTfsContext=function(){return n.tfsContext||(n.tfsContext=i.getMainTfsContext()),n.tfsContext},n._extendProperties=function(t){var i=n._getTfsContext().navigation.projectId;t=t||{};t.projectId=""+i},n.delayedPublish=function(t,i,u){u===void 0&&(u=f.MENTION_AREA);n._extendProperties(i);r.publishEvent(new r.TelemetryEventData(u,t,i))},n.publish=function(t,i){n._extendProperties(i);r.publishEvent(new r.TelemetryEventData(f.MENTION_AREA,t,i))},n}();t.EventLogging=e;u.tfsModuleLoaded("TFS.Social.Telemetry",t)});
var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__assign=this&&this.__assign||Object.assign||function(n){for(var t,r,i=1,u=arguments.length;i<u;i++){t=arguments[i];for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n};define("Mention/Scripts/TFS.Mention.Autocomplete.Controls",["require","exports","q","VSS/Controls","VSS/Utils/Core","Presentation/Scripts/TFS/TFS.Core.Utils","VSS/Utils/UI","Mention/Scripts/TFS.Mention.Helpers","Mention/Scripts/TFS.Social.Telemetry","VSS/Diag","VSS/LoaderPlugins/Css!Mention"],function(n,t,i,r,u,f,e,o,s,h){var c,l,a,v;Object.defineProperty(t,"__esModule",{value:!0}),function(n){function t(n){var t=0,r=n[0],i;return r.selectionStart?t=r.selectionStart:u.documentSelection&&(this.$inputElement.focus(),i=u.documentSelection.createRange(),i.moveStart("character",-this.$inputElement.val().length),t=i.text.length),t}function i(n,t,i){e.SelectionUtils.selectInputText(n,t,i,!1)}function r(n,t,i){var s=$._data(n[0],"events"),c,e,o,u,h,f,r;if(s)for(e=$.grep(t.split(" "),function(n){return!!n}),c={},r=0;r<e.length;r++)o=e[r],u=s[o],c[o]=u?u.length:0;if(i(),s)for(h=0;h<e.length;h++){var o=e[h],u=s[o],l=c[o];if(u&&u.length>l){for(f=[],r=l;r<u.length;r++)f.push(u[r]);for(r=u.length-f.length-1;r>=0;r--)u[r+f.length]=u[r];for(r=0;r<f.length;r++)u[r]=f[r]}}}n.getInputCaretPosition=t;n.setInputSelectionRange=i;n.moveAllAddedEventHandlersToFront=r}(c||(c={}));l=function(){function n(n,t){var r=this;this._instanceId=f.GUIDUtils.newGuid();this._plugins=[];this._sessionActive=!1;this._sessionPluginActive=!1;this._sessionStartTime=null;this._options=n;this._artifactUri=n.artifactUri;var u=this._options.pluginConfigs.filter(function(n){return Boolean(n.factory)}),e=this._options.pluginConfigs.filter(function(n){return Boolean(n.factoryPromise)}),o=e.map(function(n){return n.factoryPromise});this._pluginsPromise=i.allSettled(o).then(function(n){return r._plugins=u.map(function(n){return r._createPlugin(n,t)}),n.forEach(function(n){n.state==="fulfilled"&&n.value?r._plugins.push(r._createPlugin({factory:n.value},t)):h.logError("Failed loading mention plugin: "+n.reason)}),r._plugins})}return n.prototype._createPlugin=function(n,t){var i=this;return n.factory(__assign({select:function(n,t,r){i._sessionPluginActive&&i._pluginSelect(n,t,r)},focus:function(n,t){i._sessionPluginActive&&i._pluginFocus(n,t)},close:function(n,t){i._sessionPluginActive&&i.close(n,t)}},t,n.options))},n.prototype.initialize=function(){var n=this;return this._pluginsPromise.then(function(t){return t.forEach(function(n){n.initialize()}),n._plugins=t,n._options.pluginsInitialized&&n._options.pluginsInitialized(),null})},n.prototype.dispose=function(){this._plugins&&(this._plugins.forEach(function(n){n.dispose()}),this._plugins=null)},n.prototype.isActive=function(){return this._sessionActive},n.prototype.getActivePlugin=function(){return this._sessionPluginActive?this._getPlugin():null},n.prototype.updateSession=function(n,t){var u=this._sessionPluginActive?this._sessionPluginIndex:null,o,i,r,e;for(this._sessionPluginActive&&!this._getPlugin().canOpen(t)&&this._pluginClose(n,t),o=this._sessionPluginActive?this._sessionPluginIndex:this._plugins.length,i=null,r=0;r<o;r++)if(e=this._plugins[r].canOpen(t),e){i=r;break}this._sessionPluginActive&&i!==null&&this._pluginClose(n,t);i!==null&&(this._sessionId=f.GUIDUtils.newGuid(),this._sessionStartTime=new Date,this._sessionSuggestionSelected=!1,this._sessionPluginActive=!0,this._sessionPluginIndex=i,this._getPlugin().open(n,t),this._publishTelemetry(s.EventLogging.publishAutocompleteOpenEvent,n,this._getPlugin().getPluginName(),t,{}));u===null||this._sessionPluginActive||this._sessionClose(n,t,u);u===null&&this._sessionPluginActive&&(this._sessionActive=!0,this._options.open&&this._options.open(e))},n.prototype.suggest=function(n,t){var i=this,r,u;this._sessionPluginActive&&(r=this._getPlugin().getPluginName(),u=new Date,this._getPlugin().suggest(n,t).done(function(f){var e=$.extend({durationInMSec:""+((new Date).getTime()-u.getTime()),mentionAfrifactContext:i._options.getMentionArtifactContext?i._options.getMentionArtifactContext():undefined},f.telemetry);i._publishTelemetry(s.EventLogging.publishAutocompleteSuggestEvent,n,r,t,e)}))},n.prototype.setLastKeyEvent=function(n){this._lastKeyEvent=n},n.prototype.prefetch=function(){this._pluginsPromise.then(function(n){n.forEach(function(n){n.prefetch()})})},n.prototype.setArtifactUri=function(n){this._artifactUri=n},n.prototype.close=function(n,t){this._sessionPluginActive&&(this._pluginClose(n,t),this._sessionClose(n,t,this._sessionPluginIndex))},n.prototype._getPlugin=function(){return this._plugins[this._sessionPluginIndex]},n.prototype._pluginSelect=function(n,t,i){this._sessionPluginActive&&(this._sessionSuggestionSelected=!0,this._options.select&&this._options.select(t),this._publishTelemetry(s.EventLogging.publishAutocompleteSelectEvent,n,this._getPlugin().getPluginName(),t.getPlainText(),i))},n.prototype._pluginFocus=function(n,t){this._sessionPluginActive&&this._options.focus&&this._options.focus(t)},n.prototype._pluginClose=function(n,t){if(this._sessionPluginActive&&(this._sessionPluginActive=!1,this._getPlugin().close(n,t),!this._sessionSuggestionSelected)){var i=this._plugins[this._sessionPluginIndex].getPluginName();this._publishTelemetry(s.EventLogging.publishAutocompleteCancelEvent,n,i,t,{})}},n.prototype._sessionClose=function(){this._sessionActive&&(this._sessionActive=!1,this._options.close&&this._options.close())},n.prototype._publishTelemetry=function(t,i,r,u,f){for(var o="",e,s;i&&i.type&&!n.REGEX_TELEMETRY_UI_EVENT_TYPES.exec(i.type);)i=i.originalEvent;i&&i.type&&(o+=""+i.type,e=i,e.type==="input"&&!e.keyCode&&this._lastKeyEvent&&(e=this._lastKeyEvent),e.keyCode&&(o+=":"+e.keyCode),e.altKey&&(o+=":alt"),e.ctrlKey&&(o+=":ctrl"));s=$.extend({telemetryVersion:"0.3",artifactUri:this._artifactUri,autocompleteSessionId:this._sessionId,autocompleteSessionStartTime:this._sessionStartTime.toISOString(),time:(new Date).toISOString(),uiEvent:o,pluginName:r},f);t(s)},n.REGEX_TELEMETRY_UI_EVENT_TYPES=/^(key[a-z]+|input|blur|click)$/i,n}();t.AutocompleteSessionManager=l;a=function(){function n(t,i){this._throttledSuggest=o.throttledDelegate(this,n.AUTOCOMPLETE_DELAY_MSEC,this._suggest);this._sessionManager=new l(t,i)}return n.prototype.initialize=function(){this._sessionManager.initialize()},n.prototype.dispose=function(){this._sessionManager&&(this._sessionManager.dispose(),this._sessionManager=null)},n.prototype.prefetch=function(){this._sessionManager.prefetch()},n.prototype.handleEvent=function(n,t){return n.keyCode&&this._sessionManager.setLastKeyEvent(n),t!=void 0&&(this._sessionManager.updateSession(n,t),this._throttledSuggest(n,t)),this._sessionManager.isActive()?this._sessionManager.getActivePlugin().handle(n):void 0},n.prototype.close=function(n,t){this._sessionManager.close(n,t)},n.prototype.setArtifactUri=function(n){this._sessionManager.setArtifactUri(n)},n.prototype.isActive=function(){return this._sessionManager.isActive()},n.prototype._suggest=function(n,t){this._sessionManager&&this._sessionManager.suggest(n,t)},n.AUTOCOMPLETE_DELAY_MSEC=100,n}();t.AutocompleteManager=a;v=function(n){function t(i,r){var u=n.call(this,i,r)||this;return u._autocompleteManager=t._createAutocompleteManager({artifactUri:u._options.artifactUri,pluginConfigs:u._options.pluginConfigs,open:o.delegate(u,u._sessionOpen),close:o.delegate(u,u._sessionClose),select:o.delegate(u,u._sessionSelect),focus:o.delegate(u,u._sessionFocus),pluginsInitialized:o.delegate(u,u._pluginsInitialized)},{menuContainer:o.delegate(u,u._getMenuContainer),positioningElement:o.delegate(u,u._getPositioningElement),textElement:o.delegate(u,u.getElement)}),u}return __extends(t,n),t._createAutocompleteManager=function(n,t){return new a(n,t)},t.prototype.dispose=function(){n.prototype.dispose.call(this);this._options=null;this._autocompleteManager&&(this._autocompleteManager.dispose(),this._autocompleteManager=null);this.getElement()&&this.getElement().off(t.PASSTHROUGH_EVENT_TYPES)},t.prototype.initialize=function(){var n=this;this._lastValue=this.getElement().val();this._autocompleteManager.initialize();c.moveAllAddedEventHandlersToFront(this.getElement(),t.PASSTHROUGH_EVENT_TYPES,function(){n.getElement().on(t.PASSTHROUGH_EVENT_TYPES,o.delegate(n,n._handleEvent))})},t.prototype.prefetch=function(){this._autocompleteManager.prefetch()},t.prototype.isActive=function(){return this._autocompleteManager.isActive()},t.prototype.runAutocomplete=function(n){var t=jQuery.Event("manual");this._autocompleteManager.handleEvent(t,n)},t.prototype._getMenuContainer=function(){return this.getElement()&&this.getElement().parent()?this.getElement().parent():$(document.body)},t.prototype._getPositioningElement=function(){return this.getElement()},t.prototype._createInputText=function(n,t){var i=c.getInputCaretPosition(this.getElement());return{textBeforeSelection:t.substring(0,i),textInSelection:"",textAfterSelection:t.substring(i)}},t.prototype._handleEvent=function(n){var r,i,u,f;if(!this._suppressInputEvents||n.type!=="input")return(r=void 0,(n.type==="keyup"||n.type==="input")&&(i=this.getElement().val(),i!=this._lastValue&&(this._lastValue=i,r=this._createInputText(n,i))),u=this._autocompleteManager.isActive(),f=this._autocompleteManager.handleEvent(n,r),u&&t.INTERCEPTED_EVENT_KEYCODES.some(function(t){return t===n.keyCode}))?(n.preventDefault(),n.stopImmediatePropagation(),!1):f},t.prototype._sessionOpen=function(n){this._options.open&&this._options.open(n)},t.prototype._sessionClose=function(){this._options.close&&this._options.close()},t.prototype._sessionSelect=function(n){var t=this;this._setValue(n.getPlainText(),function(){return t._triggerInputEvent()});this._options.select&&this._options.select(n)},t.prototype._sessionFocus=function(n){this._setValue(n.getPlainText())},t.prototype._pluginsInitialized=function(){this._options.pluginsInitialized&&this._options.pluginsInitialized()},t.prototype._setValue=function(n,t){this.getElement().val(n.textBeforeSelection+n.textInSelection+n.textAfterSelection);c.setInputSelectionRange(this.getElement(),n.textBeforeSelection.length,n.textBeforeSelection.length+n.textInSelection.length);var i=this.getElement().val();i!==this._lastValue&&(t&&t(),this._lastValue=i)},t.prototype._triggerInputEvent=function(){this._suppressInputEvents=!0;try{this.getElement().trigger("input")}finally{this._suppressInputEvents=!1}},t.PASSTHROUGH_EVENT_TYPES="keyup keydown keypress input focus blur",t.INTERCEPTED_EVENT_KEYCODES=[e.KeyCode.ENTER,e.KeyCode.ESCAPE,e.KeyCode.TAB],t}(r.Enhancement);t.AutocompleteEnhancement=v});
define("Mention/Scripts/TFS.Mention",["require","exports","q","VSS/VSS","VSS/Diag","VSS/Utils/Array","VSS/FeatureAvailability/Services","Presentation/Scripts/TFS/Generated/TFS.Server.WebAccess.Constants"],function(n,t,i,r,u,f,e,o){function p(n,t,i){var r="version:1.0",u;return i&&(r+=","+i),u=$("<a>").attr("href",n).attr(c.HTML_MENTION_ATTR_NAME,r).text(t),u[0].outerHTML+"&nbsp;"}var c,y,s,l,a,h,v;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n.PATTERN_WORD_START_SEPARATOR="\\s|^|\\?|!|-|\\.|,|:|;|'|\"|\\(";n.PATTERN_WORD_END_SEPARATOR="\\s|$|\\?|!|\\.|,|:|;|-|' | \"|\\)";n.PATTERN_WORD_SEPARATOR="\\s#";n.METADATA_ATTR_SEPARATOR=":";n.HTML_MENTION_ATTR_NAME="data-vss-mention";n.HTML_MENTION_ID_ATTR="id";n.HTML_MENTION_OID_ATTR="oid";n.HTML_MENTION_ID_ATTR_PREFIX=n.HTML_MENTION_ID_ATTR+n.METADATA_ATTR_SEPARATOR;n.HTML_MENTION_OID_ATTR_PREFIX=n.HTML_MENTION_OID_ATTR+n.METADATA_ATTR_SEPARATOR;n.IDENTITY_PICKER_CONSUMER_ID="0ca36598-9c44-4a19-a3b1-74960b631990";n.DISCUSSION_MESSAGE_CLASS="discussion-messages-messagecontent"}(c=t.Constants||(t.Constants={})),function(n){n.AUTOCOMPLETE_ID="mention-autocomp-id";n.AUTOCOMPLETE_TITLE="mention-autocomp-title"}(y=t.CssClasses||(t.CssClasses={}));t.createHtmlMention=p,function(n){n[n.Text=0]="Text";n[n.Mention=1]="Mention"}(s=t.TextPartType||(t.TextPartType={}));l=function(){function n(n){n===void 0&&(n=h.getDefault());this._parserFactories=[];this._mentionsRenderer=n;e.FeatureAvailabilityService.isFeatureEnabled(o.FeatureAvailabilityFlags.WebAccessVersionControlPullRequestsMentions,!1)&&this._parserFactories.push(i.Promise(function(n){r.using(["VersionControl/Scripts/Mentions/PullRequestMentionParser"],function(t){n(function(){return t.createParser()})})}))}return n.getDefault=function(){return n._defaultInstance||(n._defaultInstance=new n),n._defaultInstance},n.prototype.registerParser=function(n){this._parsers?this._parsers.then(function(t){for(var f,r=n(),e=r.getArtifactType(),i=0,u=t;i<u.length;i++)if(f=u[i],f.getArtifactType()===e)throw new Error("Cannot register additional parser of same artifact type after initialization.");return t.push(r),t}):this._parserFactories.push(i.resolve(n))},n.prototype.getMentionsRenderer=function(){return this._mentionsRenderer},n.prototype.parseInput=function(n){return this._parsers||(this._parsers=i.allSettled(this._parserFactories).then(function(n){return n.map(function(n){return n.state=="fulfilled"?n.value():null}).filter(function(n){return n!=null})})),this._parsers.then(function(t){var i=[{Text:n,Type:s.Text}],r,u;for(r in t)u=t[r],i=$.map(i,function(n){var t=n;return t.Type===s.Mention?n:u.parseMentions(t.Text)});return i})},n.prototype.renderParts=function(n,t,i){for(var u,e=this,o=$.Deferred(),r=$(),h=0,f=[],c=0;c<t.length;c++)r=r.add("<span>");return u=function(){h++;h===t.length&&(i.parts=f.join(","),o.resolve(r))},t.forEach(function(n,t){if(n.Type===s.Mention){var i=n;f.push(e._mentionsRenderer.getTelemetryMentionSummary(i));e._mentionsRenderer.renderMention($(r[t]),i).then(function(){u(t)},function(){u(t)})}else f.push("text"),$(r[t]).text(n.Text),u(t)}),r.appendTo(n),o.promise()},n}();t.MentionProcessor=l;a=function(){function n(){}return n.prototype.parseFromText=function(){throw new Error("Not implemented");},n.prototype.getArtifactType=function(){throw new Error("Not implemented");},n.prototype.parseFromUrl=function(){throw new Error("Not implemented");},n.prototype.parseMentions=function(n){for(var t,r=[],f=this.parseFromText(n),i=0,u=0;u<f.length;u++)t=f[u],t.start>i&&r.push({Type:s.Text,Text:n.substring(i,t.start)}),r.push({Type:s.Mention,Text:n.substring(t.start,t.end),ArtifactType:this.getArtifactType(),ArtifactId:t.id}),i=t.end;return n.length>i&&r.push({Type:s.Text,Text:n.substring(i,n.length)}),r},n}();t.ArtifactMentionParser=a;h=function(){function n(){this._rendererFactories=[];this._vcRendererPromise=e.FeatureAvailabilityService.isFeatureEnabled(o.FeatureAvailabilityFlags.WebAccessVersionControlPullRequestsMentions,!1)?i.Promise(function(n){r.using(["VersionControl/Scripts/Mentions/PullRequestMentionRenderer"],function(t){n(t.createRenderer())},function(t){u.logError(t);n(null)})}):i.resolve(null)}return n.getDefault=function(){return n._defaultInstance||(n._defaultInstance=new n),n._defaultInstance},n.prototype.registerProvider=function(n){var i,u,t,r,f;if(this._renderers){for(i=n(),u=i.getArtifactType(),t=0,r=this._renderers;t<r.length;t++)if(f=r[t],f.getArtifactType()===u)throw new Error("Cannot register additional providers of same artifact type after initialization.");this._renderers.push(i)}else this._rendererFactories.push(n)},n.prototype.getRenderer=function(n){var t=this;return this._vcRendererPromise.then(function(i){return t._renderers||(t._renderers=$.map(t._rendererFactories,function(n){return n()}),i&&t._renderers.push(i)),f.first(t._renderers,function(t){return n.ArtifactType===t.getArtifactType()})})},n.prototype.renderMention=function(n,t){return this.getRenderer(t).then(function(i){if(i)return i.renderMention(t,function(t){var i=$(t);return i.appendTo(n),i});throw new Error("No rendering provider found for artifact type");})},n.prototype.getTelemetryMentionSummary=function(n){return this.getRenderer(n).then(function(t){return t?t.getTelemetryMentionSummary(n):null})},n}();t.MentionsRenderer=h;v=function(){function n(n,t,i){this._artifactsLoader=n;this._queueWaitMSec=t;this._maxBatchSize=i;this._cache={};this._queue=[];this._keyPoppedFromQueue={}}return n.prototype.getArtifactPromise=function(n){var t,r;return typeof this._cache[n]!="undefined"?t=this._cache[n]:(r=i.defer(),t=r.promise,this._cache[n]=t,this._queue.push({key:n,deferred:r}),this._keyPoppedFromQueue[n]=!1,this._delayProcessQueue(n)),t},n.prototype._delayProcessQueue=function(n){var t=this;setTimeout(function(){return t._processQueue(n)},this._queueWaitMSec)},n.prototype._processQueue=function(n){var t,i,r;if(!this._keyPoppedFromQueue[n])while(this._queue.length>0){for(i=this._maxBatchSize,this._queue.length<=i?(t=this._queue,this._queue=[]):(t=this._queue.slice(0,i),this._queue=this._queue.slice(i)),r=0;r<t.length;r++)this._keyPoppedFromQueue[t[r].key]=!0;this._processBatch(t)}},n.prototype._processBatch=function(n){var i=n.map(function(n){return n.key}),t=this._artifactsLoader(i);n.forEach(function(n){if(t.hasOwnProperty(n.key)){var i=t[n.key];i.then(function(t){n.deferred.resolve(t)},function(){n.deferred.reject.apply(n.deferred,arguments)})}else n.deferred.reject(new Error("Artifact was missing from results of batch load."))})},n}();t.ArtifactsCache=v});
define("Mention/Scripts/Resources/TFS.Resources.Mention",["require","exports"],function(require,exports){var e=exports;e.PullRequestText="Pull Request {0}";e.WorkItemMentionOptionSelected="{0}. Selected";e.AutocompleteServerError="Error loading suggestions";e.DiscussionMentionWorkItemTip="workitems (#)";e.AutocompleteSuggestionsPlural="Showing {0} suggestions";e.AutocompleteSuggestionsSingular="Showing {0} suggestion";e.AutocompleteNoSuggestions="No suggestions found";e.DiscussionShowMoreRetrievalError="Unable to show more comments";e.GitPullRequestMentionWorkItemDiscussionMessageFormat="Mentioned in {0}";e.AutocompleteLoading="Loading suggestions";e.DiscussionStateTextFormat="({0} of {1})";e.DiscussionMentionPersonTip="people (@)";e.DiscussionUserCommentedTextFormat="commented {0}";e.DiscussionShowMoreLinkText="Show more";});

// Copyright (C) Microsoft Corporation. All rights reserved.
define("Mention/Scripts/TFS.Mention.Autocomplete.JQueryAutocomplete",["require","exports","VSS/Utils/Accessibility","VSS/Diag","VSS/Utils/UI","VSS/Utils/String","Mention/Scripts/TFS.Mention.Helpers","Mention/Scripts/Resources/TFS.Resources.Mention","VSS/Utils/Core","jQueryUI/autocomplete"],function(n,t,i,r,u,f,e,o,s){var l,c,h,a;Object.defineProperty(t,"__esModule",{value:!0}),function(n){function t(n,i){var r=null,u;return n&&(u=/^key(down|up|press)$/i.test(n.type),u?r=n:n.originalEvent&&i&&i>0&&(r=t(n.originalEvent,i-1))),r}function i(n){return n.textBeforeSelection+n.textInSelection+n.textAfterSelection}n.tryGetKeyboardEvent=t;n.getStringFromInputText=i}(l||(l={})),function(n){n.AUTOCOMPLETE_CONTAINER="mention-autocomplete-container";n.AUTOCOMPLETE_FOOTER="mention-autocomplete-footer";n.AUTOCOMPLETE_FOOTER_CONTENTS="mention-autocomplete-footer-contents";n.HIGHLIGHT="mention-autocomplete-highlight";n.AUTOCOMPLETE_NO_ITEMS_FOUND="mention-autocomplete-no-items";n.AUTOCOMPLETE_FOOTER_LOADING="mention-autocomplete-loading"}(c=t.CssClasses||(t.CssClasses={})),function(n){n[n.Suggestion=0]="Suggestion";n[n.Error=1]="Error";n[n.Empty=2]="Empty";n[n.Loading=3]="Loading"}(h||(h={}));a=function(){function n(n){this._isOpen=!1;this._options=n}return n.prototype.initialize=function(){var t=this,n;this._$inputElement=$("<input>").autocomplete({appendTo:this._getMenuContainer(),autoFocus:!0,source:e.delegate(this,this._autocompleteOnSource),select:e.delegate(this,this._autocompleteOnSelect),focus:e.delegate(this,this._autocompleteOnFocus),open:e.delegate(this,this._autocompleteOnOpen),close:e.delegate(this,this._autocompleteOnClose),messages:{noResults:"",results:function(){return""}}});this._$inputElement.on("keydown keypress",function(n){e.eventHasPrintableCharacter(n)||(n.keyCode===u.KeyCode.UP||n.keyCode===u.KeyCode.DOWN||n.keyCode===u.KeyCode.PAGE_UP||n.keyCode===u.KeyCode.PAGE_DOWN)&&t._handleAutocompleteReset(n)});this._$menuContainer.on("mousewheel",function(n){n.stopPropagation()});n=this._getAutocompleteInstance();n._resizeMenu=e.delegate(this,this._autocompleteResizeMenu);n._renderMenu=e.delegate(this,this._autocompleteRenderMenu);n._renderItem=e.delegate(this,this._autocompleteRenderItem)},n.prototype.__test=function(){return{_$footer:this._$footer}},n.prototype.prefetch=function(){},n.prototype.getPluginName=function(){throw new Error("Not implemented");},n.prototype.canOpen=function(){throw new Error("Not implemented");},n.prototype.getSuggestions=function(){throw new Error("Not Implemented");},n.prototype.renderSuggestion=function(){throw new Error("Not Implemented");},n.prototype.getReplacementText=function(){throw new Error("Not Implemented");},n.prototype.getReplacementHtml=function(){throw new Error("Not Implemented");},n.prototype.afterRender=function(){},n.prototype.onClose=function(){},n.prototype.dispose=function(){this._$inputElement&&(this._$inputElement.autocomplete("destroy"),this._$inputElement.remove(),this._$inputElement=null);this._$menuContainer&&(this._$menuContainer.remove(),this._$menuContainer=null);this._options=null},n.prototype.getOptions=function(){return this._options},n.prototype.open=function(n,t){this._inputText=t;this._isOpen=!0},n.prototype.suggest=function(n,t){var i=$.Deferred();return this._inputText=t,this._$inputElement.val(l.getStringFromInputText(t)),this._$inputElement.autocomplete("search",i,n),i},n.prototype.close=function(n,t){this._inputText=t;this._$inputElement.autocomplete("close",n);this._isOpen=!1},n.prototype.handle=function(n){this._$inputElement.trigger(n)},n.prototype.isOpen=function(){return this._isOpen},n.prototype._getMenuContainer=function(){if(!this._$menuContainer){var n=this._options.menuContainer().length?this._options.menuContainer():$(document.body);this._$menuContainer=$("<div>").addClass(c.AUTOCOMPLETE_CONTAINER).appendTo(n)}return this._$menuContainer},n.prototype._getMenuMaxHeight=function(){return this._options.menuMaxHeight||n.DEFAULT_MENU_MAX_HEIGHT},n.prototype._getAutocompleteInstance=function(){return this._$inputElement.data("ui-autocomplete")},n.prototype._applySuggestionToTextBox=function(n,t,i){var f=this,e={selectionIndex:""+t.index},r=this.getReplacementText(this._inputText,t.suggestion,i),u;this._$inputElement.val(l.getStringFromInputText(r));u={getPlainText:function(){return r},getHtml:function(){return f.getReplacementHtml(t.suggestion)}};i?this._options.focus&&this._options.focus(n,u):(this._inputText=r,this._options.select&&this._options.select(n,u,e))},n.prototype._handleAutocompleteReset=function(n){var r=l.getStringFromInputText(this._inputText),u=this._$inputElement.val(),t,i;u===r&&this._options.focus&&(t=this._inputText,i={getPlainText:function(){return t},getHtml:function(){return""}},this._options.focus(n,i))},n.prototype._getMentionTextArea=function(){return this._options.textElement?this._options.textElement():null},n.prototype._autocompleteResizeMenu=function(){var r=this,t=$(this._getAutocompleteInstance().menu.element),i=this._options.positioningElement?typeof this._options.positioningElement=="function"?this._options.positioningElement():this._options.positioningElement:this._getMenuContainer(),p=this._options.isMenuWidthOverridable&&this._options.menuWidth?this._options.menuWidth:i.innerWidth(),u,f,s;t.width(p);u=$(">:first:visible",t);f=Math.max(i.zIndex()*1+1,n.MIN_MENU_ZINDEX);t.css("z-index",f);var h=i.offset(),c=h.top-$(window).scrollTop(),w=$(window).height()-c-i.outerHeight(!1)-n.MENU_FOOTER_HEIGHT,e=c>this._getMenuMaxHeight()&&this._getMenuMaxHeight()>w,o=0;if(this._options.allowHorizontalShift){var b=h.left-$(window).scrollLeft(),l=$(window).width()-b,a=t.outerWidth();o=a<l?0:a-l}if(s=function(o){$(this).css(o);r._$footer.css("z-index",f);r._$footer.width(t.width());r._$footer.height(n.MENU_FOOTER_HEIGHT);r._$footer.show();u.length>0?r._$footer.position({my:"left top-1",at:"left bottom",collision:"none",of:t}):r._$footer.position({my:"left "+(e?"bottom":"top"),at:"left "+(e?"top":"bottom"),collision:"none",of:i})},e?this._$inputElement.autocomplete({position:{my:"left bottom",at:"left-"+o+" top-"+n.MENU_FOOTER_HEIGHT,collision:"none",of:i,using:s}}):this._$inputElement.autocomplete({position:{my:"left top",at:"left-"+o+" bottom",collision:"none",of:i,using:s}}),u.length>0){var k=u.position().top,v=$(">:last:visible",t),d=v.position().top+v.outerHeight(),y=d-k,g=y<=this._getMenuMaxHeight()?y:this._getMenuMaxHeight();t.height(g);this.afterRender(t);t.css("max-height","").css("overflow","")}else t.css("max-height",0).css("overflow","hidden")},n.prototype._renderFooter=function(n,t){return this._$footer||(this._$footer=$("<div>").addClass(c.AUTOCOMPLETE_FOOTER),t&&this._$footer.addClass(t),this._$footer.appendTo(this._$menuContainer).hide()),this._$footer.attr("class",c.AUTOCOMPLETE_FOOTER),t&&this._$footer.addClass(t),i.announce(n,!0),this._$footer.text(n)},n.prototype._autocompleteRenderMenu=function(n,t){var i=this._getAutocompleteInstance();n.addClass("mention-autocomplete-menu").attr("role","listbox");t[0].type===h.Suggestion?(t.forEach(function(t){i._renderItemData(n,t)}),this._renderFooter(this._getFooterItemsCountString(t.length),c.AUTOCOMPLETE_FOOTER_CONTENTS)):(this._addFakeAnchor(n,t[0]),t[0].type===h.Loading?this._renderFooter(o.AutocompleteLoading,c.AUTOCOMPLETE_FOOTER_LOADING):t[0].type===h.Empty?this._renderFooter(o.AutocompleteNoSuggestions,c.AUTOCOMPLETE_NO_ITEMS_FOUND):t[0].type===h.Error&&this._renderFooter(o.AutocompleteServerError))},n.prototype._getFooterItemsCountString=function(n){if(n===0)return o.AutocompleteNoSuggestions;var t=n===1?o.AutocompleteSuggestionsSingular:o.AutocompleteSuggestionsPlural;return f.format(t,n)},n.prototype._addFakeAnchor=function(n,t){var i=$("<li>").hide().appendTo(n).data("ui-autocomplete-item",t);$("<a>").appendTo(i)},n.prototype._autocompleteRenderItem=function(n,t){return this.renderSuggestion(n,t.suggestion).addClass("mention-autocomplete-item").attr("role","option").attr("aria-selected","false")},n.prototype._autocompleteOnSource=function(t,i){var r=t.term,u;if(r&&r.resolve||(r=null),!this._isOpen){this._getAutocompleteInstance().close();i(null);return}u=!1;this.getSuggestions(this._inputText).done(function(n){var f,t;u=!0;n?(f=n.result&&n.result.length?n.result.map(function(n,t){return{type:h.Suggestion,index:t,suggestion:n,error:null}}):[{type:h.Empty,index:null,suggestion:null,error:null}],r&&r.resolve(n),i(f)):(t=new Error("Suggestions is Null"),r&&r.reject(t),i([{type:h.Error,index:null,suggestion:null,error:t}]))}).fail(function(n){u=!0;r&&r.reject(n);i([{type:h.Error,index:null,suggestion:null,error:n}])});setTimeout(function(){u||i([{type:h.Loading,index:null,suggestion:null,error:null}])},n.LOADING_DELAY_TIME)},n.prototype._autocompleteOnFocus=function(n,t){var f=this,i,r,u;return t.item.type===h.Suggestion&&(this._applySuggestionToTextBox(n,t.item,!0),t.item.value=this._$inputElement.val(),$(".ui-helper-hidden-accessible").hide().attr("aria-live","off")),i=this._$menuContainer.find("ul"),i&&i.length&&(r=this._getMentionTextArea(),u=i.find(".mention-autocomplete-item"),u.each(function(n,t){var i=$(t);i.hasClass("ui-state-focus")?(i.attr("aria-selected","true"),r&&s.delay(f,0,function(){r.attr("aria-activedescendant",i.attr("id"))})):i.attr("aria-selected","false")})),!1},n.prototype._autocompleteOnSelect=function(n,t){return t.item.type===h.Suggestion&&this._applySuggestionToTextBox(n,t.item,!1),!1},n.prototype._autocompleteOnOpen=function(){var t=this._getMentionTextArea(),n=$(this._getAutocompleteInstance().menu.element);t&&n&&n.length&&t.attr({"aria-owns":n[0].id,"aria-expanded":"true","aria-autocomplete":"list"})},n.prototype._autocompleteOnClose=function(n){var r=$(this._getAutocompleteInstance().menu.element),t,i;if(r)this.onClose(r);this._$footer.hide();t=l.tryGetKeyboardEvent(n,5);t&&t.keyCode===u.KeyCode.ESCAPE&&this._handleAutocompleteReset(n);this._options.close&&this._options.close(n,this._inputText);i=this._getMentionTextArea();i&&i.attr({"aria-owns":null,"aria-autocomplete":null,"aria-activedescendant":null,"aria-expanded":"false"})},n.MENU_FOOTER_HEIGHT=20,n.DEFAULT_MENU_MAX_HEIGHT=200,n.LOADING_DELAY_TIME=100,n.MIN_MENU_ZINDEX=100,n}();t.JQueryAutocompletePlugin=a});
define("Mention/Scripts/TFS.Mention.WorkItems",["require","exports","q","VSS/Diag","Mention/Scripts/TFS.Mention","Mention/Scripts/TFS.Mention.Autocomplete.JQueryAutocomplete","Mention/Scripts/TFS.Mention.Helpers","VSS/Service","Mention/Scripts/TFS.Social.Telemetry","Presentation/Scripts/URI","VSS/Utils/Array","VSS/Utils/String","VSS/VSS","Presentation/Scripts/TFS/Generated/TFS.WorkItemTracking.Constants","TFS/WorkItemTracking/RestClient","Presentation/Scripts/TFS/FeatureRef/WorkItemTypeColorAndIconsProvider","Presentation/Scripts/TFS/Components/WorkItemTypeIcon","VSS/Error"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){function ft(n){var r=e.getMainTfsContext(),s=r.getPermalinkUrl("edit","workitems",{parameters:n.id,collectionId:r.navigation.collection.instanceId}),t=new h(s),i,f,o;return t.host()||(i=e.getWindowLocation(),t.host(i.host),t.protocol(i.protocol)),f=k.getWorkItemTypeWithIdString(n),o=k.getWorkItemSummary(f,n.title),u.createHtmlMention(t.href(),o)}var rt,et,nt,ot,g,st,k,d,tt,it,ht,ut;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n.ACTION_WORKITEM_OPEN="open-work-item";n.ACTION_WORKITEM_OPEN_IN_NEW_TAB="open-work-item-in-new-tab";n.EDITOR_CAPTION="{0} {1}";n.EDITOR_WINDOW_TITLE="{0}: {1}"}(rt=t.WorkItemConstants||(t.WorkItemConstants={})),function(n){n.MENTION_WIDGET_WORKITEM="mention-widget-workitem"}(et=t.CssClasses||(t.CssClasses={}));nt=function(){function n(){}return n.searchHighlightedWorkItem=function(t,i,r){r===void 0&&(r=n.DEFAULT_HIGHLIGHT_SUBSTITUTION_PATTERN);var f=i,u=t.split(/\s+/).filter(function(n){return!!n}).map(function(n){return l.htmlEncode(n)}),o=e.searchString(i.id.toString(),u,e.SearchBehavior.Prefix,r),s=e.searchString(l.htmlEncode(i.title),u,e.SearchBehavior.Contains,r),h=e.searchString(i.workItemType,u,e.SearchBehavior.Contains,r),c=!0;return u.forEach(function(n){var t=o.found[n]||s.found[n]||h.found[n];t||(c=!1)}),c&&(f={id:o.highlightedSource,title:s.highlightedSource,workItemType:h.highlightedSource}),f},n.DEFAULT_HIGHLIGHT_SUBSTITUTION_PATTERN='<span class="'+f.CssClasses.HIGHLIGHT+'">$&<\/span>',n}();t.Helpers=nt;ot=function(n){function t(i){var r=this,i=i||{};return i.isMenuWidthOverridable&&$.extend(i,{menuWidth:t.MENU_WIDTH}),r=n.call(this,i)||this,r._iconContainers=[],r}return __extends(t,n),t.prototype.getWorkItemProvider=function(){return this._workItemProvider||(this._workItemProvider=new d({wiql:this._options.wiql})),this._workItemProvider},t.prototype.prefetch=function(){this.getWorkItemProvider()},t.prototype.getPluginName=function(){return"WorkItemAutocompleteProvider"},t.prototype.canOpen=function(n){var t=this.mentionPattern().exec(n.textBeforeSelection),i;return t?(i=t.index,t[1]&&(i+=t[1].length),{start:i,end:n.textBeforeSelection.length}):null},t.prototype.getSuggestions=function(n){var f=$.Deferred(),i={},e=t._numberMentionPattern.exec(n.textBeforeSelection),r,u;return e?(i.searchTerm=e[2],r=this.getWorkItemProvider().searchById(e[2])):(u=this.mentionPattern().exec(n.textBeforeSelection),u?(i.searchTerm=u[2],r=this.getWorkItemProvider().search(u[2])):(i.searchTerm="",r=this.getWorkItemProvider().search(""))),r.done(function(n){i.suggestionsCount=""+n.length;f.resolve({result:n,telemetry:i})}).fail(function(n){f.reject(n)}),f},t.prototype.renderSuggestion=function(n,t){var i=$("<li>").appendTo(n),r=$("<a>").appendTo(i),f=$("<div>"),e=f[0];this._iconContainers.push(e);w.renderWorkItemTypeIcon(e,t.highlighted.workItemType,t.original.colorAndIcon,w.IconlessMode.ColorBar,{ariaAttributes:{}});r.append(f[0].innerHTML);var s=k.getWorkItemTypeWithIdString(t.highlighted),h=$("<span>").addClass(u.CssClasses.AUTOCOMPLETE_ID).html(s)[0].outerHTML,c=$("<span>").addClass(u.CssClasses.AUTOCOMPLETE_TITLE).html(t.highlighted.title)[0].outerHTML,o=$(k.getWorkItemSummary(h,c));return o.appendTo(r),i.attr("aria-label",o.text()),i},t.prototype.afterRender=function(n){$("a",n).each(function(n,t){t.clientWidth>=t.scrollWidth&&$(t).removeAttr("title")})},t.prototype.onClose=function(n){this._cleanup(n)},t.prototype._cleanup=function(){this._iconContainers.forEach(function(n){w.unmountWorkItemTypeIcon(n)});this._iconContainers=[]},t.prototype.getReplacementText=function(n,i,r){var u=this.mentionPattern().exec(n.textBeforeSelection),e=u.index+u[1].length+1,o=n.textBeforeSelection.substr(0,e),f=i.original.id.toString();return t._afterMentionPattern.exec(n.textAfterSelection)||(f+=" "),r?{textBeforeSelection:n.textBeforeSelection,textInSelection:"",textAfterSelection:n.textAfterSelection}:{textBeforeSelection:o+f,textInSelection:"",textAfterSelection:n.textAfterSelection}},t.prototype.getReplacementHtml=function(n){return ft(n.original)},t.prototype.getProviderName=function(){return"WorkItemAutocompleteProvider"},t.prototype.mentionPattern=function(){return this.isOpen()?t._multipleTermsMentionPattern:t._singleTermMentionPattern},t._numberMentionPattern=new RegExp("("+u.Constants.PATTERN_WORD_START_SEPARATOR+")#([0-9]*)$","i"),t._singleTermMentionPattern=new RegExp("("+u.Constants.PATTERN_WORD_START_SEPARATOR+")#(([^"+u.Constants.PATTERN_WORD_SEPARATOR+"]*)$)","i"),t._multipleTermsMentionPattern=new RegExp("("+u.Constants.PATTERN_WORD_START_SEPARATOR+")#(([^"+u.Constants.PATTERN_WORD_SEPARATOR+"]+\\s?){0,5}$)","i"),t._afterMentionPattern=new RegExp("^("+u.Constants.PATTERN_WORD_END_SEPARATOR+")","i"),t.MENU_WIDTH=450,t}(f.JQueryAutocompletePlugin);t.WorkItemAutocompleteProvider=ot;g=function(){function n(){}return n.getDefault=function(){return n._instance||(n._instance=new n),n._instance},n.prototype.getArtifactType=function(){return"WorkItem"},n.prototype._renderWorkItem=function(n,t){var i=$("<a>");w.renderWorkItemTypeIcon(i[0],n.workItemType,n.colorAndIcon,w.IconlessMode.ColorBar,{suppressTooltip:!0});var r=$("<span>").addClass("mention-widget-workitem-typeid").text(k.getWorkItemTypeWithIdString(n))[0].outerHTML,u=$("<span>").addClass("mention-widget-workitem-title").text(n.title)[0].outerHTML,f=k.getWorkItemSummary(r,u);return i.addClass(et.MENTION_WIDGET_WORKITEM).addClass("mention-link").attr("href",t).append(f)},n.prototype.renderMention=function(n,t,u){var f=this;return d.getInstance().getById(n.ArtifactId).then(function(r){var o;if(r===null)return o=$("<span>").text(n.Text)[0].outerHTML,t(o),i.reject(o);var h=e.getMainTfsContext(),c=h.getPermalinkUrl("edit","workitems",{parameters:n.ArtifactId,collectionId:h.navigation.collection.instanceId}),a=f._renderWorkItem(r,c),l=t(a);return l.click(function(){s.EventLogging.publishWorkItemsClickEvent({workItem:JSON.stringify(r)});var n=function(){ut.showWorkItem(r.id)};if(u&&u.onWorkItemClick)u.onWorkItemClick(r,c,n);else n();return!1}),l})},n.prototype.getTelemetryMentionSummary=function(n){return this.getArtifactType()+":"+n.ArtifactId},n}();t.WorkItemMentionsRenderingProvider=g;st=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.renderMention=function(n,t){return d.getInstance().getById(n.ArtifactId).then(function(r){var u,f,e,o;return r===null?(u=$("<span>").text(n.Text)[0].outerHTML,f=t(u),i.reject(f)):(e=ft(r),o=t(e),o)})},t}(g);t.WorkItemHtmlMentionsRenderingProvider=st;k=function(){function n(){}return n.getWorkItemTypeWithIdString=function(n){return l.format(rt.EDITOR_CAPTION,n.workItemType,n.id)},n.getWorkItemSummary=function(n,t){return l.format(rt.EDITOR_WINDOW_TITLE,n,t)},n}();d=function(){function n(t){var u=(new Date).getTime(),i,r;this._client=o.getClient(y.WorkItemTrackingHttpClient,e.getMainTfsContext().contextData);i=$.Deferred();r=$.Deferred();$.when(i,r).done(function(n,t){s.EventLogging.publishWorkItemsInitializeEvent({getMyAssignedWorkItemsDurationInMsec:(n-u).toString(),getWorkItemColorsProviderDurationInMsec:(t-u).toString()})});this._wiql=t!=null&&t.wiql!=null?t.wiql:n.DEFAULT_WIQL;this._myWorkItems=this.getMyWorkItems();this._myWorkItems.then(function(){i.resolve((new Date).getTime())});tt.getInstance()._witColorAndIconsProviderPromise.then(function(){r.resolve((new Date).getTime())})}return n.getInstance=function(){return n._instance||(n._instance=new n),n._instance},n.prototype.getArtifactType=function(){return"WorkItem"},n.prototype.getById=function(n){var i=parseInt(n),t=this.getWorkItemPromises([i]);if(t.length===1)return t[0];throw new Error("Expected GetWorkItemsByIds to return 1 promise.");},n.prototype.searchById=function(n){var t=$.Deferred(),r=parseInt(n),u=[],f=[],e=function(n,t){c.contains(f,n.id)||(f.push(n.id),u.push({original:n,highlighted:t}))},o=function(t){var i;t!==null&&(isNaN(r)?(i={id:t.id,colorAndIcon:t.colorAndIcon,workItemType:t.workItemType,title:l.htmlEncode(t.title)},e(t,i)):(i=nt.searchHighlightedWorkItem(n,t),i!==t&&e(t,i)))},s=this.getWorkItems([r]);return i.all([s,this._myWorkItems]).then(function(n){n.forEach(function(n){n.forEach(function(n){o(n)})});t.resolve(u)},function(){t.reject.apply(t,arguments)}),t.promise()},n.prototype.search=function(n){var t=$.Deferred();return this._myWorkItems.then(function(i){var r=[];i.forEach(function(t){var i=nt.searchHighlightedWorkItem(n,t);i!==t&&r.push({original:t,highlighted:i})});t.resolve(r)},function(){t.reject.apply(t,arguments)}),t.promise()},n.isValidWorkItemId=function(n){return n>=1&&n<=2147483647},n.prototype.getMyWorkItems=function(){return this._getWiqlResults(this._wiql,50)},n.prototype.getWorkItems=function(n){if(n.length===0)throw new Error("ids must contain elements.");return i.all(this.getWorkItemPromises(n))},n.prototype.getWorkItemPromises=function(t){return t.map(function(t){return n.isValidWorkItemId(t)?tt.getInstance().cache.getArtifactPromise(t):i(null)})},n.prototype._getWiqlResults=function(n,t){var u=this,r=i.defer(),f="SELECT ["+v.CoreFieldRefNames.Id+"] FROM WorkItems WHERE "+n;return this._client.queryByWiql({query:f},undefined,undefined,undefined,t).then(function(n){var t=$.map(n.workItems,function(n){return n.id});t.length===0?r.resolve([]):u.getWorkItems(t).then(function(n){r.resolve(n)},function(){r.reject.apply(r,arguments)})},function(n){r.reject(n)}),r.promise},n.QUEUE_WAIT_MSEC=10,n.MAX_BATCH_SIZE=50,n.DEFAULT_WIQL="(["+v.CoreFieldRefNames.AuthorizedAs+"] = @me\n                        AND ["+v.CoreFieldRefNames.AuthorizedDate+"] >= @today - 30)\n                    OR (["+v.CoreFieldRefNames.CreatedBy+"] = @me\n                        AND ["+v.CoreFieldRefNames.CreatedDate+"] >= @today - 30)\n                    OR (["+v.CoreFieldRefNames.AssignedTo+"] = @me\n                        AND ["+v.CoreFieldRefNames.AuthorizedDate+"] >= @today - 30)\n                    ORDER BY ["+v.CoreFieldRefNames.AuthorizedDate+"] DESC",n}();t.WorkItemProvider=d;tt=function(){function n(){var t=this,n;this.cache=new u.ArtifactsCache(function(n){return t._loadWorkItems(n)},d.QUEUE_WAIT_MSEC,d.MAX_BATCH_SIZE);this._client=o.getClient(y.WorkItemTrackingHttpClient,e.getMainTfsContext().contextData);n=this._getProjectName();this._witColorAndIconsProviderPromise=n?p.WorkItemTypeColorAndIconsProvider.getInstance().queueEnsureColorAndIconsArePopulated(n):i(null)}return n.getInstance=function(){return n._instance||(n._instance=new n),n._instance},n.prototype._loadWorkItems=function(n){var f=[v.CoreFieldRefNames.Id,v.CoreFieldRefNames.WorkItemType,v.CoreFieldRefNames.Title,v.CoreFieldRefNames.TeamProject],t={},u={};return n.forEach(function(n){t[n]=i.defer();u[n]=t[n].promise}),this._client.getWorkItems(n,f).then(function(u){var f=[],e=u.map(function(n){var r=n.fields,u=r[v.CoreFieldRefNames.WorkItemType],e=r[v.CoreFieldRefNames.TeamProject],i={id:r[v.CoreFieldRefNames.Id],workItemType:u,title:r[v.CoreFieldRefNames.Title],colorAndIcon:p.WorkItemTypeColorAndIcons.getDefault()};return f.push(i.id),p.WorkItemTypeColorAndIconsProvider.getInstance().getColorAndIconAsync(e,u).then(function(n){i.colorAndIcon=n;t[i.id].resolve(i)},function(n){t[i.id].resolve(i);b.publishErrorToTelemetry(n)})});return i.allSettled(e).then(function(){n.forEach(function(n){if(f.indexOf(n)===-1){var i="WorkItem #"+n+" not returned from server.";r.logWarning(i);t[n].resolve(null)}})})},function(i){a.handleError(i);n.forEach(function(n){t[n].reject(i)})}),u},n.prototype._getProjectName=function(){return e.getMainTfsContext().navigation.project||l.empty},n}();t.WorkItemProviderCache=tt;it=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.getDefault=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.parseFromText=function(n){for(var r=[],f=new RegExp("("+u.Constants.PATTERN_WORD_START_SEPARATOR+")#([0-9]{1,10})(?=("+u.Constants.PATTERN_WORD_END_SEPARATOR+"))","ig"),t;t=f.exec(n);){var e=t.index,o=f.lastIndex,i=t[1];i&&i.length&&(e+=i.length);r.push({start:e,end:o,id:t[2]})}return r},t.prototype.parseFromUrl=function(n){for(var u=new h(n),t=u.segment(),r,i;t.shift()!=="_permalink";)if(!t.length)return;return r=t.shift(),i=+t.pop(),r==="_workitems"&&i>0?{workItemId:i}:void 0},t.prototype.parseFromHtml=function(n,t){var i=this,r=n.find('a[href*="/_permalink/_workitems/edit/"]['+u.Constants.HTML_MENTION_ATTR_NAME+'^="version"]');r.each(function(n,r){var u=$(r),f=i.parseFromUrl(u.attr("href"));f&&t(u,f)})},t.prototype.getArtifactType=function(){return"WorkItem"},t}(u.ArtifactMentionParser);t.WorkItemsMentionParser=it;ht=function(){function n(){}return n.processHtml=function(n,t){it.getDefault().parseFromHtml(n,function(n,i){var r={ArtifactId:i.workItemId.toString(),ArtifactType:"",Text:"",Type:u.TextPartType.Mention};g.getDefault().renderMention(r,function(n){return $("<span>").append(n)},t).then(function(t){n.replaceWith(t)})})},n}();t.WorkItemMentionProcessor=ht;u.MentionsRenderer.getDefault().registerProvider(g.getDefault);u.MentionProcessor.getDefault().registerParser(it.getDefault),function(n){function t(n){try{if(e.hasParentWindow()&&window.parent.TfsMentionWorkItemHelpers){var t=window.parent.TfsMentionWorkItemHelpers;t.showWorkItem(n);return}}catch(i){}a.requireModules(["WorkItemTracking/SharedScripts/WorkItemDialogShim"]).spread(function(t){t.showWorkItemById(n)})}n.showWorkItem=t}(ut=t.TfsMentionWorkItemHelpers||(t.TfsMentionWorkItemHelpers={}));t.createWorkItemHtmlMention=ft;window.TfsMentionWorkItemHelpers=ut});
define("Mention/Scripts/TFS.Mention.Controls.Picker",["require","exports","VSS/Utils/UI","Mention/Scripts/TFS.Mention.Autocomplete","Mention/Scripts/TFS.Mention.Autocomplete.Controls","Mention/Scripts/TFS.Mention.WorkItems"],function(n,t,i,r,u,f){Object.defineProperty(t,"__esModule",{value:!0});var e=function(n){function t(t,i){var u=this;return t=t||{},t.mentionType!==r.MentionType.WorkItem||t.pluginConfigs||(t.pluginConfigs=[{factory:function(n){return new f.WorkItemAutocompleteProvider(n)}}]),n.call(this,t,i)||this}return __extends(t,n),t.prototype.initialize=function(){var t=this,r,u;if(n.prototype.initialize.call(this),r=this.getElement(),r){u=this._options.dropDown||this.getElement().parent().children(".bowtie-triangle-down");r.on("mouseenter",function(){t.prefetch()});r.bind("keydown",function(n){if(n.altKey&&!n.shiftKey&&!n.ctrlKey){var u=n.keyCode?n.keyCode:n.which,f=t._createInputText(n,r.val());u===i.KeyCode.DOWN?t._autocompleteManager.handleEvent(n,f):u===i.KeyCode.UP&&t._autocompleteManager.close(n,f)}});r.on("click",function(n){var i=t._createInputText(n,r.val());t._autocompleteManager.handleEvent(n,i)});u.on("click",function(n){var i=t._createInputText(n,r.val());t._autocompleteManager.isActive()?t._autocompleteManager.close(n,i):t._autocompleteManager.handleEvent(n,i)});u.on("blur",function(n){var i=t._createInputText(n,r.val());t._autocompleteManager.close(n,i)})}},t.prototype._sessionSelect=function(n){this._options.select&&this._options.select(n)},t.prototype._sessionFocus=function(){},t.prototype._createInputText=function(n,t){var r=this,i={textBeforeSelection:this._filterSearchString(t),textInSelection:"",textAfterSelection:""};return this.isActive()?i:(setTimeout(function(){r._autocompleteManager.handleEvent(n,i)},0),{textBeforeSelection:"#",textInSelection:"",textAfterSelection:""})},t.prototype._filterSearchString=function(n){return"#"+n.trim().replace(/\#/g," ").replace(/\s{2,}/g," ")},t}(u.AutocompleteEnhancement);t.MentionPickerEnhancement=e});
define("VersionControl/Scripts/Controls/AddRelatedWorkItemsControl",["require","exports","VSS/Controls","VersionControl/Scripts/CustomerIntelligenceConstants","VersionControl/Scripts/Resources/TFS.Resources.VersionControl","Mention/Scripts/TFS.Mention.Controls.Picker","Mention/Scripts/TFS.Mention.Autocomplete","VSS/Telemetry/Services"],function(n,t,i,r,u,f,e,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.initialize=function(){var t=this,l;n.prototype.initialize.call(this);var s=this,h=this._element,c=this._options.dropIconCss||"bowtie-triangle-down";this._$inputBox=$('<div class="vc-pullrequest-view-details-relatedartifacts-addartifactbox-container" />');this._$inputTextBox=$('<input type="text" class="vc-pullrequest-view-details-relatedartifacts-addartifactbox textbox-input" placeholder="'+u.PullRequest_RelatedArtifactsAddWatermark+'" aria-label="'+u.PullRequest_RelatedWorkItemsTitle+'" />').appendTo(this._$inputBox);this._$inputTextBox.attr("role","combobox").attr("aria-autocomplete","list").attr("aria-expanded","false");this._options.ariaLabelledBy&&this._$inputTextBox.attr("aria-labelledby",this._options.ariaLabelledBy);this._$dropIcon=$('<div role="button" aria-label="'+u.RelatedWorkItems_ChevronLabel+'" class="drop-icon bowtie-icon '+c+'"/>').appendTo(this._$inputBox);this._$inputTextBox!=null&&this._$inputTextBox.length>0&&(l=i.Enhancement.enhance(f.MentionPickerEnhancement,s._$inputTextBox,{mentionType:e.MentionType.WorkItem,dropDown:this._$dropIcon,open:function(){t._$inputTextBox.attr("aria-expanded","true")},close:function(){t._$inputTextBox.attr("aria-expanded","false")},select:function(n){var e=s._validateAndCreateWorkItemLink(n.getPlainText().textBeforeSelection),u,i,f;e&&(u=s._$inputTextBox.val(),i=u==="",i||s._$inputTextBox.select(),f=new o.TelemetryEventData(r.VERSION_CONTROL_AREA,r.RELATED_WORK_ITEMS_ADD,{contextId:t._options.contextId||"",hostArtifactId:t._options.hostArtifactId,hasTypedText:!i,typedTextIsANumber:!i&&!isNaN(u)}),o.publishEvent(f))}}));h.append($("<div><\/div>")).append(this._$inputBox)},t.prototype.showTextBox=function(n,t){n?(this._$inputBox.show(),t&&(this._$inputTextBox.click(),this._$inputTextBox.focus())):this._$inputBox.hide()},t.prototype._validateAndCreateWorkItemLink=function(n){if(n==null||n.length<=0)return!1;var t=+n;if(n[0]=="#"&&(t=+n.substr(1)),isNaN(t)||t%1!=0)return!1;if(this._options.checkWorkItemExists&&this._options.checkWorkItemExists(t))return!0;if(this._options.onWorkItemAdd)this._options.onWorkItemAdd(t);return!0},t}(i.BaseControl);t.AddRelatedWorkItemsControl=s});
define("Presentation/Scripts/TFS/TFS.React",["require","exports","react","VSS/Events/Services"],function(n,t,i,r){var u,f,e;Object.defineProperty(t,"__esModule",{value:!0});u=function(){function n(t){this._listeners=[];this._scope=t||n.DefaultScope}return n.prototype.invoke=function(t){if(n.Executing[this._scope])throw new Error("Cannot invoke an action from inside another action.");n.Executing[this._scope]=!0;try{this._listeners.forEach(function(n){n(t)})}finally{n.Executing[this._scope]=!1}},n.prototype.addListener=function(n,t){this._listeners.push(t?n.bind(t):n)},n.DefaultScope="Default",n.Executing={},n}();t.Action=u;f=function(){function n(n,t){this._changedEvent=n;this._eventManager=t&&t.eventManager?t.eventManager:r.getService()}return n.prototype.addChangedListener=function(n){this.addListener(this._changedEvent,n)},n.prototype.removeChangedListener=function(n){this.removeListener(this._changedEvent,n)},n.prototype.emitChanged=function(n){this.emit(this._changedEvent,this,n)},n.prototype.emit=function(n,t,i){this._eventManager.fire(n,t,i)},n.prototype.addListener=function(n,t){this._eventManager.attachEvent(n,t)},n.prototype.removeListener=function(n,t){this._eventManager.detachEvent(n,t)},n}();t.Store=f;e=function(n){function t(){return n.call(this)||this}return __extends(t,n),t.prototype.render=function(){var t=this,n={ref:function(n){return t.onRender(n)}};return this.props.containerCssClass&&(n.className=this.props.containerCssClass),i.createElement("div",n)},t.prototype.onRender=function(){},t}(i.Component);t.TfsComponent=e});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Interfaces",["require","exports"],function(n,t){Object.defineProperty(t,"__esModule",{value:!0});var i;(function(n){n[n.Done=0]="Done";n[n.InProgress=1]="InProgress"})(i=t.FetchingDisplayData||(t.FetchingDisplayData={}))});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/ArtifactSorting",["require","exports","VSS/Diag","VSS/Utils/String","VSS/Utils/Date","VSS/Utils/Number","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts"],function(n,t,i,r,u,f,e){var o;Object.defineProperty(t,"__esModule",{value:!0});o=function(){function n(){}return n.prototype.sortArtifactsInGroups=function(n,t){for(var u,i=0,r=n;i<r.length;i++)u=r[i],this._sort(u.linkedArtifacts,t)},n.prototype._sort=function(n,t){var i=new l,r,f,u;if(t&&t.length){for(r=0,f=t;r<f.length;r++)u=f[r],u.column.refName===e.InternalKnownColumns.Link.refName?i.push(new s(u.direction)):i.push(new h(u));i.push(new c)}else i.push(new s(e.SortDirection.Ascending));n.sort(i.getComparer())},n}();t.ArtifactSorter=o;var s=function(){function n(n){this._sortDirection=n}return n.prototype.compare=function(n,t){var i=this._compare(n,t);return i*this._sortDirection},n.prototype._compare=function(n,t){var o=this._handleUndefined(n,t),f,e;if(o!==null)return o;var i=n.primaryData,u=t.primaryData,s=this._handleUndefined(n.primaryData,t.primaryData);return s!==null?s:(f=r.localeComparer(i.typeName,u.typeName),f!==0)?f:i.user&&u.user&&(e=r.localeComparer(i.user.displayName,u.user.displayName),e!==0)?e:r.localeComparer(i.title,u.title)},n.prototype._handleUndefined=function(n,t){if(n||t)if(n){if(!t)return-1}else return 1;else return 0;return null},n}(),h=function(){function n(n){this._sortColumn=n}return n.prototype.compare=function(n,t){var i=this._compare(n,t);return i*this._sortColumn.direction},n.prototype._compare=function(n,t){var f=n.additionalData&&n.additionalData[this._sortColumn.column.refName],e=t.additionalData&&t.additionalData[this._sortColumn.column.refName],r,u,o;if(f||e)if(f){if(!e)return-1}else return 1;else return 0;return(r=f.rawData||f.styledText.text||"",u=e.rawData||e.styledText.text||"",typeof r!=typeof u)?-1:(o=this._getComparerForType(r),!o)?-1:o(r,u)},n.prototype._getComparerForType=function(n){return typeof n=="number"?f.defaultComparer:typeof n=="string"?r.localeComparer:n instanceof Date?u.defaultComparer:null},n}(),c=function(){function n(){}return n.prototype.compare=function(n,t){var u;if(n||t)if(n){if(!t)return-1}else return 1;else return 0;var o=n.primaryData&&n.primaryData.title||"",s=t.primaryData&&t.primaryData.title||"",f=r.localeComparer(o,s);if(f!==0)return f;var h=this._getDisplayId(n),c=this._getDisplayId(t),e=r.defaultComparer(h,c);return e!==0?e:(u=r.defaultComparer(this._getId(n),this._getId(t)),u!==0)?u:-1},n.prototype._getDisplayId=function(n){if(!n||!n.primaryData||!n.primaryData.displayId)return n.id;var t=n.primaryData.displayId;return typeof t=="string"?t:t.text||n.id},n.prototype._getId=function(n){return n.id||""},n}(),l=function(){function n(){this._comparers=[]}return n.prototype.push=function(n){this._comparers.push(n)},n.prototype.getComparer=function(){var n=this;return function(t,i){for(var e,f,r=0,u=n._comparers;r<u.length;r++)if(e=u[r],f=e.compare(t,i),f!==0)return f;return 0}},n}()});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/GroupSorting",["require","exports","VSS/Utils/String"],function(n,t,i){var r,u,f;Object.defineProperty(t,"__esModule",{value:!0});r=function(){function n(){}return n.prototype.sort=function(n,t){var i;i=n&&n.length?new f(n):new u;t.sort(i.getComparer())},n}();t.GroupSorter=r;u=function(){function n(){}return n.prototype.getComparer=function(){return function(n,t){return i.localeIgnoreCaseComparer(n.displayName,t.displayName)}},n}();f=function(){function n(n){var t=this;this._linkTypeRefNames=n;this._linkTypeRefNamesIndexMap={};n.forEach(function(n,i){return t._linkTypeRefNamesIndexMap[n]=i})}return n.prototype.getComparer=function(){var n=this;return function(t,r){var u=n._linkTypeRefNamesIndexMap[t.linkType],f=n._linkTypeRefNamesIndexMap[r.linkType],e=typeof u=="undefined",o=typeof f=="undefined";return e&&o?i.localeIgnoreCaseComparer(t.displayName,r.displayName):e?1:o?-1:u-f}},n}()});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Flux/Store",["require","exports","Presentation/Scripts/TFS/TFS.Core.Utils","Presentation/Scripts/TFS/TFS.React","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Interfaces","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/ArtifactSorting","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/GroupSorting"],function(n,t,i,r,u,f,e,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(n){function t(r,e,o,s,h,c,l,a,v){var y=n.call(this,i.GUIDUtils.newGuid()+"_CHANGED",a)||this;return y._linkedArtifactGroups=[],y._actionHub=r,y._actionHub.changeViewOptions.addListener(y._changeViewMode.bind(y)),y._actionHub.changeZeroDataOptions.addListener(y._changeZeroDataExperience.bind(y)),y._actionHub.changeFetchingLinks.addListener(y._changeFetchingLInks.bind(y)),y._actionHub.changeFetchingDisplayData.addListener(y._changeFetchingDisplayData.bind(y)),y._actionHub.changeReadOnly.addListener(y._setReadOnly.bind(y)),y._actionHub.setLinkedArtifacts.addListener(y._setLinkedArtifacts.bind(y)),y._actionHub.sortLinkedArtifacts.addListener(y._sortLinkedArtifacts.bind(y)),y._actionHub.showMessage.addListener(y._showMessage.bind(y)),y._linkTypeRefNames=e,y._sortColumns=o||t.DefaultSortColumns,y._fetchingDisplayData=u.FetchingDisplayData.Done,y._fetchingLinks=f.FetchingLinks.Done,y._displayOptions={readOnly:l?l:!1,showGroupHeaders:!s?!0:s.showGroupHeaders,viewMode:s&&s.viewMode||f.ViewMode.List,availableSpace:s&&s.availableSpace||{width:null,height:null},zeroDataOptions:{zeroDataExperienceViewMode:c?c.zeroDataExperienceViewMode:f.ZeroDataExperienceViewMode.Default,message:c&&c.message,action:c&&c.action,onRenderZeroData:c&&c.onRenderZeroData},gridViewOptions:h||{maxGridHeight:f.DefaultGridHeight,autoSizeGrid:!0},artifactPageSize:v||6},y}return __extends(t,n),t.prototype.getState=function(){return{displayOptions:{readOnly:this._displayOptions.readOnly,showGroupHeaders:this._displayOptions.showGroupHeaders,viewMode:this._displayOptions.viewMode,zeroDataOptions:{zeroDataExperienceViewMode:this._displayOptions.zeroDataOptions.zeroDataExperienceViewMode,action:this._displayOptions.zeroDataOptions.action,message:this._displayOptions.zeroDataOptions.message,onRenderZeroData:this._displayOptions.zeroDataOptions.onRenderZeroData},availableSpace:this._displayOptions.availableSpace,artifactPageSize:this._displayOptions.artifactPageSize,gridViewOptions:this._displayOptions.gridViewOptions},hostArtifact:this._hostArtifact,linkedArtifactGroups:this._linkedArtifactGroups,sortColumns:this._sortColumns,message:this._message,fetchingDisplayData:this._fetchingDisplayData,fetchingLinks:this._fetchingLinks}},t.prototype._changeViewMode=function(n){var t=!1;this._displayOptions.viewMode!==n.viewOptions.viewMode&&(this._displayOptions.viewMode=n.viewOptions.viewMode,t=!0);!n.viewOptions.availableSpace||this._displayOptions.availableSpace.height===n.viewOptions.availableSpace.height&&this._displayOptions.availableSpace.width===n.viewOptions.availableSpace.width||(this._displayOptions.availableSpace=n.viewOptions.availableSpace,t=!0);t&&this.emitChanged()},t.prototype._setReadOnly=function(n){this._displayOptions.readOnly=n.readOnly;this.emitChanged()},t.prototype._changeFetchingLInks=function(n){this._fetchingLinks=n.fetchingLinks;this.emitChanged()},t.prototype._changeFetchingDisplayData=function(n){this._fetchingDisplayData=n.fetchingDisplayData;this.emitChanged()},t.prototype._changeZeroDataExperience=function(n){this._displayOptions.zeroDataOptions=n.zeroDataOptions;this.emitChanged()},t.prototype._setLinkedArtifacts=function(n){this._linkedArtifactGroups=n.groupedLinkedArtifacts;this._hostArtifact=n.hostArtifact;this._sort();this.emitChanged()},t.prototype._sortLinkedArtifacts=function(n){this._sortColumns=n.sortColumns;this._sort();this.emitChanged()},t.prototype._sort=function(){this._sortArtifacts();this._sortGroups()},t.prototype._sortArtifacts=function(){var n=new e.ArtifactSorter;n.sortArtifactsInGroups(this._linkedArtifactGroups,this._sortColumns)},t.prototype._sortGroups=function(){var n=new o.GroupSorter;n.sort(this._linkTypeRefNames,this._linkedArtifactGroups)},t.prototype._showMessage=function(n){this._message=n.message;this.emitChanged()},t.DefaultSortColumns=[{column:f.InternalKnownColumns.Link,direction:f.SortDirection.Ascending}],t}(r.Store);t.LinkedArtifactsStore=s});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Flux/Actions",["require","exports","Presentation/Scripts/TFS/TFS.Core.Utils","Presentation/Scripts/TFS/TFS.React"],function(n,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function n(){this._scope="LinkedArtifacts_"+i.GUIDUtils.newGuid();this.changeViewOptions=this._createAction();this.changeReadOnly=this._createAction();this.setLinkedArtifacts=this._createAction();this.removeLinkedArtifact=this._createAction();this.changeLinkedArtifactComment=this._createAction();this.sortLinkedArtifacts=this._createAction();this.showMessage=this._createAction();this.changeZeroDataOptions=this._createAction();this.changeFetchingLinks=this._createAction();this.changeFetchingDisplayData=this._createAction()}return n.prototype._createAction=function(){return new r.Action(this._scope)},n}();t.ActionsHub=u});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/DataProvider/RequestCache",["require","exports","q","VSS/Utils/Array","VSS/Utils/String"],function(n,t,i,r,u){var o;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.Queued=0]="Queued";n[n.Active=1]="Active"}(o=t.CacheRequestStatus||(t.CacheRequestStatus={}));var f=function(n){return n.tool+"/"+n.type+"/"+n.id},e=function(n,t){if(n||t)if(n){if(!t)return 1}else return-1;else return 0;var i=u.ignoreCaseComparer(f(n),f(t));return i!==0?i:u.ignoreCaseComparer(n.linkType,t.linkType)},s=function(n,t){return n&&t&&u.ignoreCaseComparer(n.refName,t.refName)},h=function(){function n(n){this._cache={};this._queuedRequests=[];this._delay=n}return n.prototype.getArtifacts=function(t,u,o){for(var l=t.slice(0),a=[],p=[],v=[],s=null,h,y,w,c;l.length>0;){if(h=l.shift(),y=this._cache[f(h)],y){if(c=n._findOrExtendRequest(h,u,y),c){v.push(c.result);w=r.intersect([h].concat(l),c.linkedArtifacts,e);l=r.subtract(l,w,e);continue}}else if(s||this._queuedRequests.length>0){s=s||this._queuedRequests[0];n._extendRequest(h,u,s);p.push(h);continue}a.push(h)}return s&&(v.push(s.result),this._addToCache(p,s)),a.length>0&&(c=this._createNewRequest(a,u,o),v.push(c.result),this._addToCache(a,c)),i.all(v).then(function(n){return r.unique([].concat.apply([],n).filter(function(n){return r.contains(t,n,e)}),e)})},n.prototype._addToCache=function(n,t){for(var u=0,e=n;u<e.length;u++){var s=e[u],o=f(s),i=this._cache[o];i||(i=[],this._cache[o]=i);i.length!==0&&r.contains(i,t)||i.push(t)}},n.prototype._createNewRequest=function(n,t,u){var s=this,e={linkedArtifacts:n.slice(0),columns:t,status:o.Queued,result:i.delay(this._delay).then(function(){return e.status=o.Active,r.remove(s._queuedRequests,e),u(e.linkedArtifacts,e.columns).then(function(n){for(var r,t=0,i=e.linkedArtifacts;t<i.length;t++)r=i[t],delete s._cache[f(r)];return n})})};return this._queuedRequests.push(e),e},n._extendRequest=function(n,t,i){r.contains(i.linkedArtifacts,n,e)||i.linkedArtifacts.push(n);i.columns=r.union(i.columns,t,s)},n._requestContainsRequestedColumns=function(n,t){return r.intersect(n,t.columns,s).length===n.length},n._findOrExtendRequest=function(t,i,r){for(var e,h,u,f=0,s=r;f<s.length;f++)if(u=s[f],n._requestContainsRequestedColumns(i,u))return u;for(e=0,h=r;e<h.length;e++)if(u=h[e],u.status===o.Queued)return n._extendRequest(t,i,u),u;return null},n._getArtifactIdsForRequest=function(n){return n.linkedArtifacts.map(function(n){return f(n)})},n}();t.RequestCache=h});
define("TFS/WorkItemTracking/ExtensionContracts",["require","exports"],function(n,t){Object.defineProperty(t,"__esModule",{value:!0});var i;(function(n){n[n.icon=0]="icon";n[n.colorBar=1]="colorBar";n[n.colorCircle=2]="colorCircle";n[n.identity=3]="identity"})(i=t.ArtifactIconType||(t.ArtifactIconType={}));t.KnownColumns={State:"State",LastUpdate:"LastUpdate"}});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/DataProvider/ContributedDataProviderAdapter",["require","exports","VSS/Service","VSS/Context","VSS/Utils/String","VSS/Contributions/Controls","VSS/Contributions/Services","VSS/Diag","VSS/Error","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","TFS/WorkItemTracking/ExtensionContracts","Presentation/Scripts/TFS/TFS.Core.Utils"],function(n,t,i,r,u,f,e,o,s,h,c,l){function y(n){return p(n).then(function(n){return f.getBackgroundHost(n)}).then(function(n){return n.getRegisteredInstance("ArtifactLinkProvider",r.getDefaultWebContext())}).then(function(t){return new a(n,t)})}function p(n){return i.getService(e.ExtensionService).getContributionsForTargets([v]).then(function(t){var i=t.filter(function(t){return u.ignoreCaseComparer(n,t.properties.toolId)==0}),r;if(i.length===0){r=new Error("No contribution found which supports tool: '"+n+"'");s.publishErrorToTelemetry(r);throw r;}return i.length>1&&s.publishErrorToTelemetry(new Error("Multiple contributions registered for tool "+n+". Taking the first one and ignoring others.")),i[0]})}var v,a;Object.defineProperty(t,"__esModule",{value:!0});v="ms.vss-work-web.workitem-artifact-links";t.getContributedLinkedArtifactDataProvider=y;a=function(){function n(n,t){this.supportedTool=n;this._artifactLinkProvider=t}return n.prototype.beginGetDisplayData=function(n){var t=this;return this._artifactLinkProvider.getDisplayData(l.makeCopy(n)).then(function(i){for(var u,f={},r=0,e=n;r<e.length;r++)u=e[r],f[u.id]=u;return i.map(function(n){try{t._verifyDataReturnedByExtension(n,f[n.id])}catch(i){n.error=i}return t._toInternalDisplayData(n)})},function(t){return s.publishErrorToTelemetry(t),n.map(function(){return t})})},n.prototype._verifyDataReturnedByExtension=function(n,t){if(u.ignoreCaseComparer(n.linkType,t.linkType)!=0||u.ignoreCaseComparer(n.tool,t.tool)!=0||u.ignoreCaseComparer(n.type,t.type)!=0||u.ignoreCaseComparer(n.id,t.id)!=0){var i=new Error("Read-only fields in LinkedArtifact id ${originalLinkedArtifact.id} changed by extension.");s.publishErrorToTelemetry(i);throw i;}},n.prototype._toInternalDisplayData=function(n){return{uri:n.uri,tool:n.tool,type:n.type,id:n.id,linkType:n.linkType,linkTypeDisplayName:n.linkTypeDisplayName,comment:n.comment,primaryData:this._toInternalLinkedArtifactPrimaryData(n.primaryData,n),additionalData:this._toInternalAdditionalDataDictionary(n.additionalData),error:n.error}},n.prototype._toInternalLinkedArtifactPrimaryData=function(n,t){return{typeIcon:n.typeIcon,displayId:n.displayId,title:n.title,href:n.href,typeName:t.linkTypeDisplayName,callback:null,miscData:null}},n.prototype._toInternalAdditionalDataDictionary=function(n){var t={};return!n[c.KnownColumns.State]||(t[h.InternalKnownColumns.State.refName]=n[c.KnownColumns.State]),!n[c.KnownColumns.LastUpdate]||(t[h.InternalKnownColumns.LastUpdate.refName]=n[c.KnownColumns.LastUpdate]),t},n}();t.ContributedDataProviderAdapter=a});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/DataProvider/DataProvider.Registration",["require","exports","q","VSS/VSS","VSS/Artifacts/Constants","Presentation/Scripts/TFS/Controls/LinkedArtifacts/DataProvider/ContributedDataProviderAdapter","VSS/FeatureAvailability/Services","Presentation/Scripts/TFS/Generated/TFS.Server.WebAccess.Constants"],function(n,t,i,r,u,f,e,o){function l(n){n=n.toLowerCase();var r=h[n];return!r?e.FeatureAvailabilityService.isFeatureEnabled(o.FeatureAvailabilityFlags.WebAccessWorkItemTrackingAllowContributedExternalLinks)?f.getContributedLinkedArtifactDataProvider(n).then(function(n){return n},function(){return i.reject({message:"No linked artifacts provider registered for tool '"+n+"'.",type:t.ERROR_NODATAPROVIDERREGISTERED_TYPE})}):i.reject({message:"No linked artifacts provider registered for tool '"+n+"'.",type:t.ERROR_NODATAPROVIDERREGISTERED_TYPE}):r.instancePromise?r.instancePromise:a(r,n)}function a(n,t){var u=i.defer();return r.using(n.requiredModules,function(n){try{u.resolve(new n.default)}catch(t){u.reject(t)}},function(n){u.reject(n)}),n.instancePromise=u.promise.timeout(c,"Could not resolve linked artifacts for tool '"+t+"' provider within "+c+"ms"),n.instancePromise.then(function(n){return n},function(){n.instancePromise=null})}function v(n){return!!h[n.toLowerCase()]}var h,c,s;Object.defineProperty(t,"__esModule",{value:!0});h=(s={},s[u.ToolNames.WorkItemTracking.toLowerCase()]={requiredModules:["WorkItemTracking/Scripts/DataProviders/LinkedWorkItemDataProvider"]},s[u.ToolNames.TeamBuild.toLowerCase()]={requiredModules:["Build.Common/Scripts/DataProvider/LinkedArtifactsDataProvider"]},s[u.ToolNames.Git.toLowerCase()]={requiredModules:["VersionControl/Scripts/DataProviders/GitDataProvider"]},s[u.ToolNames.VersionControl.toLowerCase()]={requiredModules:["VersionControl/Scripts/DataProviders/VersionControlDataProvider"]},s[u.ToolNames.Requirements.toLowerCase()]={requiredModules:["Requirements/Scripts/DataProviders/ExternalLinkDataProvider"]},s[u.ToolNames.Hyperlink.toLowerCase()]={requiredModules:["Requirements/Scripts/DataProviders/ExternalLinkDataProvider"]},s[u.ToolNames.TestManagement.toLowerCase()]={requiredModules:["TestManagement/Scripts/DataProviders/TestManagementDataProvider"]},s[u.ToolNames.Wiki.toLowerCase()]={requiredModules:["Wiki/Scripts/LinkedArtifactsDataProvider"]},s);c=3e4;t.ERROR_NODATAPROVIDERREGISTERED_TYPE="NoDataProviderRegisteredError";t.getLinkedArtifactProvider=l;t.inBuiltDataProviderExistsForTool=v});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/ArtifactResolver",["require","exports","q","VSS/Utils/Array","VSS/Utils/String","VSS/Error","VSS/Controls/Notifications","Presentation/Scripts/TFS/Controls/LinkedArtifacts/DataProvider/RequestCache","Presentation/Scripts/TFS/Controls/LinkedArtifacts/DataProvider/DataProvider.Registration","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","VSS/FeatureAvailability/Services","Presentation/Scripts/TFS/Generated/TFS.Server.WebAccess.Constants","Presentation/Scripts/TFS/Resources/TFS.Resources.Presentation","VSS/Utils/Accessibility"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){Object.defineProperty(t,"__esModule",{value:!0});var y=4,p=function(){function n(){this._requestCaches={}}return n.getInstance=function(){return n._instance||(n._instance=new n),n._instance},n.invalidateArtifactCacheEntry=function(t,i,r){t.invalidate(n._getWriteArtifactCacheKey(i,r))},n.prototype.resolveArtifacts=function(t,o,h,v,y,p){var w=this,tt=t.slice(0),b=[],d=this._groupLinkedArtifactsByTool(tt),g=Object.keys(d),nt,k;return c.FeatureAvailabilityService.isFeatureEnabled(l.FeatureAvailabilityFlags.WebAccessWorkItemTrackingAllowContributedExternalLinks)||(g=g.filter(s.inBuiltDataProviderExistsForTool)),nt=g.map(function(t){return w._getDataProvider(t).then(function(f){var s=d[t],c,l,k,g,nt;return(f.artifactLimit&&s.length>=f.artifactLimit&&(s=n._getLimitedNumberOfArtifacts(f.artifactLimit,s),b.push({type:e.MessageAreaType.Warning,text:a.LinkedArtifacts_TooManyLinks})),c=y&&y(t),l=[],p&&(k=[],l=s.map(function(n){var t=w._getArtifactFromCache(p,n,o);return t&&c&&(!f.filter||!f.filter(t,c,h))?(k.push(n),null):t}).filter(function(n){return!!n}),g=function(n,t){return u.equals(n.uri,t.uri,!0)&&u.equals(n.linkType,t.linkType,!0)?0:1},s=r.subtract(s,l,g),s=r.subtract(s,k,g)),s.length===0)?i(l):(nt=w._getRequestCacheForTool(t),nt.getArtifacts(s,o,w._retrieveItemsFromDataProvider.bind(w,f,v,c,h)).then(function(t){for(var r,i=0,u=t;i<u.length;i++)r=u[i],w._ensureCommentDataForArtifact(r),p&&p.set(n._getWriteArtifactCacheKey(r,o),r);return c&&f.filter&&(t=t.filter(function(n){return f.filter(n,c,h)})),t.concat(l)}))},function(n){return n.type===s.ERROR_NODATAPROVIDERREGISTERED_TYPE?(b.push({type:e.MessageAreaType.Error,text:u.format(a.LinkedArtifacts_DataProvider_NotRegistered,t)}),d[t].map(function(n){return w._defaultDisplayFromLinkedArtifact(n)})):(b.push({type:e.MessageAreaType.Error,text:a.LinkedArtifacts_DataProvider_CouldNotBeResolved}),n.name="DataProviderNotResolvedError",f.publishErrorToTelemetry(n),[])})}),k=[],i.allSettled(nt).then(function(n){for(var i,u,t=0,r=n;t<r.length;t++)i=r[t],i.state==="fulfilled"?(u=i.value,k=k.concat(u)):b.push({type:e.MessageAreaType.Error,text:i.reason});return{resolvedArtifacts:k,messages:b}})},n.prototype._retrieveItemsFromDataProvider=function(n,t,i,r,u,f){var o=this,e=n.beginGetDisplayData(u,f,t,r).then(function(t){return i||o._reportErrorsForUnresolvedArtifacts(n.supportedTool,u,t),t});return v.ProgressAnnouncer.forPromise(e,{announceStartMessage:a.LinkedArtifacts_LoadingStart,announceEndMessage:a.LinkedArtifacts_LoadingEnd,announceErrorMessage:a.LinkedArtifacts_LoadingError}),e},n.prototype._defaultDisplayFromLinkedArtifact=function(n){return{id:n.id,linkType:n.linkType,linkTypeDisplayName:n.linkTypeDisplayName,primaryData:{displayId:n.id,href:null,title:n.uri,typeIcon:null},tool:n.tool,type:n.type}},n.prototype._ensureCommentDataForArtifact=function(n){n.comment&&(n.additionalData||(n.additionalData={}),n.additionalData[h.InternalKnownColumns.Comment.refName]||(n.additionalData[h.InternalKnownColumns.Comment.refName]={styledText:{text:n.comment},title:n.comment}))},n.prototype._getDataProvider=function(n){return s.getLinkedArtifactProvider(n)},n.prototype._groupLinkedArtifactsByTool=function(n){for(var t,i={},r=0,u=n;r<u.length;r++)t=u[r],i[t.tool]=(i[t.tool]||[]).concat([t]);return i},n.prototype._getArtifactFromCache=function(t,i,r){var u=n._getArtifactCacheKey(i),f=t.get(u);return f?f:(u=n._getArtifactCacheKey(i,r),t.get(u))},n.prototype._getRequestCacheForTool=function(n){return this._requestCaches[n]||(this._requestCaches[n]=new o.RequestCache(y)),this._requestCaches[n]},n.prototype._reportErrorsForUnresolvedArtifacts=function(n,t,i){var c=r.subtract(t,i,function(n,t){return u.ignoreCaseComparer(n.uri,t.uri)}),o,l,e,s,h;if(c.length!==t.length)for(o=this._groupLinkedArtifactsByTool(c),l=Object.keys(o),e=0,s=l;e<s.length;e++)h=s[e],f.publishErrorToTelemetry({message:u.localeFormat("'{0}' dataprovider did not resolve following artifacts '{1}'",h,JSON.stringify(o[h])),name:"ToolDidNotResolveArtifacts"})},n._getLimitedNumberOfArtifacts=function(t,i){var s=n.groupLinkedArtifactsByLinkType(i),r,u,e,o,f;for(s.sort(function(n,t){return n.linkedArtifacts.length-t.linkedArtifacts.length}),r=[],u=0,e=s;u<e.length;u++){for(o=e[u],f=0;f<o.linkedArtifacts.length&&r.length<t;++f)r.push(o.linkedArtifacts[f]);if(r.length===t)break}return r},n.groupLinkedArtifactsByLinkType=function(n){for(var f={},e=[],i=0,o=n;i<o.length;i++){var r=o[i],u=r.linkType||"",t=f[u];t||(t={displayName:r.linkTypeDisplayName,linkType:u,linkedArtifacts:[]},f[u]=t,e.push(t));t.linkedArtifacts.push(r)}return e},n._getArtifactCacheKey=function(n,t){var i=(n.uri||n.id)+"-"+n.linkType,r;return t?(r=t.map(function(n){return n.refName}).join(),i+"-"+r):i},n._getWriteArtifactCacheKey=function(n,t){return n.isColumnDependent?this._getArtifactCacheKey(n,t):this._getArtifactCacheKey(n)},n}();t.ArtifactResolver=p});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Flux/ActionsCreator",["require","exports","VSS/Utils/Array","VSS/Utils/Core","VSS/Diag","VSS/Controls/Notifications","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Interfaces","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/ArtifactResolver"],function(n,t,i,r,u,f,e,o,s){Object.defineProperty(t,"__esModule",{value:!0});var h=function(){function n(n,t,i,r,u){this._tfsContext=n;this._actionsHub=t;this._filterHelper=r;this._columns=i;this._cache=u}return n.prototype.removeLinkedArtifact=function(n){this._actionsHub.removeLinkedArtifact.invoke({linkedArtifactToRemove:n})},n.prototype.changeLinkedArtifactComment=function(n,t){s.ArtifactResolver.invalidateArtifactCacheEntry(this._cache,n,this._columns);this._actionsHub.changeLinkedArtifactComment.invoke({linkedArtifactToChange:n,newComment:t})},n.prototype.changeViewOptions=function(n){this._actionsHub.changeViewOptions.invoke({viewOptions:n})},n.prototype.changeZeroDataOptions=function(n){this._actionsHub.changeZeroDataOptions.invoke({zeroDataOptions:n})},n.prototype.changeReadOnly=function(n){this._actionsHub.changeReadOnly.invoke({readOnly:n})},n.prototype.changeFetchingLinks=function(n){this._actionsHub.changeFetchingLinks.invoke({fetchingLinks:n})},n.prototype.setLinks=function(n,t){var i=this,u;if(this._retrievingLinks&&this._retrievingLinks.cancel(),this._retrievingLinks=new r.Cancelable(null),this._setStartFetchingDisplayData(),u=this._filterHelper.filter(n.slice(0)),u.length===0){this._groupAndSetArtifacts([],t);this.clearMessage();this._setEndFetchingData();return}s.ArtifactResolver.getInstance().resolveArtifacts(u,this._columns,t,this._tfsContext,function(n){return i._filterHelper.getSubtypeFilterForDataProvider(n)},this._cache).then(this._retrievingLinks.wrap(function(n){var u=n.resolvedArtifacts,r;i._groupAndSetArtifacts(u,t);n.messages&&n.messages.length>0?(r=n.messages.filter(function(n){return n.type===f.MessageAreaType.Error}),r.length>0?i.showMessage(r[0].text,r[0].type):i.showMessage(n.messages[0].text,n.messages[0].type)):i.clearMessage();i._setEndFetchingData()}))},n.prototype.sortLinkedArtifacts=function(n){var t=this,r=n.map(function(n){var r=i.first(t._columns,function(t){return t.refName===n.index});if(r)return{column:r,direction:n.order==="desc"?e.SortDirection.Descending:e.SortDirection.Ascending}}).filter(function(n){return!!n});this._actionsHub.sortLinkedArtifacts.invoke({sortColumns:r})},n.prototype.showMessage=function(n,t){t===void 0&&(t=f.MessageAreaType.Error);var i="";if(typeof n=="string")i=n;else if(typeof n=="object"&&n.message)i=n.message;else return;this._actionsHub.showMessage.invoke({message:{text:i,type:t}})},n.prototype.clearMessage=function(){this._actionsHub.showMessage.invoke({message:null})},n.prototype._groupAndSetArtifacts=function(n,t){var i=s.ArtifactResolver.groupLinkedArtifactsByLinkType(n);this._actionsHub.setLinkedArtifacts.invoke({groupedLinkedArtifacts:i,hostArtifact:t})},n.prototype._setStartFetchingDisplayData=function(){this._actionsHub.changeFetchingDisplayData.invoke({fetchingDisplayData:o.FetchingDisplayData.InProgress})},n.prototype._setEndFetchingData=function(){this._actionsHub.changeFetchingDisplayData.invoke({fetchingDisplayData:o.FetchingDisplayData.Done})},n}();t.ActionsCreator=h});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/Filtering",["require","exports","VSS/Utils/Array","VSS/Utils/String"],function(n,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function n(n,t){var i,r,u,f;if(this._linkTypeRefNames=n,t)for(this._filterConfiguration={},i=0,r=Object.keys(t);i<r.length;i++)u=r[i],f=t[u],this._filterConfiguration[u.toLowerCase()]=f}return n.prototype.filter=function(n){var t=this;return!this._linkTypeRefNames||this._linkTypeRefNames.length===0?n:n.filter(function(n){return i.contains(t._linkTypeRefNames,n.linkType,r.ignoreCaseComparer)})},n.prototype.getSubtypeFilterForDataProvider=function(n){var t=null;return n&&this._filterConfiguration&&(n=n.toLowerCase(),t=this._filterConfiguration[n]||null),t},n}();t.ArtifactFilterHelper=u});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/ComponentUtils",["require","exports","VSS/VSS","TFS/WorkItemTracking/ExtensionContracts"],function(n,t,i,r){var u,f;Object.defineProperty(t,"__esModule",{value:!0}),function(n){function t(n){var u=n.primaryData&&n.primaryData.displayId||n.id,f=n.linkTypeDisplayName||n.linkType||n.type,t;return n&&n.error&&(t=i.getErrorMessage(n.error)),{displayId:u,title:t,typeIcon:{type:r.ArtifactIconType.icon,descriptor:"bowtie-status-error la-error-icon",title:t},typeName:f,href:"#",callback:function(){return!0}}}n.getErrorPrimaryData=t}(u=t.ErrorUtils||(t.ErrorUtils={})),function(n){function t(n,t){var u,i,f,r;if(!n||!n.primaryData)return"";if(u="",n.additionalData)for(i=0,f=t;i<f.length;i++)r=f[i],n.additionalData[r.refName]&&(u+=r.name+":\t"+n.additionalData[r.refName].styledText.text+"\n");return u.trim()}n.getTooltip=t}(f=t.ComponentUtils||(t.ComponentUtils={}))});
var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__decorate=this&&this.__decorate||function(n,t,i,r){var f=arguments.length,u=f<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r,e,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(e=n[o])&&(u=(f<3?e(u):f>3?e(t,i,u):e(t,i))||u);return f>3&&u&&Object.defineProperty(t,i,u),u};define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/ArtifactRenderer",["require","exports","react","OfficeFabric/Utilities","VSS/Diag","VSS/Events/Action","VSS/Utils/Array","VSS/Utils/Core","VSS/Utils/String","Presentation/Scripts/TFS/TFS.OM.Identities","Presentation/Scripts/TFS/TFS.Host.TfsContext","VSS/Controls/PopupContent","OfficeFabric/Tooltip","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","TFS/WorkItemTracking/ExtensionContracts","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/ComponentUtils","VSS/Utils/UI","Presentation/Scripts/TFS/Resources/TFS.Resources.Presentation"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){var k,d,ft,g,it,nt,tt,rt,ut;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n.Component=function(n){var t=n.icon,r,f;if(t&&t.descriptor)switch(t.type){case y.ArtifactIconType.colorBar:return i.createElement(a.TooltipHost,{content:t.title},i.createElement("span",{className:"la-color-bar",style:{backgroundColor:t.descriptor}}));case y.ArtifactIconType.colorCircle:return i.createElement(a.TooltipHost,{content:t.title},i.createElement("span",{className:"la-color-circle",style:{backgroundColor:t.descriptor,borderColor:t.descriptor}}));case y.ArtifactIconType.icon:return r=null,typeof t.descriptor=="string"?r=i.createElement("span",{className:"bowtie-icon "+t.descriptor}):(f=t.descriptor,f&&(r=i.createElement("span",{className:"bowtie-icon "+f.icon,style:{color:f.color}}))),i.createElement(a.TooltipHost,{content:t.title},r)}return i.createElement("span",null)};n.GridComponent=function(n){var t=n.icon,i=document.createElement("span"),r;if(t&&t.descriptor)switch(t.type){case y.ArtifactIconType.colorBar:i.className="la-color-bar";i.style.backgroundColor=t.descriptor;break;case y.ArtifactIconType.colorCircle:i.className="la-color-circle";i.style.backgroundColor=t.descriptor;i.style.borderColor=t.descriptor;break;case y.ArtifactIconType.icon:typeof t.descriptor=="string"?i.className="bowtie-icon "+t.descriptor:(r=t.descriptor,r&&(i.className="bowtie-icon "+r.icon,i.style.color=r.color))}return i}}(k=t.ArtifactIcon||(t.ArtifactIcon={})),function(n){n.Component=function(n){var t=n.styledText,r,u;return t&&t.text?(r="la-text",u=t.className?r+" "+t.className:r,i.createElement("span",{className:u,style:{backgroundColor:t.className}},t.text)):i.createElement("span",null)};n.GridComponent=function(n){var t=n.styledText,i=document.createElement("span");return i.className="la-text"+(t.className?" "+t.className:""),i.innerText=t.text,i}}(d=t.ArtifactStyledText||(t.ArtifactStyledText={})),function(n){n.Component=function(n){var t=n.groupName;return n.count>1&&(t=t+"\u00a0("+n.count+")"),i.createElement("div",{className:"la-group-title"},t)};n.GridComponent=function(n){var i=document.createElement("span"),t;return i.className="la-group-title",t=n.groupName,n.count>1&&(t=t+"\u00a0("+n.count+")"),$(i).text(t),i}}(ft=t.ArtifactGroup||(t.ArtifactGroup={})),function(n){function t(n,t,i){var u=i.altKey||i.ctrlKey||i.metaKey||i.shiftKey||i.which===s||i.button===o,r;u||(r=!0,n.callback&&n.callback(n.miscData,t)&&(r=!1,i.preventDefault()),r&&(f.getService().performAction(f.CommonActions.ACTION_WINDOW_OPEN,{url:n.href,target:"_blank"}),i.preventDefault()))}function r(n){return n.user?{id:n.user.id,displayName:n.user.displayName,uniqueName:n.user.uniqueName}:null}function u(n,t){return n.id||n.uniqueName?h.IdentityHelper.getIdentityImageUrl(n,h.IdentityImageMode.ShowGenericImage,h.IdentityImageSize.Small):t.user&&t.user.email?c.TfsContext.getDefault().getIdentityImageUrl(null,{email:t.user.email}):h.IdentityHelper.getIdentityImageUrl(n,h.IdentityImageMode.ShowGenericImage,h.IdentityImageSize.Small)}function e(n){var t,i;return typeof n=="string"?t=i=n:n.text&&(t=n.text,i=n.title),{text:t,title:i}}function l(n){var i=document.createElement("div"),o,s,v,c,l,y,a,f;return i.className="la-primary-data",o=document.createElement("div"),o.className="la-primary-icon",o.appendChild(k.GridComponent({icon:n.primaryData.typeIcon})),i.appendChild(o),s=r(n.primaryData),s&&(v=u(s,n.primaryData),v&&(c=document.createElement("img"),c.src=v,c.alt=h.IdentityHelper.getUniquefiedIdentityName(s),l=document.createElement("div"),l.className="la-user-icon",l.appendChild(c),i.appendChild(l))),n.primaryData.displayId&&(y=e(n.primaryData.displayId),a=document.createElement("div"),a.className="la-primary-data-id",$(a).text(y.text),i.appendChild(a),i.appendChild(document.createTextNode("\u00a0"))),f=document.createElement("a"),f.href=n.primaryData.href,f.onclick=t.bind(null,n.primaryData,n.hostArtifact),f.tabIndex=-1,$(f).text(n.primaryData.title),i.appendChild(f),i}var o=1,s=2;n.openArtifact=t;n.Component=function(n){var c=function(){var t=r(n.primaryData);if(!t)return null;var f=u(t,n.primaryData),e=null,o=h.IdentityHelper.getUniquefiedIdentityName(t);return f&&(e=i.createElement("img",{alt:o,src:f})),i.createElement(a.TooltipHost,{content:o},i.createElement("div",{className:"la-user-icon"},e))},o=null,s,f;return n.primaryData.displayId&&n.primaryData.href&&n.primaryData.href!=="#"&&(s=e(n.primaryData.displayId),o=i.createElement("div",{className:"la-primary-data-id"},s.text,"\u00a0")),f=null,f=n.primaryData.href&&n.primaryData.href!=="#"?i.createElement("a",{href:n.primaryData.href,onClick:t.bind(null,n.primaryData,n.hostArtifact)},n.primaryData.title):i.createElement("span",null,n.primaryData.title),i.createElement("div",{className:"la-primary-data"},i.createElement("div",{className:"la-primary-icon"},i.createElement(k.Component,{icon:n.primaryData.typeIcon})),c(),o,i.createElement(a.TooltipHost,{content:n.primaryData.title,overflowMode:a.TooltipOverflowMode.Parent},f))};n.GridComponent=l}(g=t.PrimaryArtifact||(t.PrimaryArtifact={})),function(n){n.Component=function(n){var u,t,f,r;return(n.data.icon&&(u=i.createElement(k.Component,{icon:n.data.icon})),t=null,n.data.styledText&&(t=i.createElement(d.Component,{styledText:n.data.styledText})),f=s.equals(n.data.title,n.data.styledText.text)?a.TooltipOverflowMode.Parent:undefined,r=i.createElement("div",{className:"la-additional-data-item"},u,t),n.data.title)?i.createElement(a.TooltipHost,{content:n.data.title,overflowMode:f},r):r};n.GridComponent=function(n){var t=document.createElement("div"),i,r;return t.className="la-additional-data-item",i=k.GridComponent({icon:n.data.icon}),t.appendChild(i),r=d.GridComponent({styledText:n.data.styledText}),t.appendChild(r),n.data.title&&n.data.title!==n.data.styledText.text&&l.RichContentTooltip.add(n.data.title,t),t}}(it=t.AdditionalArtifact||(t.AdditionalArtifact={})),function(n){n.Component=function(n){return i.createElement("button",{className:"la-item-delete",onClick:n.onDelete,"aria-label":b.LinkedArtifacts_RemoveLink},i.createElement(a.TooltipHost,{content:b.LinkedArtifacts_RemoveLink},i.createElement("span",{className:"bowtie-icon bowtie-edit-delete"})))}}(nt=t.ArtifactDeleteButton||(t.ArtifactDeleteButton={}));tt=function(n){function t(t){var i=n.call(this,t)||this;return i.state={hasFocus:!1},i}return __extends(t,n),t.prototype.render=function(){var n=this,u=[v.InternalKnownColumns.LastUpdate.refName,v.InternalKnownColumns.State.refName],t=u.map(function(t){if(n.props.linkedArtifact.additionalData&&n.props.linkedArtifact.additionalData[t]&&n.props.columns.some(function(n){return n.refName===t}))return n._renderAdditional(t,n.props.linkedArtifact.additionalData[t])}).filter(function(n){return!!n}),f,o,r,h;return t=this._intersperse(t),this.props.displayOptions.readOnly||(f=i.createElement(nt.Component,{onDelete:this._onDelete})),this.props.linkedArtifact.action&&!this.props.displayOptions.readOnly&&(o=i.createElement(ut,{linkedArtifact:this.props.linkedArtifact,hostArtifact:this.props.hostArtifact})),r="la-item",this.state.hasFocus&&(r+=" la-item-focus"),h=this.props.columns.filter(function(n){return!e.contains(u,n.refName,s.ignoreCaseComparer)}),i.createElement("div",{className:r,onFocus:function(){return n._onFocus(!0)},onBlur:function(){return n._onFocus(!1)},onKeyDown:this._onKeyDown},i.createElement("div",{className:"la-item-wrapper"},i.createElement("div",{className:"la-artifact-data"},i.createElement(g.Component,{primaryData:this.props.linkedArtifact.primaryData,hostArtifact:this.props.hostArtifact}),i.createElement("div",{className:"la-additional-data"},t),o)),f)},t.prototype._renderAdditional=function(n,t){return i.createElement(it.Component,{key:n,data:t})},t.prototype._onDelete=function(n){this.props.actionsCreator.removeLinkedArtifact(this.props.linkedArtifact);n.preventDefault()},t.prototype._onFocus=function(n){var t=this;n?(this.setState({hasFocus:!0}),this._scheduledFocusChange&&(this._scheduledFocusChange.cancel(),this._scheduledFocusChange=null)):this._scheduledFocusChange=o.delay(this,0,function(){t.setState({hasFocus:!1})})},t.prototype._onKeyDown=function(n){switch(n.keyCode){case w.KeyCode.DELETE:this.props.actionsCreator.removeLinkedArtifact(this.props.linkedArtifact);n.preventDefault()}},t.prototype._intersperse=function(n){if(n.length===0)return[];var t=0;return n.slice(1).reduce(function(n,r){return n.concat([i.createElement("span",{key:t++},", \u00a0 "),r])},[n[0]])},__decorate([r.autobind],t.prototype,"_onDelete",null),__decorate([r.autobind],t.prototype,"_onKeyDown",null),t}(i.Component);t.ArtifactComponent=tt;rt=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var n=this.props.linkedArtifact,e=n.linkTypeDisplayName||n.linkType||n.type,t=p.ErrorUtils.getErrorPrimaryData(n),f=i.createElement(g.Component,{primaryData:t,hostArtifact:this.props.hostArtifact}),r=null,u;return t.href&&t.href!=="#"&&(r=[this._renderAdditional("System.Links.ErrorColumn",{styledText:{text:s.localeFormat(b.LinkedArtifacts_ItemError)},title:s.localeFormat(b.LinkedArtifacts_ItemError)})]),this.props.displayOptions.readOnly||(u=i.createElement(nt.Component,{onDelete:this._onDelete.bind(this)})),i.createElement("div",{className:"la-item"},i.createElement("div",{className:"la-item-wrapper"},i.createElement("div",{className:"la-artifact-data"},f,i.createElement("div",{className:"la-additional-data"},r))),u)},t}(tt);t.ArtifactErrorComponent=rt;ut=function(n){var r=function(){n.linkedArtifact.action.callback&&n.linkedArtifact.action.callback(n.linkedArtifact.miscData,n.hostArtifact)},t=n.linkedArtifact.action;return i.createElement("div",{className:"la-action"},i.createElement(a.TooltipHost,{content:t.title,overflowMode:a.TooltipOverflowMode.Parent},i.createElement("a",{href:t.href,onClick:r},t.styledText.text)))}});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/LinksListComponent",["require","exports","react","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/ArtifactRenderer","Presentation/Scripts/TFS/Resources/TFS.Resources.Presentation","VSS/Utils/String"],function(n,t,i,r,u,f){var e,o,s;Object.defineProperty(t,"__esModule",{value:!0});e=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.state={numberOfVisibleArtifacts:r.props.displayOptions.artifactPageSize},r}return __extends(t,n),t.prototype.render=function(){for(var v,e,w,b,n,c,l=t._getGroupRenderOptions(this.state.numberOfVisibleArtifacts,this.props.linkedArtifactGroups),k=this._renderGroups(l),y=null,r=[],o=0,h=0,a=0,p=Object.keys(l);a<p.length;a++)v=p[a],e=l[v],o+=e.visibleCount,h+=e.totalArtifacts,h>o&&(w=e.totalArtifacts-e.visibleCount,r.push(v+" ("+w+")"));if(h>o){if(b=f.format(u.RelatedArtifacts_RemainingCount,o,h),n="",r&&r.length>0){for(n=r[0],c=1;c<r.length;c++)n=f.format(u.RelatedArtifacts_SummaryDelimiter,n,r[c]);n=f.format(u.RelatedArtifacts_SummaryNotShown,n)}y=i.createElement(s,{itemsNotShownDescription:n,itemsShownDescription:b,showMore:this._showMore.bind(this)})}return i.createElement("div",{className:"la-list"},k,y)},t._getGroupRenderOptions=function(n,t){var i={},r=!n;return t.forEach(function(t){var u=t.linkedArtifacts.length;r||(u>n&&(u=n),n=n-u);i[t.displayName]={totalArtifacts:t.linkedArtifacts.length,visibleCount:u,group:t}}),i},t.prototype._renderGroups=function(n){var t=this;return this.props.linkedArtifactGroups.map(function(r){var u=n[r.displayName].visibleCount;return u===0?null:i.createElement(o,{key:r.displayName,hostArtifact:t.props.hostArtifact,actionsCreator:t.props.actionsCreator,displayOptions:t.props.displayOptions,displayName:r.displayName,linkedArtifacts:r.linkedArtifacts,columns:t.props.columns,visibleCount:u})}).filter(function(n){return!!n})},t.prototype._showMore=function(){var n=this;this.setState(function(t){return{numberOfVisibleArtifacts:t.numberOfVisibleArtifacts+n.props.displayOptions.artifactPageSize}})},t}(i.Component);t.LinksListComponent=e;o=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var n,t,u;return this.props.displayOptions.showGroupHeaders&&this.props.visibleCount>0&&(n=i.createElement(r.ArtifactGroup.Component,{groupName:this.props.displayName,count:this.props.linkedArtifacts.length})),t=this._renderLinks(),u=this.props.displayOptions.showGroupHeaders?"la-list-group-showheader":"la-list-group-noheader",i.createElement("div",{className:u},n,t)},t.prototype._renderLinks=function(){var n=this;return this.props.linkedArtifacts.slice(0,this.props.visibleCount).map(function(t){return t.error?i.createElement(r.ArtifactErrorComponent,{key:t.id+"-"+t.linkType,hostArtifact:n.props.hostArtifact,actionsCreator:n.props.actionsCreator,displayOptions:n.props.displayOptions,columns:n.props.columns,linkedArtifact:t}):i.createElement(r.ArtifactComponent,{key:t.id+"-"+t.linkType,hostArtifact:n.props.hostArtifact,actionsCreator:n.props.actionsCreator,displayOptions:n.props.displayOptions,columns:n.props.columns,linkedArtifact:t})})},t}(i.Component);s=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var n=this;return i.createElement("div",null,i.createElement("div",null,i.createElement("div",{className:"la-show-more-container"},i.createElement("div",{className:"la-show-more",onClick:function(){return n._callShowMore()}},u.RelatedArtifacts_ShowMore),i.createElement("div",{className:"la-shown-count"},this.props.itemsShownDescription))),i.createElement("div",{className:"la-not-shown-count"},this.props.itemsNotShownDescription))},t.prototype._callShowMore=function(){this.props.showMore()},t}(i.Component)});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/LoadingIndicatorComponent",["require","exports","react"],function(n,t,i){Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){function t(){var t=n.call(this)||this;return t.state={showLoadingIndicator:!1},t}return __extends(t,n),t.prototype.render=function(){return this.state.showLoadingIndicator?i.createElement("div",{className:"la-progress-spinner-container"},i.createElement("div",{className:"la-progress-spinner progress-spinner"})):(this._startTimer(),null)},t.prototype.componentWillUnmount=function(){this._mounted=!1;clearTimeout(this._timeoutHandle)},t.prototype.componentDidMount=function(){this._mounted=!0},t.prototype._startTimer=function(){var n=this;this._timeoutHandle=setTimeout(function(){n._mounted&&n.setState({showLoadingIndicator:!0})},750)},t}(i.Component);t.LoadingIndicatorComponent=r});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/ZeroDataComponent",["require","exports","react","Presentation/Scripts/TFS/Resources/TFS.Resources.Presentation"],function(n,t,i,r){Object.defineProperty(t,"__esModule",{value:!0});var u=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){var t=this.props.message||r.LinkedArtifacts_ZeroData,n;return this.props.action&&(n=i.createElement("div",{className:"la-zero-data-action"},i.createElement("button",{className:"la-action-button",onClick:this._onClickAction.bind(this)},this.props.action.actionMessage))),i.createElement("div",{className:"la-zero-data-container"},i.createElement("div",{className:"la-zero-data"},t),n)},t.prototype._onClickAction=function(n){return this.props.action&&this.props.action.actionCallback?this.props.action.actionCallback()?!0:(n.preventDefault(),!1):!0},t}(i.Component);t.ZeroDataComponent=u});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/MessageComponent",["require","exports","react","VSS/Diag","VSS/Controls/Notifications"],function(n,t,i,r,u){Object.defineProperty(t,"__esModule",{value:!0});var f=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){if(!this.props.message||!this.props.message.text)return null;return(typeof this.props.message.text=="string")?i.createElement("div",{className:"la-message"},i.createElement("span",{className:"la-message-icon icon bowtie-icon "+this._getIconClass()}),i.createElement("div",{className:"la-message-text"},this.props.message.text)):null},t.prototype._getIconClass=function(){switch(this.props.message.type){case u.MessageAreaType.Error:return"bowtie-status-error";case u.MessageAreaType.Warning:return"bowtie-status-warning";case u.MessageAreaType.Info:default:return"bowtie-status-info"}},t}(i.Component);t.MessageComponent=f});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/MainComponent",["require","exports","react","Presentation/Scripts/TFS/Resources/TFS.Resources.Presentation","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Interfaces","VSS/Flux/AsyncLoadedComponent","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/LinksListComponent","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/LoadingIndicatorComponent","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/ZeroDataComponent","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/MessageComponent"],function(n,t,i,r,u,f,e,o,s,h,c){Object.defineProperty(t,"__esModule",{value:!0});var l=function(){return i.createElement("div",null,r.Loading)},a=e.getAsyncLoadedComponent(["Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/LinksGridComponent"],function(n){return n.LinksGridComponent},function(){return i.createElement(l,null)}),v=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.state=r.props.store.getState(),r}return __extends(t,n),t.prototype.componentDidMount=function(){this._storeListenerDelegate=this._onStoreChanged.bind(this);this.props.store.addChangedListener(this._storeListenerDelegate);this.props.onRender()},t.prototype.componentWillUnmount=function(){this.props.store.removeChangedListener(this._storeListenerDelegate);this._storeListenerDelegate=null},t.prototype.componentDidUpdate=function(){this.props.onRender()},t.prototype.render=function(){var n=null,r=null,e;if(this.state.linkedArtifactGroups.length===0&&this.state.fetchingDisplayData===f.FetchingDisplayData.Done&&this.state.fetchingLinks===u.FetchingLinks.Done){if(e=this.state.displayOptions.zeroDataOptions.zeroDataExperienceViewMode,e!==u.ZeroDataExperienceViewMode.Hidden){var t=this.state.displayOptions.zeroDataOptions,l=t.message,v=t.action,y=t.onRenderZeroData;n=y?y(l,v):i.createElement(h.ZeroDataComponent,{action:v,message:l})}}else n=this.state.displayOptions.viewMode===u.ViewMode.List?i.createElement(o.LinksListComponent,{actionsCreator:this.props.actionsCreator,linkedArtifactGroups:this.state.linkedArtifactGroups,columns:this.props.columns,displayOptions:this.state.displayOptions,hostArtifact:this.state.hostArtifact}):i.createElement(a,{actionsCreator:this.props.actionsCreator,linkedArtifactGroups:this.state.linkedArtifactGroups,columns:this.props.columns,sortColumns:this.state.sortColumns,displayOptions:this.state.displayOptions,hostArtifact:this.state.hostArtifact});return(this.state.fetchingDisplayData===f.FetchingDisplayData.InProgress||this.state.fetchingLinks===u.FetchingLinks.InProgress)&&(r=i.createElement(s.LoadingIndicatorComponent,null)),i.createElement("div",{className:"la-main-component"},i.createElement(c.MessageComponent,{message:this.state.message}),r,n)},t.prototype._onStoreChanged=function(){this.setState(this.props.store.getState())},t}(i.Component);t.MainComponent=v});
define("Presentation/Scripts/TFS/Controls/LinkedArtifacts/Control",["require","exports","react","VSS/Diag","VSS/Utils/Core","VSS/Utils/Array","VSS/Utils/String","VSS/Telemetry/Services","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Flux/Store","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Flux/Actions","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Flux/ActionsCreator","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Logic/Filtering","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Components/MainComponent","VSS/LoaderPlugins/Css!Controls/LinkedArtifacts/LinkedArtifacts"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){Object.defineProperty(t,"__esModule",{value:!0});var y=function(n){function t(t){var i=n.call(this,t)||this,u,f;return u=new c.ActionsHub,f=new a.ArtifactFilterHelper(i.props.linkTypeRefNames,i.props.artifactSubTypeFilters),i._store=new h.LinkedArtifactsStore(u,i.props.linkTypeRefNames,i.props.sortColumns,i.props.viewOptions,i.props.gridViewOptions,i.props.zeroDataOptions,i.props.readOnly,null,i.props.artifactPageSize),i._actionsCreator=new l.ActionsCreator(i.props.tfsContext,u,i._getColumns(),f,i.props.cache),u.removeLinkedArtifact.addListener(i._onRemoveArtifact.bind(i)),u.changeLinkedArtifactComment.addListener(i._onChangedLinkComment.bind(i)),i.props.linkedArtifacts&&i.setLinkedArtifacts(i.props.linkedArtifacts,i.props.hostArtifact),i}return __extends(t,n),t.prototype.componentWillReceiveProps=function(n){n&&n.linkedArtifacts&&this.setLinkedArtifacts(n.linkedArtifacts,n.hostArtifact)},t.prototype.setLinkedArtifacts=function(n,t){this._actionsCreator.setLinks(n,t)},t.prototype.setViewOptions=function(n){this._actionsCreator.changeViewOptions(n)},t.prototype.setReadOnly=function(n){this._actionsCreator.changeReadOnly(n)},t.prototype.setZeroDataOptions=function(n){this._actionsCreator.changeZeroDataOptions(n)},t.prototype.setFetchingLinks=function(n){this._actionsCreator.changeFetchingLinks(n.fetchingLinks)},t.prototype.setMessage=function(n,t){this.setMessage(n,t)},t.prototype.clearMessage=function(){this._actionsCreator.clearMessage()},t.prototype.render=function(){return i.createElement(v.MainComponent,{store:this._store,actionsCreator:this._actionsCreator,columns:this._getColumns(),onRender:this._onRender.bind(this),ref:"element"})},t.prototype._onRemoveArtifact=function(n){var t=this;this._store.getState().displayOptions.readOnly||this.props.onRemoveLinkedArtifact&&u.delay(null,0,function(){t.props.onRemoveLinkedArtifact(n.linkedArtifactToRemove)})},t.prototype._onChangedLinkComment=function(n){var t=this;this._store.getState().displayOptions.readOnly||(this.props.onChangeLinkedArtifactComment&&u.delay(null,0,function(){t.props.onChangeLinkedArtifactComment(n.linkedArtifactToChange,n.newComment)}),o.publishEvent(new o.TelemetryEventData(s.LINKED_ARTIFACTS_CUSTOMER_INTELLIGENCE_AREA,"editLinkComment",{linkType:n.linkedArtifactToChange.linkTypeDisplayName,commentLength:n.newComment.length})))},t.prototype._getColumns=function(){var n=this.props&&this.props.columns||t.DEFAULT_COLUMNS,i=f.findIndex(n,function(n){return e.equals(n.refName,s.InternalKnownColumns.Link.refName,!0)});return i>0?(n.splice(i,1),n.unshift(s.InternalKnownColumns.Link)):i===-1&&n.unshift(s.InternalKnownColumns.Link),n},t.prototype._onRender=function(){this.props.onRender&&this.props.onRender()},t.DEFAULT_COLUMNS=[s.InternalKnownColumns.State,s.InternalKnownColumns.LastUpdate,s.InternalKnownColumns.Comment],t}(i.Component);t.LinkedArtifactsControl=y});
define("VersionControl/Scenarios/Shared/WorkItemListSelector",["require","exports","react","OfficeFabric/Label","VSS/Controls","VSS/Flux/PlatformComponent","VersionControl/Scripts/Controls/AddRelatedWorkItemsControl","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Control"],function(n,t,i,r,u,f,e,o){var s,h;Object.defineProperty(t,"__esModule",{value:!0});s=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.render=function(){return i.createElement("div",null,this.props.label&&i.createElement(r.Label,null,this.props.label),i.createElement(h,{cssClass:"bowtie-style",options:this.props}),i.createElement("div",{className:"linked-artifacts-container"},i.createElement(o.LinkedArtifactsControl,__assign({},this.props))))},t}(i.PureComponent);t.WorkItemListSelector=s;h=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.createControl=function(n){return u.create(e.AddRelatedWorkItemsControl,n,this.props.options)},t}(f.Component)});
define("VersionControl/Scripts/RefNameValidator",["require","exports","VSS/Utils/Array","VSS/Utils/String","VersionControl/Scripts/Generated/TFS.VersionControl.Common","VersionControl/Scripts/GitRefUtility","VersionControl/Scripts/Resources/TFS.Resources.VersionControl","VersionControl/Scripts/VersionControlPath"],function(n,t,i,r,u,f,e,o){var s,h,c,l;Object.defineProperty(t,"__esModule",{value:!0}),function(n){n[n.None=0]="None";n[n.NameTooLong=1]="NameTooLong";n[n.InvalidCharacter=2]="InvalidCharacter";n[n.InvalidLeadCharacter=3]="InvalidLeadCharacter";n[n.InvalidTrailCharacter=4]="InvalidTrailCharacter";n[n.NameEmpty=5]="NameEmpty";n[n.AlreadyExists=6]="AlreadyExists";n[n.ExistingRefUsedAsFolder=7]="ExistingRefUsedAsFolder";n[n.NewRefIsExistingFolder=8]="NewRefIsExistingFolder"}(s=t.RefNameErrorType||(t.RefNameErrorType={}));h=function(){function n(n){this._invalidRefNameStrings=["~","^",":"," ","?","*","[","\\","/.",".lock/","//","..","@{"];this._invalidLeadNameStrings=["/","."];this._invalidTrailNameStrings=[".lock",".","/"];this._updateExistingRefs(n)}return n.prototype.validate=function(n){var t=s.None,i=null,f,r,u;return n.length>0?(f=this.getFullRefName(n),f.length>this.getNameMaxLength()?t=s.NameTooLong:(this._invalidRefNameStrings.some(function(t){return n.indexOf(t)>-1?(i=t,!0):!1}),i?t=s.InvalidCharacter:(this._invalidLeadNameStrings.some(function(t){return n.lastIndexOf(t,0)===0?(i=t,!0):!1}),i?t=s.InvalidLeadCharacter:(this._invalidTrailNameStrings.some(function(t){var r=n.length-t.length;return r>=0&&n.indexOf(t,r)===r?(i=t,!0):!1}),i?t=s.InvalidTrailCharacter:this._refExists(n)?t=s.AlreadyExists:(r=this._findRefUsedAsFolder(n),r?(t=s.ExistingRefUsedAsFolder,i=r):(u=this._findBranchInsideFolder(n),u&&(t=s.NewRefIsExistingFolder,i=u))))))):t=s.NameEmpty,{error:this.getErrorString(t,i),allValid:t===s.None}},n.prototype.getNameMaxLength=function(){return u.GitConstants.MaxGitRefNameLength},n.prototype._updateExistingRefs=function(n){var t,u,i,r,f,e;for(this._existingRefsHash={},this._existingFoldersHash={},t=0,u=n;t<u.length;t++)for(i=u[t],this._existingRefsHash[i]=!0,r=0,f=o.getParentPaths(i);r<f.length;r++)e=f[r],this._existingFoldersHash[e]=i},n.prototype._refExists=function(n){return!!this._existingRefsHash[n]},n.prototype._findRefUsedAsFolder=function(n){var t=this;return i.first(o.getParentPaths(n),function(n){return t._existingRefsHash[n]})},n.prototype._findBranchInsideFolder=function(n){return this._existingFoldersHash[n]},n}();t.RefNameValidator=h;c=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.getErrorString=function(n,t){switch(n){case s.None:return"";case s.NameEmpty:return e.BranchNameCannotBeEmpty;case s.NameTooLong:return e.BranchNameTooLong;case s.AlreadyExists:return e.CreateBranchDialogBranchExistsMessage;case s.ExistingRefUsedAsFolder:return r.format(e.CreateBranchDialogExistingRefUsedAsFolder,t);case s.NewRefIsExistingFolder:return r.format(e.CreateBranchDialogNewRefIsExistingFolder,t);case s.InvalidTrailCharacter:return r.format(e.CreateBranchDialogInvalidTrailCharacterMessage,t);case s.InvalidLeadCharacter:return r.format(e.CreateBranchDialogInvalidLeadCharacterMessage,t);case s.InvalidCharacter:return r.format(e.CreateBranchDialogInvalidCharacterMessage,t);default:return""}},t.prototype.getFullRefName=function(n){return f.getFullRefNameFromBranch(n)},t.prototype.getNameMaxLength=function(){return u.GitConstants.MaxGitRefNameLength-11},t}(h);t.BranchNameValidator=c;l=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t.prototype.getErrorString=function(n,t){switch(n){case s.None:return"";case s.NameEmpty:return e.CreateTag_EmptyTagNameError;case s.NameTooLong:return e.CreateTag_TagNameTooLong;case s.AlreadyExists:return e.CreateTag_TagExistsMessage;case s.InvalidTrailCharacter:return r.format(e.CreateTag_InvalidTrailCharacterMessage,t);case s.InvalidLeadCharacter:return r.format(e.CreateTag_InvalidLeadCharacterMessage,t);case s.InvalidCharacter:return r.format(e.CreateTag_InvalidCharacterMessage,t);default:return""}},t.prototype.getFullRefName=function(n){return f.getFullRefNameFromTagName(n)},t.prototype.getNameMaxLength=function(){return u.GitConstants.MaxGitRefNameLength-10},t}(h);t.TagsNameValidator=l});
define("VersionControl/Scenarios/Shared/Committing/CommitDialog",["require","exports","OfficeFabric/Button","OfficeFabric/Checkbox","OfficeFabric/Dialog","OfficeFabric/Label","OfficeFabric/MessageBar","OfficeFabric/Spinner","OfficeFabric/TextField","react","VSS/Utils/Accessibility","VSS/Utils/String","VSS/Utils/UI","Presentation/Scripts/TFS/Controls/LinkedArtifacts/Contracts","VersionControl/Scenarios/Shared/Committing/TextFieldParentAddon","VersionControl/Scenarios/Shared/FileInput","VersionControl/Scenarios/Shared/WorkItemListSelector","VersionControl/Scripts/FileSpecUtility","VersionControl/Scripts/RefNameValidator","VersionControl/Scripts/Resources/TFS.Resources.VersionControl","VersionControl/Scripts/Utils/WorkItemLinkUtils","VersionControl/Scripts/VersionControlPath","VSS/LoaderPlugins/Css!VersionControl/Shared/Committing/CommitDialog"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){Object.defineProperty(t,"__esModule",{value:!0});var tt=function(n){function t(t){var i=n.call(this,t)||this,r;return i.saveOnCtrlEnter=function(n){n.ctrlKey&&i.saveOnEnter(n)},i.saveOnEnter=function(n){n.which===a.KeyCode.ENTER&&i.canSave()&&(i.save(),n.preventDefault(),n.stopPropagation())},i.setUploadedFileState=function(n){var t=i.getDefaultUploadFilesComment(n);i.setState({filesToBeUploaded:n,autoComment:t})},i.setComment=function(n){i.setState({comment:n})},i.setNewBranchName=function(n){i.setState({newBranchName:n,newBranchNameErrorMessage:i.getErrorBranchName(n)})},i.toggleCreatePullRequest=function(){i.setState(function(n){return{hasToCreatePullRequest:!n.hasToCreatePullRequest}})},i.setNewItemName=function(n){n=n?n.trim():"";var t=i.props.isRenaming?l.format(d.DefaultRenameCommentFormatFromTo,i.props.itemName,n):i.props.isCreatingFolder?l.format(d.DefaultCreateFolderCommentFormat,n):i.state.autoComment,r=i.state.autoComment===i.state.comment?t:i.state.comment;i.setState({autoComment:t,comment:r,newItemName:n,newItemNameErrorMessage:i.getErrorNewItemName(n),isNewItemNameErrorInitiallyHidden:!1})},i.save=function(){if(!i.isValid())throw new Error("Save should not be enabled if dialog is not valid.");i.props.onSave({comment:i.state.comment||i.state.autoComment,isCommentDefault:!i.state.comment||i.state.comment===i.state.autoComment,newBranchName:i.isNewBranch()&&i.state.newBranchName,hasToCreatePullRequest:i.isNewBranch()&&i.state.hasToCreatePullRequest,newItemName:i.state.newItemName,linkedWorkItemIds:i.state.linkedWorkItemIds,filesToBeUploaded:i.state.filesToBeUploaded})},i.getErrorBranchName=function(n){if(!n||n===i.props.currentBranchName)return undefined;var r=new k.BranchNameValidator(i.props.existingBranches||[]),t=r.validate(n);return t.allValid?undefined:t.error},i.getErrorNewItemName=function(n){if(!n){var t=i.props.isRenaming?d.CommitNewItemNameLabel:d.CommitNewFolderNameLabel;return l.format(d.ValidationMessageIsRequired,t)}return i.props.isRenaming&&n===i.props.itemName?d.CommitRenameToSameNameError:i.fileAlreadyExists(n)?d.CommitNewItemNameAlreadyExists:b.hasIllegalNtfsChars(n)?l.format(d.InvalidFileName,n):void 0},i.fileAlreadyExists=function(n){var t=nt.combinePaths(i.props.editingPath,n);return i.props.existingFileList&&i.props.existingFileList.filter(function(n){return l.localeIgnoreCaseComparer(n.serverItem,t)===0}).length>0},i.addWorkItem=function(n){i.setState({linkedWorkItemIds:i.state.linkedWorkItemIds.concat([n])})},i.removeWorkItem=function(n){i.setState({linkedWorkItemIds:i.state.linkedWorkItemIds.filter(function(t){return t!==Number(n.id)})})},i.containsWorkItem=function(n){return i.state.linkedWorkItemIds.indexOf(n)>=0},i.setInitialFocus=function(){if(i.props.isRenaming||i.props.isCreatingFolder){if(i.newItemNameTextField.focus(),i.newItemNameTextField.setSelectionStart(0),i.state.newItemName){var n=i.state.newItemName.lastIndexOf(".");i.newItemNameTextField.setSelectionEnd(n>0?n:i.state.newItemName.length)}}else i.commentTextField.focus()},r=t.isRenaming?t.itemName:null,i.state={comment:t.initialComment,autoComment:t.initialComment,newBranchName:t.currentBranchName,newBranchNameErrorMessage:i.getErrorBranchName(""),hasToCreatePullRequest:!1,newItemName:r,newItemNameErrorMessage:i.getErrorNewItemName(r),isNewItemNameErrorInitiallyHidden:!0,linkedWorkItemIds:[],filesToBeUploaded:[]},i}return __extends(t,n),t.prototype.componentDidMount=function(){this.setInitialFocus()},t.prototype.componentWillReceiveProps=function(n){n.isSaving&&!this.props.isSaving&&c.announce(n.isGit?d.CommitSaving:d.CheckinSaving)},t.prototype.componentDidUpdate=function(n){this.props.errorMessage&&!n.errorMessage&&setTimeout(this.setInitialFocus)},t.prototype.render=function(){var n=this,t=this.isNewBranch()?d.EditFileCommitToNewBranch:this.getSaveButtonText();return h.createElement(u.Dialog,{modalProps:{containerClassName:"vc-commit-dialog",isBlocking:!0},hidden:!1,dialogContentProps:{type:u.DialogType.close},title:t,closeButtonAriaLabel:d.DialogClose,onDismiss:this.props.onDismiss},this.props.errorMessage&&h.createElement(e.MessageBar,{messageBarType:e.MessageBarType.error},this.props.errorMessage),(this.props.isRenaming||this.props.isCreatingFolder)&&this.renderNewItemName(),this.props.isUploading&&h.createElement(p.FileInput,{isGit:this.props.isGit,rootPath:this.props.rootPath,editingPath:this.props.editingPath,initialDrop:this.props.initialDrop,onUploadedFileStateChaged:this.setUploadedFileState,filesToBeUploaded:this.state.filesToBeUploaded,fileAlreadyExists:this.fileAlreadyExists}),h.createElement("div",{className:"comment-container"},h.createElement(f.Label,{className:"right-side-label",disabled:!0},this.state.comment&&this.state.comment!==this.state.autoComment?this.state.autoComment:""),h.createElement(s.TextField,{label:d.CommitCommentLabel,ref:function(t){return n.commentTextField=t},placeholder:this.state.autoComment,multiline:!0,resizable:!1,disabled:this.props.isSaving,value:this.state.comment,onChanged:this.setComment,onKeyDown:this.saveOnCtrlEnter})),this.props.isGit&&h.createElement("div",{className:"new-branch-name-fixed-container"},h.createElement(f.Label,{className:"right-side-label",disabled:!0},this.isNewBranch()?l.format(d.CommitBranchBasedOnLabel,this.props.currentBranchName):""),h.createElement(s.TextField,{label:d.CommitBranchNameLabel,placeholder:this.props.currentBranchName,disabled:this.props.isSaving,value:this.state.newBranchName,onChanged:this.setNewBranchName,errorMessage:this.state.newBranchNameErrorMessage})),h.createElement(w.WorkItemListSelector,{tfsContext:this.props.tfsContext,linkedArtifacts:this.state.linkedWorkItemIds.map(g.mapWorkItemIdToLinkedArtifact),onWorkItemAdd:this.addWorkItem,checkWorkItemExists:this.containsWorkItem,onRemoveLinkedArtifact:this.removeWorkItem,viewOptions:{viewMode:v.ViewMode.List},zeroDataOptions:{zeroDataExperienceViewMode:v.ZeroDataExperienceViewMode.Hidden},linkTypeRefNames:null,hostArtifactId:null,dropIconCss:"bowtie-chevron-down-light",label:d.CreateBranchDialogWorkItemsLabel}),h.createElement("div",{className:"create-pull-request-container"},this.isNewBranch()&&h.createElement(r.Checkbox,{label:d.CreatePullRequestLabel,checked:this.state.hasToCreatePullRequest,disabled:this.props.isSaving,onChange:this.toggleCreatePullRequest})),this.renderFooter())},t.prototype.renderNewItemName=function(){var t=this,i=this.props.isRenaming?d.CommitNewItemNameLabel:d.CommitNewFolderNameLabel,n=this.props.isCreatingFolder&&this.props.editingPath;return h.createElement(s.TextField,{className:"new-item-name-fixed-container",ref:function(n){return t.newItemNameTextField=n},label:i,addonString:n,onRenderAddon:n&&y.TextFieldParentAddon,placeholder:d.CommitNewItemNameWatermark,disabled:this.props.isSaving,value:this.state.newItemName,onChanged:this.setNewItemName,onKeyDown:this.saveOnEnter,errorMessage:!this.state.isNewItemNameErrorInitiallyHidden&&this.state.newItemNameErrorMessage})},t.prototype.renderFooter=function(){return this.props.isSaving?h.createElement(o.Spinner,{label:this.props.isGit?d.CommitSaving:d.CheckinSaving}):h.createElement(u.DialogFooter,null,h.createElement(i.PrimaryButton,{disabled:!this.canSave(),onClick:this.save},this.getSaveButtonText()),h.createElement(i.DefaultButton,{disabled:this.props.isSaving,onClick:this.props.onDismiss},d.EditFileCancel))},t.prototype.canSave=function(){return this.isValid()&&!this.props.isSaving},t.prototype.getSaveButtonText=function(){return this.props.isGit?d.EditFileCommit:d.EditFileCheckin},t.prototype.isValid=function(){return!this.state.newBranchNameErrorMessage&&!((this.props.isRenaming||this.props.isCreatingFolder)&&this.state.newItemNameErrorMessage)&&!(this.props.isUploading&&this.state.filesToBeUploaded.length===0)},t.prototype.getDefaultUploadFilesComment=function(n){var t,i,u,f,r;if(n&&n.length!==0){if(t=0,this.props.existingFileList)for(i=0,u=n;i<u.length;i++)f=u[i],this.fileAlreadyExists(f.name)&&t++;return n.length===1?t>0?l.format(d.AddFileDialogDefaultCommentSingleFileWithEdit,n[0].name):l.format(d.AddFileDialogDefaultCommentSingleFile,n[0].name):(r=nt.getFileName(this.props.editingPath)||this.props.rootPath,t>0&&t<n.length?l.format(d.AddFileDialogDefaultCommentMultipleFilesWithAddsAndEdits,n.length,r):t>0?l.format(d.AddFileDialogDefaultCommentMultipleFilesWithEdits,n.length,r):l.format(d.AddFileDialogDefaultCommentMultipleFiles,n.length,r))}return""},t.prototype.isNewBranch=function(){return this.state.newBranchName&&this.state.newBranchName!==this.props.currentBranchName},t}(h.PureComponent);t.CommitDialog=tt});
if (window.performance && window.performance.mark) { window.performance.mark('endLoadBundleInner-async'); }